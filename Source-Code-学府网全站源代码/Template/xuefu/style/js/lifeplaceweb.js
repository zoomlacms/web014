/*pub-1|2012-06-20 18:28:54*/(function(E,D){var F=function(C,B,A){F.Loader.run(C,B,A);return F};D.mix(F,{version:1.1,add:function(C,A,B){if(D.isFunction(A)){B=A;A=[]}if(!C){throw new Error("name is null")}F.Loader.run(C,B,A)},use:function(B,A){if(D.isFunction(B)){B(this);return }A=A?A:function(){};F.Loader.run(A,B,true)},namespace:function(){return D.namespace.apply(this,arguments)},log:function(A,B){D.log(arguments)}});F.namespace("util","data","widget","sys","app","tool");F.config={isDebug:false,basePath:"http://a.tbcdn.cn/p/sns/1.1",combo:true,preloads:{}};E.SNS=F})(window,KISSY);(function(e,X){var Y=1,d=2,K=4,b=0,a={production:"http://a.tbcdn.cn",daily:"http://assets.daily.taobao.net"},V=SNS.config.basePath+"/timestamp.js?"+new Date().getTime()+".js";function W(A){if(location.hostname.indexOf("daily")!==-1){return A.replace(a.production,a.daily)}else{return A}}function Z(E,D){var A=window.localStorage,B=document.documentElement;if(A){if(D){A.setItem(E,D)}else{return A.getItem(E)}}else{try{if(!B.style.behavior){B.style.behavior="url(#default#userData)"}if(D){B.setAttribute(E,D);B.save("sns")}else{B.load("sns");return B.getAttribute(E)}}catch(C){}}}function f(A){if(A){Z("snsTimeStamp",A)}else{return Z("snsTimeStamp")||20111206}}function R(A){if(A){Z("snsInterval",A)}else{return Z("snsInterval")||1}}function g(B){var D=Z("snsLastModifiy"),C=new Date().getTime(),A=R();if(!D||(D&&((C-D)>1000*60*A))){X.getScript(W(V),{success:function(){B();Z("snsLastModifiy",C)},error:function(){B()}})}else{B()}}function c(A,C,B){this.fn=C||function(){};this.childs=B||[];this.parents=[];this.name=A||"MOD["+(b++)+"]";this.status=Y}c.prototype={addParent:function(A){if(A.name==this.name){return }this.parents.push(A);A.childs.push(this)},hasParent:function(){return this.parents.length>0},_notify:function(){var B,C,A=this.parents.length;for(C=0;C<A;C++){B=this.parents[C];B.complete()}},isReady:function(){var C,B,A=true;for(C=0;C<this.childs.length;C++){B=this.childs[C];if(!B.isAttached()){A=false;break}}return A},ready:function(){this.run();this._notify()},complete:function(){this.status=d;if(this.isReady()){this.ready()}},isAttached:function(){return this.status==K},run:function(){this.status=K;this.fn(SNS,KISSY)}};var U={mods:{},add:function(A){var B=this.get(A.name);if(B){B.fn=A.fn;B.mixed=true}else{B=A;this.mods[A.name]=B}return B},get:function(A){return this.mods[A]}};var T={run:function(A,C,B){g(function(){T._run(A,C,B)})},_run:function(I,E,C){var L,H,B=[],D,J,F,G,A=this;if(X.isFunction(I)){C=E;E=I;I=undefined}if(!E){return }I&&(I=I.toLowerCase());C=C?C:[];if(X.isString(C)){C=C.split(",")}L=U.add(new c(I,E));for(F=0;F<C.length;F++){D=C[F].toLowerCase();if(X.trim(D)==""){continue}H=U.get(D);if(H){H.addParent(L)}else{H=U.add(new c(D));H.addParent(L);B.push(D)}}if(B.length!=0){if(SNS.config.combo&&B.length!=1){J=A.combo(B);A._load(J)}else{for(G=0;G<B.length;G++){J=A.nameToPath(B[G]);A._load(J)}}}if(!L.isAttached()){L.complete()}},_load:function(A){window.setTimeout(function(){X.getScript(W(A),{success:function(){},failure:function(){X.log(A+" is failure")},timeout:function(){X.log(A+" is timeout")}})},0)},nameToPath:function(C){var A=C.split(".");if(A[0].toLowerCase()==="sns"){A.splice(0,1)}var B=f();return SNS.config.basePath+"/"+A.join("/")+".js?t="+B+".js"},combo:function(B){var E,C=f(),A=SNS.config.basePath+"/??";for(var D=0;D<B.length;D++){E=B[D].split(".");if(E[0].toLowerCase()==="sns"){E.splice(0,1)}A+=E.join("/")+".js";if(D==B.length-1){A+="?t="+C+".js"}else{A+=","}}return A}};e.Loader=T;e.timeStamp=f;e.interval=R})(SNS,KISSY);KISSY.ready(function(B){B.later(function(){SNS.use(["SNS.Preload"])})});var Place=window.Place||{};Place.MapDetail={init:function(A){KISSY.use("event,node,dom,ua",function(C,G,I,H,F){var B={init:function(){var D=this;D._map()},_map:function(){C.log("\u5730\u56fe");if(!lat||!lng||!zoom){lat=30.243868,lng=120.138255,zoom=14}storeName=H.val("#store-name");var D=new AliLatLng(lat,lng);if(C.one("#map-bd")){var K=new AliMap("map-bd");K.centerAndZoom(D,zoom);var J=new AliMapLargeControl({hidePanBtn:true,hideZoomBar:true});K.addControl(J);var E=new AliMarker(D);E.setTitle(storeName);E.setIcon(new AliIcon("http://img02.taobaocdn.com/tps/i2/T1QoGMXcXjXXXXXXXX-15-22.png",{x:15,y:22},{x:8,y:27}));K.addOverlay(E)}}};B.init()})}};var Place=window.Place||{};Place.PlaceDetail={init:function(A){KISSY.use("switchable, datalazyload,overlay,node,dom,event,switchable",function(J,I,F,H,K,C,L,G){var B={init:function(){var D=this;D._popTip();D._popMore();if(C.get("#J_tinyslide")){D._picSlider()}var E=J.one("#J_TmsSlider");if(E){if(E&&J.one("#J_TmsSlider .ks-switchable-content").children().length>0){D._sliderTms()}else{C.style(C.parent(E,".mod"),"display","none")}}},_popTip:function(){var D=new J.Popup(C.get("#J_Onsaleinfo"),{trigger:"#J_over_trg",triggerType:"mouse",prefixCls:"onssale-",align:{node:"#J_over_trg",points:["br","tl"],offset:[-15,2]}})},_popMore:function(){var D=new J.Popup({closable:true,prefixCls:"more-"});K.all(".J_moreinfoClick").each(function(E){E.on("click",function(Q){var P=C.get(Q.currentTarget),N=C.attr(P,"data-type"),O="pop-",R,M="";R=C.get("#"+O+N);if(R){M=R.innerHTML;if(M!==""){D.set("content",M);D.show()}}C.style(".more-ext-close",{left:C.width(".more-contentbox")-22,width:"17px",top:"15px"});D.set("align",{node:P,points:["br","tl"],offset:[-30,-5]})})});L.on(document,"click",function(M){var E=J.one(M.target);if(E.hasClass("J_moreinfoClick")||C.parent(E,".J_moreinfoClick")||E.hasClass("more_dxinfo")||C.parent(E,".more_dxinfo")){return }else{D.hide()}})},_picSlider:function(){var D=new J.Carousel("#J_tinyslide",{activeIndex:0,effect:"scrollx",easing:"easeOutStrong",circular:false,prevBtnCls:"prev",nextBtnCls:"next",steps:1,lazyDataType:"img-src"});D.on("beforeSwitch",function(O){var M=Math.floor(O.toIndex/6);if(O.toIndex>=6*M){var N=M*292;var Q="-"+N+"px";var P=J.Anim("#J_Conent",{marginLeft:Q},0.5,undefined,function(){P.stop()});P.run()}else{var E=J.DOM.get("#J_Conent");J.DOM.css(E,"margin-left",0)}})},_sliderTms:function(){var D=new G.Slide("#J_TmsSlider",{effect:"scrolly",easing:"easeOutStrong",countdown:true,countdownFromStyle:"width:18px"})}};B.init()})}};var Place=window.Place||{};Place.Tab={init:function(A){KISSY.use("event,node,dom,datalazyload,switchable",function(G,H,J,I,F,C){var B={init:function(){var D=this;D._tabs()},_tabs:function(){G.ready(function(E){var D=new E.Tabs("#J_Tab",{switchTo:0});H.on("#J_DpBtn","click",function(){D.switchTo(0)})})}};B.init()})}};var Place=window.Place||{};if(location.hostname.indexOf("taobao.com")!==-1||location.hostname.indexOf("koubei.com")!==-1){var USER_URL_BASE="http://hui.taobao.com"}else{var USER_URL_BASE="http://hui.daily.taobao.net"}var URL=USER_URL_BASE+"/json/external/items_json.htm?";var TPL='<div class="mod"><div class="tuan" id="J_Slide" style=""><div class="tit">\u70ed\u5356\u672c\u5730\u56e2\u8d2d</div><div class="tuan-slider"><div class="ks-switchable-content"> <div class="ct"><a href="{{auction_url}}" class="img" target="_blank"><img src="{{pic_url}}" width="206" height="130"><p class="name">{{title}}</p></a><div class="clearfix"><div class="buy"><span><em>\uffe5</em><b class="price">{{price}}</b><a href="{{auction_url}}" class="btn-buy" target="_blank">\u62a2\u8d2d</a></span></div></div><div class="info clearfix"><ul><li class="oldprice"><p>\u539f\u4ef7</p><span><em>\uffe5</em>{{ori_price}}</span></li><li class="discount"><p>\u6298\u6263</p><span>{{discount}}<em>\u6298</em></span></li><li><p>\u552e\u51fa\u4ef6\u6570</p><span class="num">{{sold_quantity}}</span></li></ul></div></div></div></div></div></div>',TPL_DETAIL='<div class="mod"><div class="tuan" id="J_Slide" style=""><div class="tit">\u5546\u6237\u76f8\u5173\u56e2\u8d2d</div><div class="tuan-slider"><div class="ks-switchable-content"> <div class="ct"><a href="{{auction_url}}" class="img" target="_blank"><img src="{{pic_url}}" width="206" height="130"><p class="name">{{title}}</p></a><div class="clearfix"><div class="buy"><span><em>\uffe5</em><b class="price">{{price}}</b><a href="{{auction_url}}" class="btn-buy" target="_blank">\u62a2\u8d2d</a></span></div></div><div class="info clearfix"><ul><li class="oldprice"><p>\u539f\u4ef7</p><span><em>\uffe5</em>{{ori_price}}</span></li><li class="discount"><p>\u6298\u6263</p><span>{{discount}}<em>\u6298</em></span></li><li><p>\u552e\u51fa\u4ef6\u6570</p><span class="num">{{sold_quantity}}</span></li></ul></div></div></div></div></div></div>';Place.Tuan={init:function(A){KISSY.use("event,node,dom,switchable",function(F,G,I,H,C){var B={init:function(){var D=this;D._loadTuan()},_slider:function(){var D=new C.Slide("#J_Slide",{effect:"scrollx",easing:"easeOutStrong",countdown:true,countdownFromStyle:"width:18px"})},_loadTuan:function(){var M=this,J,P="_reply_cb_"+F.guid(),K="",L="single_sold_quantity",N="desc",D,Q=H.val("#J_CatId")||"",O=1,E=H.val("#J_AuctionId")||"";K=Bendi.Header.get("cityId");window[P]=function(R){M._renderTuan(R)};if(F.one("#J_AuctionId")){if(E!==""){J={callback:P,auction_id:E,page_size:O};D=URL+F.param(J);F.getScript(D)}}else{if(F.one("#J_CatId")){J={city:K,sort:L,callback:P,sort_type:N,cat:Q,page_size:O};D=URL+F.param(J);F.getScript(D)}}},_renderTuan:function(M){var L=this,O=M.items,E=0,K="",D="",J,N=Bendi.Header.get("cityId");if(F.one("#J_AuctionId")){J=L._template(TPL)}else{J=L._template(TPL_DETAIL)}if(O.length>0){for(E=0;E<O.length;E++){O[E].auction_url=O[E].auction_url+"&city="+N;D=J(O[E]);K+=D}H.html("#J_Tuan",K);if(F.all("#J_Slide .ct")&&F.all("#J_Slide .ct").length>1){L._slider()}}else{H.hide("#J_Tuan")}},_template:function(K,J){var L={evaluate:/<%([\s\S]+?)%>/g,interpolate:/\{{2,3}(.+?)\}{2,3}/g};var D="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+K.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(L.interpolate,function(M,N){return"',"+N.replace(/\\'/g,"'")+",'"}).replace(L.evaluate||null,function(M,N){return"');"+N.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');";var E=new Function("obj",D);return J?E(J):E}};B.init()})}};var Place=window.Place||{};Place.Coupon={init:function(A){KISSY.use("event,node,dom,switchable",function(B,C,H,F,G){var I={init:function(){var D=this;D._moreShow()},_moreShow:function(){var N=this,D=F.get("#J_List"),J=0,P=5,R,O,Q=B.all("#J_List li"),K=0,M=Q.length,L,E,T=M>10?10:M;for(K=0;K<T;K++){J+=parseInt(F.css(Q[K],"height"))}F.style("#J_List","height",J+"px");B.log("h="+J);F.style("#J_List","max-height",J+"px");J=parseInt(F.style("#J_List","height")==""?F.css("#J_List","height"):F.style("#J_List","height"));R=F.innerHeight("#J_List ul");O=J;if(J<R){C.on("#J_Cmore","click",function(){P--;if(P>=0){L=(5-P)*10;E=(5-P+1)*10>M?M:(5-P+1)*10;for(K=L;K<E;K++){J+=parseInt(F.css(Q[K],"height"))}R=F.innerHeight("#J_List ul");J=J>=R?R:J;F.style(D,"height",J+"px");F.style(D,"max-height",J+"px");if(J>=R){if(F.hasClass("#J_Cmore","more")){F.replaceClass("#J_Cmore","more","less")}else{F.style(D,"height",O+"px");F.style(D,"max-height",O+"px");F.replaceClass("#J_Cmore","less","more");J=O;P=5}}}})}else{if(B.one("#J_Cmore")){B.one("#J_Cmore").hide()}else{}}}};I.init()})}};KISSY.add("comments",function(H,A,N,J,M){var B,K,I,F={};if(location.hostname.indexOf("taobao.com")!==-1){B="http://detail.bendi.taobao.com";K=B}else{if(location.hostname.indexOf("koubei.com")!==-1){B="http://detail.koubei.com";K="http://detail.bendi.taobao.com"}else{if(location.hostname.indexOf("koubei.net")!==-1){B="http://detail.daily.koubei.net";K="http://detail.bendi.daily.taobao.net"}else{B="http://detail.bendi.daily.taobao.net";K="http://detail.bendi.daily.taobao.net"}}}var L=B+"/review/pictureUpload.do",C=K+"/review/pictureUpload.do";var G={init:function(){var D=this;D.initEditor((F&&F.editorConf));D.bindSubmit();D.scoreSet();D.setRecommend();D.getAverage();H.later(function(){D.rulelay()},500)},rulelay:function(){var E=M.check();if(!E){var D=location.href;D=D.replace("#J_Tab","");if(location.href.indexOf("#J_Comment")==-1){location.href=D+"#J_Comment"}}},initEditor:function(D){var E="../../api/update_mock.php";if(F&&F.url){E=F.url}var D=D||{attachForm:true,baseZIndex:10000,pluginConfig:{resize:{direction:["y"]},"multi-upload":{serverUrl:C,serverParams:{},sizeLimit:4000,numberLimit:5}}};I=J("#J_Ks_Editor",D).use("resize,justify,multi-upload");KISSY.EditorPlugins.Tip.bind("<span style='color:#B3B3B3;font-size:12px;'>\u8bc4\u4ef7\u5b57\u65708~2000\u5b57</span>",I)},bindSubmit:function(){var D=this;N.on("#J_CommentForm","submit",function(W){W.halt();var O=W.target,U=A.query("#J_FW"),P=[],V=A.query(".now-star",".stars"),Q,T=false;var E=true;var R=A.query(".J_EditorContainer",O);A.hide(".input-illegal");if(!D.isCommentFilled(I,7,2000)){A.show(A.get("#J_InputError",R));E=false}else{if(!D.isCommentFilled(I,7,4000,true)){A.show(A.get("#J_InputError",R));E=false}else{A.hide(A.get("#J_InputError",R));E=true}}if(E){if(!D.priceCheck()){A.show(A.get(".input-error",".form-cost"));E=false}else{A.hide(A.get(".input-error",".form-cost"));E=true}}for(Q=0;Q<V.length;Q++){P.push(A.attr(V[Q],"data-value"))}A.val(U,P);if(E){O.submit()}})},getAverage:function(){N.on("#J_Costs input","valuechange",function(O){var E=/^([0-9]\d*\.[0-9]\d*|0\.\d*[0-9]\d*|[0-9]\d*)$/,D=/^(\d)+(\.0)*$/;var P=A.val("#J_PersonCount"),Q=A.val("#J_Cost");if(A.attr(O.currentTarget,"id")=="J_Cost"){if(O.newVal.length>7){H.later(function(){A.val(O.currentTarget,O.prevVal);Q=O.prevVal},50)}}else{if(O.newVal.length>4){H.later(function(){A.val(O.currentTarget,O.prevVal);P=O.prevVal},50)}}if(E.test(Q)&&D.test(P)){A.text("#J_Average",(Q/P).toFixed(2))}})},priceCheck:function(){var Q=A.val("#J_Cost"),P=A.val("#J_PersonCount"),D=false,O=/^([0-9]\d*\.[0-9]\d*|0\.\d*[0-9]\d*|[0-9]\d*)$/,E=/^(\d)+(\.0)*$/;if(P==""&&Q==""){return true}if(O.test(Q)&&E.test(P)&&parseFloat(Q)<1000000&&parseFloat(P)<1000){return true}else{return false}},renderShareStatus:function(){var D=o.result.apps,O={},V={},U,R,E=H.all("#J_Share span"),T;for(var Q=0;Q<D.length;Q++){U=D[Q];V[U.sign]=U.last}for(var P=0;P<E.length;P++){U=E[P];R=A.attr(U,"data-type");if(V[R]=="1"){T=parseInt(A.css(U,"background-position-y")||A.css(U,"background-position-y"));A.style(U,"background-position-y",T+20+"px")}}},scoreSet:function(){var E=H.all("#J_Stars .score"),D=["(\u5f88\u5dee)","(\u5dee)","(\u4e00\u822c)","(\u597d)","(\u5f88\u597d)"],O=-1;H.all("#J_Stars").delegate("mouseover",".score",function(W){var V=W.currentTarget,T=A.parent(V,".stars"),Q=A.children(T,".active-star")[0],R,U=A.parent(V,"li"),X=A.query(".star-txt",U);A.removeClass(Q,"active-star");A.addClass(V,"active-star");var P=H.indexOf(V,A.children(T));A.text(X,D[P]);O=H.indexOf(A.children(T,".now-star")[0],A.children(T))});H.all("#J_Stars").delegate("mouseleave",".stars",function(U){var T=U.currentTarget,P,R=A.parent(T,"li"),Q=A.children(T,".active-star")[0];P=A.children(T,".score")[O];A.removeClass(Q,"active-star");A.addClass(P,"active-star");txtDom=A.query(".star-txt",R);A.text(txtDom,D[O])});H.all("#J_Stars").delegate("click",".score",function(W){var V=W.currentTarget,T=A.parent(V,".stars"),Q=A.children(T,".now-star")[0],R,U=A.parent(V,"li"),X=A.query(".star-txt",U);A.removeClass(Q,"now-star");A.addClass(V,"now-star");var P=H.indexOf(V,A.children(T));A.text(X,D[P]);O=P});N.on("#J_Radios input","click",function(W){var Y=W.target,V,U,Q=H.all("#J_Stars li"),T,R,X,P=H.all("#J_Stars .star-txt");if(A.attr(Y,"checked")=="checked"){V=A.attr(Y,"data-type");X=A.attr(Y,"data-inittxt");A.removeClass("#J_Arrow","score-general score-bad score-good");A.addClass("#J_Arrow",V);U=parseInt(A.attr(Y,"data-initvalue"));A.removeClass(E,"active-star");A.removeClass(E,"now-star");for(T=0;T<Q.length;T++){A.text(P[T],"("+X+")");A.addClass(E[U+T*5-1],"active-star");A.addClass(E[U+T*5-1],"now-star")}}})},setRecommend:function(){var P=H.all("#J_RecommendList a"),O=H.one("#J_Recommend"),R=[],E,Q,D=A.val("#J_Recommend")==""?"":A.val("#J_Recommend").split(",");N.on(P,"click",function(){D=A.val("#J_Recommend")==""?"":A.val("#J_Recommend").split(",");A.toggleClass(this,"checked");_nowv=A.text(this);if(A.hasClass(this,"checked")){if(D.length>0){A.val("#J_Recommend",D+","+_nowv)}else{A.val("#J_Recommend",_nowv)}}else{E=H.indexOf(_nowv,D);if(E>=0){var T=D.splice(E,1)}A.val(O,D)}})},isCommentFilled:function(R,P,O,U){P=P||1;var Q=R.getData(),T=A.create("<div>"+Q+"</div>"),D=v=(U?H.trim(Q).length:H.trim(A.text(T)).length),E=false;if(D>P){E=true;if(O&&O<D){E=false}}return E}};return G},{requires:["dom","event","editor","blacklist"]});KISSY.add("CommentList",function(F,B){},{requires:["addlove"]});KISSY.add("addlove",function(B,G,F,A){var H={containerId:"J_CommentContainer"};if(location.hostname.indexOf("taobao.com")!==-1){URL_BASE="http://detail.bendi.taobao.com"}else{if(location.hostname.indexOf("koubei.com")!==-1){URL_BASE="http://detail.koubei.com"}else{if(location.hostname.indexOf("koubei.net")!==-1){URL_BASE="http://detail.daily.koubei.net"}else{URL_BASE="http://detail.bendi.daily.taobao.net"}}}var C={init:function(D){this.config=B.merge(H,D);var E=this;E.addLove(E.config.containerId)},addLove:function(N){var M=this,J=URL_BASE+"/review/asynReactionPost.do?",L,I,K,E,D;SNS.use(["SNS.widget.Vote"],function(){var O=B.all(".J_TBDig"),P=false;O.each(function(V){if(V.data("isVoteInit")){return }V.data("isVoteInit",1);P=true;var U=SNS.widget.Vote.setVote(V[0]),T=G.parent(V[0],".dp-item"),Q=G.query(".love-num",T),R=G.query(".love",T);U.on("voteSuccess",function(W){B.log("[SNS Vote]: Custom Event on voting success");var X=G.query(".love-count",T);G.removeClass(Q,"hide");if(!G.hasClass(R,"hasloved")){G.addClass(R,"hasloved")}D=G.attr(T,"data-id");E=G.attr(R,"data-token");L={reviewId:D,_tb_token_:E};A({type:"POST",url:"/review/asynReactionPost.do",data:L,sunccess:function(){}})});U.on("voteFail",function(Y){B.log("[SNS Vote]: Custom Event on voting fail");var X,W;G.removeClass(Q,"hide");X=G.query(".loveagain",T);W=G.query(".loveonce",T);G.show(X);G.hide(W);setTimeout(function(){G.show(W);G.hide(X)},2000)});U.on("getVoteCountSuccess",function(W){B.log("[SNS Vote]: Custom Event on getting vote count success");if(W.voteCount<1){G.addClass(Q,"hide")}else{}})});P&&SNS.widget.Vote.initVotes()})},loveAdd:function(I,D,E){}};return C},{requires:["dom","event","ajax"]});(function(){var E=KISSY,G=E.DOM,C=E.Node,A=E.Event;E.namespace("EditorPlugins.Tip");function F(I,J){var H=this;H.editor=I;H.msg=J;H.shade=null;H.init()}var D=null;var B=function(H){return H.replace(/<[^>]+>/g,"")};F.prototype={fix:function(){var I=this,H=I.shade;var J=G.offset(G.parent(I.editor.textarea[0],".ke-textarea-wrap"));H.css({left:10,top:35})},response:function(){var H=this;if(H.editor.getMode()==KISSY.Editor.WYSIWYG_MODE&&B(H.editor.getData())==""){H.shade.show()}},init:function(){var I=this,K=I.editor;function J(){I.fix();L()}I.shade=new C(I.msg).prependTo(".J_EditorContainer").on("click",function(){K.focus()}).css({position:"absolute",zIndex:999999,left:-9999,top:-9999});var H=I.shade;K.ready(J);setTimeout(J,1000);A.on(window,"resize",J);K.on("maximizeWindow restoreWindow wysiwygmode",J);K.on("focus sourcemode",function(){if(D){D.response()}D=I;H.hide()});K.on("blur",function(){L()});var L=function(){if(K.getMode()==KISSY.Editor.WYSIWYG_MODE&&B(K.getData())==""){H.show()}else{H.hide()}}}};KISSY.EditorPlugins.Tip.bind=function(I,H){return new F(H,I)}})();KISSY.add("myOverlay",function(G,A,F,B,N,J,C){var H={},I,K,L=window.location.href.indexOf("daily.taobao.net")!=-1?true:false,M=window.location.href.indexOf("daily.koubei.net")!=-1?true:false;if(window.location.href.indexOf("daily.taobao.net")!=-1){K="http://i.bendi.daily.taobao.net/"}else{if(window.location.href.indexOf("daily.koubei.net")!=-1){K="http://i.daily.koubei.net/"}else{if(window.location.href.indexOf("taobao.com")!=-1){K="http://i.bendi.taobao.com/"}else{K="http://i.koubei.com/"}}}MYLAYTPL='<div class="my-lay" id="J_My_Lay"><div class="lay-wrap"><span><a href="'+K+'" id="J_GoMy" _target="_blank">\u6211\u7684\u672c\u5730\u751f\u6d3b</a></span></div></div>';G.mix(H,{_renderMy:function(){var Q=this;var P;P=A.create(MYLAYTPL);A.append(P,"body");N.on("#J_GoMy","click",function(R){if(!(C.ifLogin())){R.halt();J.show(true,K)}});if(G.UA.ie===6){var E=A.viewportWidth(),O=A.viewportHeight(),D;N.on(window,"scroll",function(){D=A.scrollTop();O=A.viewportHeight();_scrollTop=A.scrollTop(),E=A.viewportWidth();G.later(function(){A.offset(P,{top:_scrollTop+O-28,left:E+A.scrollLeft()-94})},500)});N.on(window,"resize",function(){D=A.scrollTop();O=A.viewportHeight();_scrollTop=A.scrollTop();E=A.viewportWidth();G.later(function(){A.offset(P,{top:_scrollTop+O-28,left:E+A.scrollLeft()-94})},500)})}},init:function(){var D=this;D._renderMy()}});return H},{requires:["dom","cookie","overlay","event","loginlay","global"]});KISSY.add("loginlay",function(I,A,M,C,B){},{requires:["dom","event","cookie","overlay"]});KISSY.add("global",function(B,A){var C={ifLogin:function(){var E=A.get("tracknick"),D=A.get("_nk_")||E;return !!(A.get("_l_g_")&&D||A.get("ck1")&&E)}};return C},{requires:["cookie"]});KISSY.add("share",function(B){var C={tag:".share-review",container:"#J_CommentContainer",ifdelegate:true};var A={init:function(D){this.config=B.merge(C,D);var E=this;E.shareEvent(E.config.tag,E.config.container,E.config.ifdelegate)},_share:function(D){TS.require("Share","2.0",function(){new TS.Share(D).show("")})},shareEvent:function(D,E,F){var G=this;if(F){B.Event.delegate(E,"click",D,function(H){var I=H.target;if("a"===I.tagName.toLowerCase()){H.preventDefault();if("undefined"!==typeof TS){G._share(I)}else{B.IO.getScript("assets/js/ts.js?t="+new Date().getTime(),function(){G._share(I)})}}})}else{B.Event.on(D,"click",function(H){var I=H.target;if("a"===I.tagName.toLowerCase()){H.preventDefault();if("undefined"!==typeof TS){G._share(I)}else{B.IO.getScript("assets/js/ts.js?t="+new Date().getTime(),function(){G._share(I)})}}})}}};return A});"undefined"==typeof TS&&(TS={}),function(N,O){}(KISSY,TS),function(P,Q){}(KISSY,TS),function(F,D){function E(H,A,B){var C=F.isString(A)?H[A]:A;return function(){var G=arguments?F.makeArray(arguments):[];B&&(G=B.concat(G)),C.apply(H,G)}}return D.hitch=E}(KISSY,TS),function(x,y){function k(C){this._init(C)}var z=document,AC=window,AD=x.DOM,A=x.Event,B="contentEl",a="config",b="click",c="timer",d="events",e="filter",f="autoHide",g="visibility",h="hidden",i="visible",l="mask",m="display",n="none",p="block",q="srcNode",r="callback",s="J_Close",t="px",u=!1,w=x.UA,j={elCls:"",content:""};return k.prototype={_init:function(C){var E=this,G=AD.create('<div class="ts-popup" style="position:'+(6===w.ie?"absolute":"fixed")+';z-index:10001;visibility:hidden"></div>'),D=x.merge(j,C),F=D.srcNode||z.body;E.prepend(G,F),G.innerHTML=D.content,D.style&&AD.css(G,D.style),AD.addClass(G,D.elCls),E[B]=G,E[a]=D,D.mask&&E.createMask(),E._bindEvent()},_bindEvent:function(){var C=this;A.on(C[B],b,function(H){var E=H.target,F,G,D=C[a][d];AD.hasClass(E,s)&&(H.preventDefault(),C.hide());if(D&&D.length>0){for(F=0,G=D.length;F<G;F++){D[F][e](E)&&D[F][r](E)}}})},position:function(F,G,H){var L=this,M=L[a],N=L[B],O=AD.get(F),P=AD.offset(O),Q=O.offsetWidth,R=O.offsetHeight,I=N.offsetWidth,J=N.offsetHeight,K=H||[0,0],C=M[q],H,D,E;switch(G){case"tr":D=P.left+Q-I+K[0],E=P.top-J+K[1];break;case"tl":D=P.left+K[0],E=P.top-J+K[1];break;case"br":D=P.left+Q-I+K[0],E=P.top+R+K[1];break;default:D=P.left+K[0],E=P.top+R+K[1]}C&&(H=AD.offset(C),D-=H.left,E-=H.top),AD.css(N,{left:D+t,top:E+t})},prepend:function(F,C){var D=AD.children(C),E;D.length>0?(E=D[0],AD.insertBefore(F,E)):AD.get(C).appendChild(F)},center:function(){var C=this;C.centerAlign(),C.centerValign()},centerValign:function(){var H=this,C=H[a],D=H[B],E=6===w.ie?AD.scrollTop():0,F=AD.viewportHeight(),G=D.offsetHeight;AD.css(D,{top:E+(F-G)/2+t})},centerAlign:function(){var G=this,C=G[a],D=G[B],E=AD.viewportWidth(),F=D.offsetWidth;AD.css(D,{left:(E-F)/2+t})},fix:function(){var D=this,C;if(6===w.ie){if(D.hasFixedEvent){return !1}A.on(AC,"scroll resize",function(E){D[u]&&(D.centerValign(),D.hasFixedEvent=!0)})}},setContent:function(C){var E=this,D=E[B],F;D.innerHTML="",F=x.isString(C)?AD.create(C):C,D.appendChild(F)},createMask:function(){var F=this,C=AD.docHeight(),D=AD.docWidth(),E=AD.create('<div class="ts-mask" style="height:'+C+'px;display:none">'+(6===w.ie?'<iframe scrolling="no" frameborder="0" src="about:blank" width="'+D+'" height="'+C+'" style="filter:alpha(opacity=0.1)"></iframe>':"")+"</div>");F.prepend(E,z.body),F[l]=E},showMask:function(){var C=this[l];C&&AD.css(C,m,p)},hideMask:function(){var C=this[l];C&&AD.css(C,m,n)},show:function(){var D=this,C;return D[a][f]&&(C=D[c],C&&clearTimeout(C),D[c]=setTimeout(function(){D.hide(),D[c]=null},3000)),D.showMask(),AD.css(D[B],g,i),D[u]=!0,D},hide:function(){var C=this;return AD.css(C[B],g,h),C.hideMask(),C[u]=!1,C},destroy:function(){var D=this,C=D[B];return C.parentNode.removeChild(C),D[u]=!1,D}},y.Popup=k}(KISSY,TS),KISSY.add("template",function(Y){var Z={},a={},b={"#":"start","/":"end"},c={},d=function(A){return A in c||(c[A]=new RegExp(A,"ig")),c[A]},e="KS_TEMPL_STAT_PARAM",f="KS_TEMPL",g="KS_DATA_",h="",i="as",j='");',k=f+'.push("',l="KISSY.Template: Syntax Error. ",m="KISSY.Template: Render Error. ",n="var "+f+"=[],"+e+"=false;with(",p="||{}){try{"+f+'.push("',q='");}catch(e){'+f+'=["'+m+'" + e.message]}};return '+f+'.join("");',r=function(C){var A,B;return Y.trim(C).replace(d("[\r\t\n]")," ").replace(d("([\"'])"),"\\$1").replace(d("{{([#/]?)(?!}})([^}]*)}}"),function(I,G,H){A=h;if(G){H=Y.trim(H),B=H.indexOf(" "),H=B===-1?[H,""]:[H.substring(0,H.indexOf(" ")),H.substring(H.indexOf(" "))];for(var D in u){if(H[0]!==D){continue}H.shift();if(G in b){var E=u[D][b[G]],F=Y.trim(H.join(h).replace(d("\\\\(['\"])"),"$1"));A=Y.isFunction(E)?E.apply(this,F.split(/\s+/)):E.replace(d(e),"typeof "+F+'!=="undefined"&&'+F)}}}else{A=f+".push("+H.replace(d("\\\\(['\"])"),"$1")+");"}return j+A+k})},s=function(A){return[].slice.call(A)},t=function(A){return s(A).join(h)},u={"if":{start:"if("+e+"){",end:"}"},"else":{start:"}else{"},elseif:{start:"}else if("+e+"){"},each:{start:function(){var C=s(arguments),D="_ks_value",A="_ks_index";C[1]===i&&C[2]&&(C[3]==="->"?(A=C[2]||A,D=C[4]||D):D=C[2]||D);var B="KISSY.each("+C[0]+", function("+D+", "+A+"){";return B},end:"});"},"!":{start:"/*"+e+"*/"}},w=function(C,F){Y.mix(Z,F);if(!(C in a)){var A=g+Y.now(),B,D=[n,A,p,r(C),q];try{B=new Function(A,D.join(h))}catch(E){D[3]=j+k+l+","+E.message+j+k,B=new Function(A,D.join(h))}a[C]={name:A,parser:D.join(h),render:B}}return a[C]};return Y.mix(w,{log:function(A){A in a?"js_beautify" in window?Y.log(js_beautify(a[A].parser,{indent_size:4,indent_char:" ",preserve_newlines:!0,braces_on_own_line:!1,keep_array_indentation:!1,space_after_anon_function:!0}),"info"):Y.log(a[A].parser,"info"):(w(A),this.log(A))},addStatement:function(B,A){Y.isString(B)&&Y.isObject(A)&&(u[B]=A)}}),Y.Template=w,w},{requires:["core"]}),function(O,P){if(P.root){return !1}var Q="_requireCount",R="_callbackQueue",T="apps/snstaoshare/widget/ts",U=document,K=O.IO,L=O.DOM,M=0,N=P.uri;O.mix(TS,{root:"apps/snstaoshare/widget/ts/",_requireCount:0,_callbackQueue:[],_globalObject:{},IO:{getScript:K?K.getScript:O.getScript?O.getScript:O.Ajax.getScript,jsonp:K?K.jsonp:function(B,C){var D=P.IO,A="_jsonp_"+M++;D[A]=C,D.getScript(N.buildUri(B,"callback=TS.IO."+A))}},interactServer:function(B,C,D){var E=this,F,A;F=C?N.encode(C):"",E[Q]++,E.IO.jsonp(N.buildUri(N.addStamp(B),F),function(G){E[Q]--,E[R].push(P.hitch(E,D,[G])),E._excuteCallback()})},loadScript:function(B,C){var A=this;return O.indexOf(B,A._loadedScript)>-1?A._excuteCallback():(A[Q]++,A.ready(C),location.href.indexOf("ks-debug")>-1&&B.indexOf(".source.")<0&&(B=B.replace(/\.js/,".source.js")),A.IO.getScript(B,function(){A[Q]--,A._loadedScript.push(B),A._excuteCallback()}))},_loadedScript:[],ready:function(A){var B=this;A&&B[R].push(A),B._excuteCallback()},_excuteCallback:function(){var B=this,A;0===B[Q]&&(A=B[R],B[R]=[],O.each(A,function(C){C.call(B)}))},addStyleSheet:function(A){var B=L.get("head"),C;/\.css/.test(A)?(C=U.createElement("link"),C.setAttribute("rel","stylesheet"),B.appendChild(C),C.href=A):L.addStyleSheet(A)},getTimeStamp:function(){var A=this;return"undefined"==typeof _TS_TIME_STAMP?A.loadScript("http://www.taobao.com/go/rgn/sns/ts-timestamp.php"):_TS_TIME_STAMP},define:function(B,C,D){var E=this,F=[],G,A;O.isFunction(C)&&(D=C,C=[]),A=C.length;if(A){for(G=0;G<A;G++){E.loadScript(N.getCdn(E.root+C[G]+".js")),F.push(E._globalObject[C[G]])}}E.ready(function(){E._globalObject[B]=D.apply(E,F)})},require:function(C,D,E){var F=this,G=O.isString(D),H=G?E:D,A=C.toLowerCase(),B;return P[C]?H&&H():(F.getTimeStamp(),F.ready(function(){B=[T,A,G?D:"1.0",(location.href.indexOf("ks-debug")>-1?"main.source":"main")+".js?t="+_TS_TIME_STAMP[A]].join("/"),F.loadScript(N.getCdn(B)),F.ready(function(){H&&H.call(F,F._globalObject[C+"/"+D])})}),!1)}})}(KISSY,TS);KISSY.add("sidebar",function(H,A){var Q=H.Event,C={},K,I=A.viewportWidth(),B=A.viewportHeight(),J=true,P=B+35,G=990,M=10,O,N,F;var L={init:function(D){this.config=H.merge(C,D);var E=this;E._renderTop();E._renderFeedback()},_renderTop:function(){var R=this;E=H.one("#J_GoTop");if(!E){var D=H.UA.ie<7?"absolute":"fixed",E=H.Node('<div class="gotop" id="J_GoTop" style="position: '+D+';"><a href="#site-nav"><b></b>\u56de\u9876\u90e8</a></div>').appendTo(document.body)[0]}Q.on(window,"scroll",function(){var T=A.scrollTop();if(J&&T>P){R._show(E)}if(T<=P){R._hide(E)}else{if(!J&&T>P){H.later(function(){R.setPos(E,110)},500)}}});Q.on(window,"resize",function(){I=A.viewportWidth(),B=A.viewportHeight();H.later(function(){R.setPos(E,110)},500)});R.setPos(E,110);R._hide(E)},setPos:function(T,E){var U=this;_scrollLeft=A.scrollLeft();var D=parseInt(A.css(T,"border-width")),R;if(D){R=parseInt(A.css(T,"width"))-2*D}else{R=parseInt(A.css(T,"width"))}if(I-G-R>0){O=parseInt((I-G)/2+G+M)}else{O=parseInt(G-M-R)}_scrollTop=A.scrollTop();N=B+_scrollTop-E;if(H.UA.ie===6){A.offset(T,{left:O,top:N})}else{A.offset(T,{left:O})}},_show:function(D){A.css(D,"visibility","visible");J=false},_hide:function(D){A.css(D,"visibility","hidden");J=true},_getLeft:function(){O=(I-G)/2+G+M},_renderFeedback:function(){var R=this;E=H.one("#J_Feedback");if(!E){var D=H.UA.ie<7?"absolute":"fixed",E=H.Node('<div id="J_Feedback" class="feedback" style="position: '+D+';""><a href="http://ur.taobao.com/survey/view.htm?id=1206" target="_blank"><b></b>\u5efa\u8bae\u53cd\u9988</a></div>').appendTo(document.body)[0]}Q.on(window,"scroll",function(){var T=A.scrollTop();B=A.viewportHeight();_scrollTop=A.scrollTop();H.later(function(){R.setPos(E,202)},500)});Q.on(window,"resize",function(){I=A.viewportWidth(),B=A.viewportHeight();H.later(function(){R.setPos(E,202)},500)});R.setPos(E,202)}};return L},{requires:["dom"]});(function(){function Am(A,B){for(var C in B){A[C]=B[C]}}var Ak=["\u5355\u51fb\u589e\u52a0\u70b9\uff0c\u53cc\u51fb\u7ed3\u675f","beforeeditdelete","beforeeditadd","beforeeditmove","drawend","drawstart","nowrap","zoomcursor","zoomout","zoomin","moveright","moveleft","movedown","moveup","rightdown.png","leftdown.png","rightup.png","leftup.png","solid 1px #FF6600","progid:DXImageTransform.Microsoft.Alpha(opacity=40)","solid 1px ","20px","left","#000000","#FFFFFF","center","centerandzoom","dblclick","click","mouseover","touchstart","maptypechanged","geocenterchange","12px","dragend","dragstart","http://ditu.aliyun.com/v0.11/img/","scalestart","moveend","scaleend","aftermove","movestart","afterscalechange","beforescalechange","initialize","zoomlevelschange","projectionchange","afterresize","url(#default#VML)","dotted","http://www.w3.org/2000/svg","round","transparent","polygon","polyline","mouseup","mousemove","mousedown","pointer","object","relative","transform","MozTransform","WebkitTransform","string","progid:DXImageTransform.Microsoft.Alpha(opacity=","default","absolute","100%","visible","hidden","none","undefined","__E__"];function At(){}function Ao(){if(!At.allEvents){At.allEvents=[]}if(!At.unLoadListener){At.unLoadListener=BZ(window,"unload",Bx)}}function Aq(A){return(A.tagName||A==window||A==document)}function Ar(A,C){if(!A||!A.__E__){return }if(!C){for(var E=A.__E__.length-1;E>=0;E--){Ar(A,A.__E__[E])}return }var B,D=A[Ak[73]+C];while(B=D.pop()){Bv(B)}}function Au(F,H){var B,E,C=F.changedTouches;B=C?C[0].clientX:F.clientX;E=C?C[0].clientY:F.clientY;if(typeof B!=Ak[72]&&H.getBoundingClientRect){var D=H.getBoundingClientRect();return{x:B-D.left,y:E-D.top}}B=C?C[0].offsetX:F.offsetX;E=C?C[0].offsetY:F.offsetY;if(typeof B!=Ak[72]){var I=F.target||F.srcElement;var G={x:B,y:E};while(I&&I!=H){if(!(I.clientWidth==0&&I.clientHeight==0&&I.offsetParent&&I.offsetParent.nodeName=="TD")){G.x+=I.offsetLeft;G.y+=I.offsetTop}I=I.offsetParent;if(I){G.x-=I.scrollLeft;G.y-=I.scrollTop}else{var A=Bz(H);return{x:G.x-A.x,y:G.y-A.y}}}return G}B=C?C[0].pageX:F.pageX;E=C?C[0].pageY:F.pageY;if(typeof B!=Ak[72]){var G=Bz(H);return{x:B-G.x,y:E-G.y}}return{x:0,y:0}}function Az(A,B,D,C){return BZ(A,B,Aq(A)?A2(D,C):Bw(D,C))}function A2(B,A){return function(){var G=B0(arguments),D,E;if(G&&(D=G[0])&&(E=D.target)&&E.__pointerEvents==Ak[71]){if(D.__copyed==true){return }var I=typeof (D.pageX)!=Ak[72]?(D.pageX):(D.clientX),C=typeof (D.pageY)!=Ak[72]?(D.pageY):(D.clientY);if(document.elementFromPoint(I,C)!=E){I-=document.documentElement.scrollLeft+document.body.scrollLeft;C-=document.documentElement.scrollTop+document.body.scrollTop}var H=[];E.style.visibility=Ak[70];H.push(E);do{var F=document.elementFromPoint(I,C);if(F&&F.__pointerEvents==Ak[71]){F.style.visibility=Ak[70];H.push(F)}else{break}}while(F);while(E=H.pop()){E.style.visibility=Ak[69]}D.__copyed=true;if(F){AA(F,D.type,G)}return }A.apply(B,G)}}function Bu(A){return document.all?A.button:(A.button==2?2:1)}function Bv(A){if(!A||!A.object){return }if(Aq(A.object)){if(A.object.removeEventListener){A.object.removeEventListener(A.eventName,A.handle,false)}else{if(A.object.detachEvent){A.object.detachEvent("on"+A.eventName,A.handle)}else{A.object["on"+A.eventName]=null}}}A3(A.object[Ak[73]+A.eventName],A);A3(At.allEvents,A);delete A.object;delete A.handle;delete A.eventName;A=null}function Bw(A,B){return function(){return B.apply(A,arguments)}}function Bx(){var A=At.allEvents;if(A){for(var B=A.length-1;B>=0;B--){Bv(A[B])}}At.allEvents=null}function By(){var A=B0(arguments)[0];if(!A){return }try{A.stopPropagation()}catch(B){A.cancelBubble=true}}function Bz(A,B){var D={x:0,y:0};var C=A;while(C&&C.offsetParent&&C!=B){D.x+=C.offsetLeft;D.y+=C.offsetTop;C=C.offsetParent;if(C){D.x-=C.scrollLeft;D.y-=C.scrollTop}}return D}function B0(A){if(!A){A=[]}if(!A[0]){A[0]=window.event}if(A[0]&&!A[0].target&&A[0].srcElement){A[0].target=A[0].srcElement}return A}function AA(G,L,C,A){if(Aq(G)){if(G.fireEvent){G.fireEvent("on"+L,C?C[0]:null)}if(G.dispatchEvent){var D=document.createEvent("MouseEvent"),E=C?C[0]:null;if(D&&E){D.initMouseEvent(L,(A!==false),true,E.view,E.detail,E.screenX,E.screenY,E.clientX,E.clientY,E.ctrlKey,E.altKey,E.shiftKey,E.metaKey,E.button,E.relatedTarget);G.dispatchEvent(D)}}return }if(!C){C=[]}var K=true,B=G[Ak[73]+L];if(B&&B.length>0){B=B.concat([]);var F=B.length;for(var H=0;H<F;H++){var I=B[H];if(I&&I.handle){var J=I.handle.apply(G,C);if(J===false){K=false}}}}return K}function BS(){var A=B0(arguments)[0];if(!A){return }try{A.stopPropagation()}catch(B){A.cancelBubble=true}try{A.preventDefault()}catch(B){A.returnValue=false}}function BT(C,B){if(!C){return }if(C.parentNode&&!B){C.parentNode.removeChild(C)}if(!B){Ar(C)}var A;while(A=C.firstChild){BT(A)}}function BZ(A,D,B){if(!B){return }if(Aq(A)){B=A2(A,B);if(A.addEventListener){A.addEventListener(D,B,false)}else{if(A.attachEvent){A.attachEvent("on"+D,B)}else{var E=A["on"+D];if(typeof (E)=="function"){A["on"+D]=function(){E();B()}}else{A["on"+D]=B}}}}var C={object:A,eventName:D,handle:B};if(!A.__E__){A.__E__=[]}if(Ab(A.__E__,D)<0){A.__E__.push(D)}if(!A[Ak[73]+D]){A[Ak[73]+D]=[]}A[Ak[73]+D].push(C);if(D!="unload"){Ao();At.allEvents.push(C)}return C}Am(At,{init:Ao,isHtmlControl:Aq,clearListeners:Ar,getEventPosition:Au,bind:Az,createAdapter:A2,getEventButton:Bu,removeListener:Bv,getCallback:Bw,clearAllListeners:Bx,returnTrue:By,getPageOffset:Bz,getWindowEvent:B0,trigger:AA,returnFalse:BS,deposeNode:BT,addListener:BZ});function BL(){}function Ba(A,C,E){var D;if(A.indexOf(".png")>0&&Be(C)){D=document.createElement("div");BF(D,{overflow:Ak[70]});var B=document.createElement("img");BF(B,{visibility:Ak[70],width:Ak[68],height:Ak[68]});BZ(B,"load",Bc);D.appendChild(B)}else{D=document.createElement("img");D.hspace=0}if(!E){BR(D,A)}return D}function Bb(A){return A.parentNode&&A.parentNode.nodeType!=11}function Bc(){var B=this.parentNode,A=this.src;BF(B,{filter:'progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale,src="'+A+'")'});BF(this,{position:Ak[67]})}function Bd(A,B,E){var D=A.style;E=E?E:Ak[66];if(B.indexOf(".")>=0){B="url("+B+")"}try{D.cursor=B+","+E;return }catch(C){}try{D.cursor=B;return }catch(C){}try{D.cursor=E;return }catch(C){}}function Be(A){if(A&&document.all){return true}if(typeof (BL._UFT)==Ak[72]){BL._UFT=(document.all&&!window.XMLHttpRequest)?true:false}return BL._UFT}function Bf(A,B){BF(A,{filter:(B<1?(Ak[65]+parseInt(B*100)+")"):""),MozOpacity:B,opacity:B})}function Bg(A,B){BF(A,{left:Math.round(B.x)+"px",top:Math.round(B.y)+"px"})}function Bh(B){var C=BL.sln;if(!C){return }for(var A=C.length-1;A>=0;A--){if(C[A].src==B){BT(C[A]);C.splice(A,1);break}}}function Bi(A){if(document.all){A.unselectable="on";A.onselectstart=Ax}else{BF(A,{MozUserSelect:Ak[71]});BF(A,{WebkitUserSelect:Ak[71]})}}function Bq(A,B){BF(A,{width:Math.round(B.x)+"px",height:Math.round(B.y)+"px"})}function Av(A,B){for(var C in B){A[C]=B[C]}}function Ax(){return false}function A3(A,B,C){for(var D=A.length-1;D>=0;D--){if(A[D]==B){A.splice(D,1);if(!C){return }}}return }function A5(D,R,B,Q,I){R=Math.round(R%360);var N=R*Math.PI/180,P=D.style;var F,H=Ak[64];if(typeof (P[(F=Ak[63])])==H||typeof (P[(F=Ak[62])])==H||typeof (P[(F=Ak[61])])==H){var G=(R==0)?"":"rotate("+R+"deg)",E={};E[F]=G;BF(D,E);if(Q&&I&&B){var K=I.x,L=I.y,T=B.x,A=B.x,U=Q.x,C=Q.y,M;var J=Math.sqrt(Math.pow(K-T/2,2)+Math.pow(L-A/2,2));if(J>0){var O=Math.acos((L-A/2)/J);if(K-T/2<0){O=-O}M={x:U+K-T/2-J*Math.sin(O-N),y:C+L-A/2-J*Math.cos(O-N)};Bg(D,M)}}return true}if(typeof (P.filter)==Ak[64]&&document.body.filters){BF(D,{filter:(R==0)?"":"progid:DXImageTransform.Microsoft.Matrix(sizingMethod='auto expand',M11="+Math.cos(N)+",M12="+(-Math.sin(N))+",M21="+Math.sin(N)+",M22="+Math.cos(N)+")"});if(Q&&I&&B){var K=I.x,L=I.y,T=B.x,A=B.x,U=Q.x,C=Q.y,M;if(R<=90){M={x:(((A-L)*Math.tan(N)+K)*Math.cos(N)),y:((L+K*Math.tan(N))*Math.cos(N))}}else{if(R<=180){M={x:(((T-K)*Math.tan(N-Math.PI/2)+(A-L))*Math.cos(N-Math.PI/2)),y:(((A-L)*Math.tan(N-Math.PI/2)+K)*Math.cos(N-Math.PI/2))}}else{if(R<=270){M={x:((L*Math.tan(N-Math.PI)+(T-K))*Math.cos(N-Math.PI)),y:(((T-K)*Math.tan(N-Math.PI)+(A-L))*Math.cos(N-Math.PI))}}else{M={x:((K*Math.tan(N-Math.PI*3/2)+L)*Math.cos(N-Math.PI*3/2)),y:((L*Math.tan(N-Math.PI*3/2)+(T-K))*Math.cos(N-Math.PI*3/2))}}}}Bg(D,{x:U-M.x+K,y:C-M.y+L})}return true}return false}function A7(E,A){var G=BL.sln,B=new Date().valueOf();if(!G){G=BL.sln=[]}else{var H=G.length;for(var D=0;D<G.length;D++){if(G[D]._slt-B>5000){BT(G[D]);G.splice(D,1);D--}else{break}}}var F=document.createElement("script");F.defer=true;G.push(F);F.charset=A?A:"utf-8";var C=document.body?document.body:document.head;C.insertBefore(F,C.firstChild);F.src=E}function BA(A,B,D){if(B.indexOf(".png")>0&&Be(D)){var C=document.createElement("img");BF(C,{position:Ak[60],border:"0px",visibility:Ak[70],width:Ak[68],height:Ak[68],left:"0px",top:"0px",zIndex:-1});BZ(C,"load",Bc);A.appendChild(C);C.src=B}else{BF(A,{backgroundImage:"url("+B+")"})}}function BB(A){return(typeof (A)==Ak[59])?A:document.getElementById(A)}function BD(I,A,G,C){var H=I.style;var D,B=Ak[64];if(typeof (H[(D=Ak[63])])==B||typeof (H[(D=Ak[62])])==B||typeof (H[(D=Ak[61])])==B){var F=(A==1)?"":"scale("+A+")",E={};E[D]=F;BF(I,E);if(G&&C){Bg(I,{x:G.x-C.x*(A-1),y:G.y-C.y*(A-1)})}return true}if(typeof (H.zoom)==Ak[64]&&typeof (H.boxSizing)!=Ak[64]){if(H.zoom!=A){BF(I,{zoom:A})}if(G&&C){Bg(I,{x:G.x-C.x*(A-1),y:G.y-C.y*(A-1)})}return true}return false}function BF(I,B,E){if(E){I._cssObj=false}if(document.all&&!E&&I._cssObj!==false&&typeof (I.style.cssText)==Ak[64]){var A,C=I._cssObj,F=new RegExp("[A-Z]","g");if(!C){C=I._cssObj={}}var G=0;for(A in B){var D;switch(A){case"styleFloat":D="float";break;case"cursor":D=A;if(B[A]==Ak[58]&&document.all){B[A]="hand"}break;default:D=A.replace(F,function(J){return"-"+J.toLowerCase()});break}C[D]=B[A];G++}if(G<2){Av(I.style,B);return }var H=[];for(A in C){H.push(A+":"+C[A])}if(document.all){I.style.cssText=H.join(";")}else{I.setAttribute("style",H.join(";"))}}else{Av(I.style,B)}}function BQ(B){var A={x:B.offsetWidth,y:B.offsetHeight};if(B==document.body&&!document.all){A.y=B.clientHeight}if(!A.x){A.x=B.clientWidth}if(!A.x){A.x=parseInt(B.style.width)}if(!A.y){A.y=B.clientHeight}if(!A.y){A.y=parseInt(B.style.height)}if(!A.x||!A.y){B=B.parentElement;while(B){if(!A.x&&B.offsetWidth){A.x=B.offsetWidth}if(!A.y&&B.offsetHeight){A.y=B.offsetHeight}if(A.x&&A.y){break}B=B.parentElement}}return A}function BR(C,A){C.src=A;var B=C.firstChild;while(B){if(B.nodeName!="IMG"){B=B.nextSibling;continue}B.src=A;break}}function Ab(A,B){for(var C=A.length-1;C>=0;C--){if(A[C]==B){return C}}return -1}Am(BL,{createImage:Ba,isInDocument:Bb,setAlphaImage:Bc,setCursor:Bd,useFilterTransparent:Be,setOpacity:Bf,setElementPosition:Bg,removeScript:Bh,setUnSelectable:Bi,setElementSize:Bq,setProperty:Av,falseFunction:Ax,deleteFrom:A3,setRotate:A5,loadScript:A7,setBackgroundImage:BA,getElement:BB,setZoom:BD,setStyle:BF,getElementSize:BQ,setImageSrc:BR,indexOf:Ab});function A8(A,B,C){Av(this,{div:A,handle:B,container:A,interval:256});Av(this,C)}Am(A8.prototype,{onMouseMove:function(A){BS(A);var H=Au(A,this.container),D=this.rtp;Av(this,{lp:H,moveed:true});if(D){var F=this.dsp,B=this.sp;var E=F.x+D.x*(H.x-B.x),G=F.y+D.y*(H.y-B.y);var C=this.rtpLimit;if(C){if(C.minX){E=Math.max(E,C.minX)}if(C.maxX){E=Math.min(E,C.maxX)}if(C.minY){G=Math.max(G,C.minY)}if(C.maxY){G=Math.min(G,C.maxY)}}Bg(this.div,{x:E,y:G})}},onMouseDown:function(B){BS(B);var A=this.div;if(A.setCapture){A.setCapture()}var D=Au(B,this.container);Av(this,{ml:Az(document,Ak[56],this,this.onMouseMove),ul:Az(document,Ak[55],this,this.onMouseUp),sp:D,lp:D,timeout:window.setInterval(Bw(this,this.onTime),this.interval)});if(this.rtp){var C=A.style;this.dsp={x:parseInt(C.left),y:parseInt(C.top)}}this.handle(D,D,"start")},onTime:function(){if(this.div&&this.moveed){this.handle(this.sp,this.lp);this.moveed=false}},onMouseUp:function(A){this.onTime();BS(A);Bv(this.ml);Bv(this.ul);window.clearInterval(this.timeout);delete this.div;delete this.container;if(document.releaseCapture){document.releaseCapture()}this.handle(this.sp,this.lp,"end")}});function Ac(A,B,C){return BZ(A,Ak[57],function(D){if(Bu(D)!=1){return }var E=new A8(A,B,C);E.onMouseDown(D)})}Am(A8,{setup:Ac});function Bs(B,A){this.x=B;this.y=A}function Aw(){if(arguments.length<1){return }this.div=document.createElement("div")}Am(Aw.prototype,{init:function(C,B,A){},setPointerEvents:function(A){this.div.__pointerEvents=A},setPosition:function(A){BF(this.div,{position:Ak[67],left:A.x+"px",top:A.y+"px"})},setScale:function(){},setLineColor:function(){},getPanel:function(){return this.div},clear:function(){},setLineStyle:function(){},setFillColor:function(){},drawPolyline:function(A){return this.drawPolygon(A,true)},setLineWeight:function(){},setOpacity:function(){},setLineArrow:function(){}});function Bn(){var A=this.div=document.createElement("canvas");BF(A,{position:Ak[67]})}Bn.prototype=new Aw();Am(Bn.prototype,{init:function(C,B,A){Av(this,{minPoint:C,maxPoint:B,scale:A});this.clear()},setPosition:function(B){if(!B){return }this.lastPosition=B;var A=this.lineWeight;BF(this.div,{position:Ak[67],left:(B.x-A/2)+"px",top:(B.y-A/2)+"px"})},setScale:function(A){this.lastScale=A;var B=this.maxPoint,D=this.minPoint,C=this.lineWeight;BF(this.div,{width:Math.abs(B.x-D.x)/A+C+"px",height:Math.abs(B.y-D.y)/A+C+"px"});this.reDraw()},drawPolygon:function(A,B){this.pathArr.push({points:A,type:B?Ak[54]:Ak[53]});this.lastScale=this.scale;this.reDraw()},setLineColor:function(A){if(A==Ak[52]){A=""}this.lineColor=A;this.reDraw()},clear:function(){this.pathArr=[];var A=this.div.getContext("2d")},setFillColor:function(A){if(A==Ak[52]){A=""}this.bgcolor=A;this.reDraw()},setLineWeight:function(A){this.lineWeight=A;this.reDraw()},reDraw:function(){var I=this.scale,K=this.lastScale,E=this.maxPoint,B=this.minPoint,N=this.div,G=this.lineWeight,C=this.pathArr;if(!E||!C||C.length==0){return }Av(N,{width:Math.abs(E.x-B.x)/this.lastScale+G,height:Math.abs(E.y-B.y)/this.lastScale+G});var O=N.getContext("2d");Av(O,{fillStyle:this.bgcolor,globalAlpha:this.opacity});if(G>0&&this.lineColor!=Ak[52]&&this.lineColor!=""){Av(O,{lineCap:Ak[51],lineJoin:Ak[51],lineWidth:G*K/I,strokeStyle:this.lineColor})}O.beginPath();O.scale(I/K,I/K);var H=G*K/I/2;for(var F=0;F<C.length;F++){var M=C[F];switch(M.type){case Ak[54]:case Ak[53]:var A,P=M.points,D=P.length,J=B.x,L=B.y;A=P[0];O.moveTo((A.x-J)/I+H,(A.y-L)/I+H);for(var F=1;F<D;F++){A=P[F];O.lineTo((A.x-J)/I+H,(A.y-L)/I+H)}if(M.type==Ak[53]){A=P[0];O.lineTo((A.x-J)/I+H,(A.y-L)/I+H)}break}}if(this.bgcolor){O.fill()}if(G>0&&this.lineColor!=Ak[52]&&this.lineColor!=""){O.stroke()}},setOpacity:function(A){this.opacity=A;this.reDraw()}});function Ad(){if(typeof (Bn._isSupport)==Ak[72]){Bn._isSupport=!!document.createElement("canvas").getContext}return Bn._isSupport}Am(Bn,{isSupport:Ad});function BN(){var A=this.div=document.createElement("div");BF(A,{position:Ak[67]});this.ctx=new window.jsGraphics(A)}BN.prototype=new Aw();Am(BN.prototype,{init:function(C,B,A){Av(this,{minPoint:C,maxPoint:B,scale:A});this.clear()},setScale:function(A){this.lastScale=this.scale=A;var B=this.maxPoint,C=this.minPoint;BF(this.div,{width:Math.abs(B.x-C.x)/A+"px",height:Math.abs(B.y-C.y)/A+"px"});this.reDraw()},drawPolygon:function(A,B){this.pathArr.push({points:A,type:B?Ak[54]:Ak[53]});this.lastScale=this.scale;this.reDraw()},setLineColor:function(A){if(A==Ak[52]){A=""}this.lineColor=A;this.reDraw()},clear:function(){this.pathArr=[];BT(this.div,true)},setLineStyle:function(A){this.lineStyle=A.toLowerCase()},setLineWeight:function(A){this.lineWeight=A;this.reDraw()},setFillColor:function(A){if(A==Ak[52]){A=""}this.bgcolor=A;this.reDraw()},reDraw:function(){var H=this.scale,J=this.lastScale,F=this.maxPoint,B=this.minPoint,M=this.div,C=this.pathArr;if(!F||!C||C.length==0){return }Av(M,{width:Math.abs(F.x-B.x)/J,height:Math.abs(F.y-B.y)/J});var O=this.ctx;O.clear();for(var G=0;G<C.length;G++){var L=C[G];switch(L.type){case Ak[54]:case Ak[53]:var A,P=L.points,E=P.length,I=B.x,K=B.y,N=[],D=[];for(var G=0;G<E;G++){A=P[G];N.push((A.x-I)/H);D.push((A.y-K)/H)}if(this.bgcolor){O.setColor(this.bgcolor);O.fillPolygon(N,D)}if(this.lineColor){O.setColor(this.lineColor);O.setStroke((this.lineStyle&&this.lineStyle!="solid"&&window.Stroke)?window.Stroke.DOTTED:this.lineWeight);O.drawPolyline(N,D)}break}}O.paint()},setOpacity:function(A){BF(this.div,{filter:Ak[65]+parseInt(A*100)+")",MozOpacity:A,opacity:A})}});function Ae(){return !!window.jsGraphics}Am(BN,{isSupport:Ae});function An(){var B=Ak[50];var A=this.div=document.createElementNS(B,"svg");BF(A,{position:Ak[67]});if(!window.opera||!window.opera.version){A.__pointerEvents=Ak[71]}var C=this.path=document.createElementNS(B,"path");A.appendChild(C);C.setAttribute("stroke-linecap",Ak[51]);C.setAttribute("stroke-linejoin",Ak[51])}An.prototype=new Aw();Am(An.prototype,{init:function(C,B,A){Av(this,{minPoint:C,maxPoint:B,scale:A});this.clear()},setPointerEvents:function(A){this.path.__pointerEvents=A},setPosition:function(B){if(!B){return }this.lastPosition=B;var A=this.lineWeight;BF(this.div,{position:Ak[67],left:(B.x-A/2)+"px",top:(B.y-A/2)+"px"})},setScale:function(A){var D=this.minPoint,B=this.maxPoint,C=this.lineWeight;if(!B){return }BF(this.div,{width:(B.x-D.x)/A+C+"px",height:(B.y-D.y)/A+C+"px"});this.path.setAttribute(Ak[61],"scale("+(this.scale/A)+") translate("+(C/2*A/this.scale)+","+(C/2*A/this.scale)+")");if(!this.lastWeight||Math.round(this.lastWeight*this.scale/A)!=C){this.path.setAttribute("stroke-width",this.lastWeight=C/this.scale*A)}this.lastScale=A},drawPolygon:function(B,F){var E=B.length,H=B[0],A=[],J=this.scale,D=this.minPoint,I=D.x,K=D.y,C;if(E>1){C=B[0];A.push("M");A.push(parseInt((C.x-I)/J));A.push(parseInt((C.y-K)/J));A.push("L");for(var G=1;G<E;G++){C=B[G];A.push(parseInt((C.x-I)/J));A.push(parseInt((C.y-K)/J))}if(!F){C=B[0];A.push(parseInt((C.x-I)/J));A.push(parseInt((C.y-K)/J))}this.pathArr.push(A.join(" "));this.path.setAttribute("d",this.pathArr.join(" "))}},setLineColor:function(A){if(A==Ak[52]||!A){A=Ak[71]}this.lineColor=A;this.path.setAttribute("stroke",(this.lineWeight>0&&this.lineColor!=Ak[52]&&this.lineColor!="")?this.lineColor:Ak[71])},clear:function(){this.pathArr=[];this.path.setAttribute("d","")},setLineStyle:function(A){var B;switch(A.toLowerCase()){case Ak[49]:B=[1,6];break;case"dashed":B=[6,6];break;default:break}if(this.dashArray){this.path.setAttribute("stroke-dasharray",this.dashArray=B)}},setFillColor:function(A){if(A==Ak[52]||!A){A=Ak[71]}this.bgcolor=A;this.path.setAttribute("fill",(A?A:Ak[71]))},setLineWeight:function(A){this.lineWeight=A;this.path.setAttribute("stroke",(this.lineWeight>0&&this.lineColor!=Ak[52]&&this.lineColor!="")?this.lineColor:Ak[71]);this.setScale(this.lastScale);this.setPosition(this.lastPosition)},setOpacity:function(A){this.path.setAttribute("opacity",this.opacity=A)}});function Af(){if(typeof (An._isSupport)==Ak[72]){if(document.createElementNS){var B=Ak[50];var A=document.createElementNS(B,"svg");An._isSupport=typeof (A.ownerSVGElement)==Ak[59]}else{An._isSupport=false}}return An._isSupport}Am(An,{isSupport:Af});function A6(){var A=this.div=document.createElement("v:shape");BF(A,{behavior:Ak[48],position:Ak[67]});BF(A,{},true);Av(A,{unselectable:"on",filled:"true"});var B=this.stroke=document.createElement("v:stroke");Av(B,{joinstyle:Ak[51],endcap:Ak[51]});A.appendChild(B);var C=this.fill=document.createElement("v:fill");A.appendChild(C);BF(C,{behavior:Ak[48]});BF(B,{behavior:Ak[48]})}A6.prototype=new Aw();Am(A6.prototype,{init:function(C,B,A){Av(this,{minPoint:C,maxPoint:B,scale:A,pathArr:[]});this.div.coordsize=parseInt(Math.abs(B.x-C.x)*256/A)+","+parseInt(Math.abs(B.y-C.y)*256/A);this.div.path="e"},setPosition:function(B){if(!B){return }this.lastPosition=B;var A=this.lineWeight;A=A?A:1;BF(this.div,{position:Ak[67],left:(B.x-A/2)+"px",top:(B.y-A/2)+"px"})},setScale:function(A){var D=this.minPoint,B=this.maxPoint,C=this.lineWeight;C=C?C:1;BF(this.div,{width:(B.x-D.x)/A+C+"px",height:(B.y-D.y)/A+C+"px"})},drawPolygon:function(A,F){var E=A.length,H=A[0],D=this.pathArr,J=this.scale,C=this.minPoint,I=C.x,K=C.y,B;if(E>1){B=A[0];D.push("m");D.push(parseInt((B.x-I)*256/J));D.push(parseInt((B.y-K)*256/J));D.push("l");for(var G=1;G<E;G++){B=A[G];D.push(parseInt((B.x-I)*256/J));D.push(parseInt((B.y-K)*256/J))}if(!F){B=A[0];D.push(parseInt((B.x-I)*256/J));D.push(parseInt((B.y-K)*256/J))}this.div.path=D.join(" ");this.setScale(J)}},setLineColor:function(B){var A=this.div;A.strokecolor=B;A.stroked=B!=Ak[52]&&B!=""&&A.strokeweight>0},clear:function(){this.div.style.display=Ak[71];this.pathArr=[];this.div.path="e";this.div.style.display=""},setLineStyle:function(A){switch(A.toLowerCase()){case Ak[49]:A="ShortDot";break;case"dashed":A="ShortDash";break}this.stroke.dashstyle=A},setFillColor:function(B){var A=this.div;if(B==Ak[52]||B==""){A.filled=false}else{A.filled=true;A.fillcolor=B}},setLineWeight:function(B){var A=this.div;A.strokeweight=B*3/4;A.stroked=A.strokecolor!=Ak[52]&&A.strokecolor!=""&&B>0},setOpacity:function(A){this.stroke.opacity=A;this.fill.opacity=A},setLineArrow:function(A){if(A[0]){this.stroke.startarrow=A[0]}if(A[1]){this.stroke.endarrow=A[1]}}});function Ah(){if(typeof (A6._isSupport)==Ak[72]){try{if(document.namespaces){if(!document.namespaces.v){document.namespaces.add("v","urn:schemas-microsoft-com:vml")}var A=document.createElement("v:shape");BF(A,{behavior:Ak[48]});A.style.behavior=Ak[48];document.body.appendChild(A);A6._isSupport=typeof (A.Path)==Ak[59];A.parentNode.removeChild(A)}else{A6._isSupport=false}}catch(B){A6._isSupport=false}}return A6._isSupport}Am(A6,{isSupport:Ah});function BE(B,A){Av(this,{render:B,id:A})}Am(BE.prototype,{load:function(B){var D=this.render,F,E,A=D.layer.control.htmlBufImgs;if(A&&(F=A[B])){this.img=F;D.layer.onTileLoaded(this.id)}else{if(D.utf){F=this.img=document.createElement("div");var C=document.createElement("img");BF(C,{visibility:Ak[70],width:Ak[68],height:Ak[68]});this.ll=Az(C,"load",this,this.onLoad);this.el=Az(C,"error",this,this.onError);F.appendChild(C)}else{F=this.img=document.createElement("img");this.ll=Az(F,"load",this,this.onLoad);this.el=Az(F,"error",this,this.onError);Av(F,{galleryImg:false})}BR(F,B);Bi(F);if(E=D.tileStyle){BF(F,E)}}},show:function(){if(!Bb(this.img)){this.render.layer.getMapDiv(this.id.z).div.appendChild(this.img)}},setPosition:function(C){var H=this.render,J=H.layer.control.map,I=this.id,G=J.getScale(),F=this.img;if(AD()){var B=G,K=H.layer.getMapDiv(this.id.z).div,A=J.getViewSize();G=H.layer.tileDef.levels[I.z].scale;if(K._zoom!=G/B){K._zoom=G/B;BD(K,G/B,{x:0,y:0},{x:A.x/2,y:A.y/2})}if(!C){return }}var L=H.layer.tileDef.getBoundsById(I),E=J.getGeoPosition(L.sw,G),D=J.getGeoPosition(L.ne,G);BF(F,{position:Ak[67],width:Math.abs(D.x-E.x)+"px",height:Math.abs(D.y-E.y)+"px",left:Math.min(E.x,D.x)+"px",top:Math.min(E.y,D.y)+"px"})},stop:function(){Bv(this.ll);Bv(this.el);delete this.ll;delete this.el},addBuffer:function(){var C=this.render.layer.control,A=C.htmlBufImgs,E=C.htmlBufNum,B=this.img.src;if(!A){A=C.htmlBufImgs=[];E=C.htmlBufNum=500}if(E<=0||A[B]){return }A[B]=this.img;A.push(B);var D=A.length-E;for(var F=0;D>0&&F<A.length;F++){var H=A[F],G=A[H];if(!G.isShow){if(A[H]){delete A[H]}A.splice(F,1);F--;D--}}},onLoad:function(){this.stop();var A=this.render,B=this.img;A.layer.onTileLoaded(this.id);this.addBuffer(this);B.isShow=true;if(!Bb(this.img)){A.layer.getMapDiv(this.id.z).div.appendChild(this.img)}if(A.utf){Bc.apply(this.img.firstChild)}},hide:function(){this.stop();var B=this.img,A=B.parentNode;if(A){A.removeChild(B)}},onError:function(){this.stop();var A=this.render;A.layer.onTileError(this.id);if(A.errorImgUrl){this.img.src=A.errorImgUrl}else{BF(this.img,{display:Ak[71]})}if(!Bb(this.img)){A.layer.getMapDiv(this.id.z).div.appendChild(this.img)}},depose:function(){this.hide();BT(this.img);delete this.render;delete this.img}});function Ai(B){var A=document.createElement("div");BF(A,{position:Ak[67],zIndex:B.zIndex});B.layer.control.map.getGeoPanel().appendChild(A);return A}function Aj(){return true}function AB(){return true}function AD(){if(typeof (BE._scaleByDiv)!="boolean"){var A=document.createElement("div");BE._scaleByDiv=BD(A,2)}return BE._scaleByDiv}Am(BE,{getContainer:Ai,isSupport:Aj,hasLoadEvent:AB,scaleByDiv:AD});function Al(A){Av(this,{config:A,zIndex:100,scalePower:0.8});Av(this,A)}Am(Al.prototype,{isTranPng:function(){return !!this._isTranPng},getTileType:function(){var A=[BE];for(var B=0;B<A.length;B++){if(A[B].isSupport(this)){return A[B]}}},removeDiv:function(A){BT(A.div);delete A.div},setPosition:function(A,B){A.tile.setPosition(B)},loadTile:function(A,C){if(!A.tile&&!C){var B=this.tileType;var D=A.tile=new B(this,A);D.load(this.getImgUrl(A))}return !!A.tile},getImgUrl:function(M){var H=this.imgURLs,D=M.x,G=M.y,A=H[Math.abs(D+G)%H.length],C=this.layer.getTileDefinition().getZoomLevels()[M.z].name;if(!this.useStaticPath){var L=this.zTag;return[A,"x=",D,"&y=",G,"&",(L=L?L:"z"),"=",C].join("")}var F=Math.floor(C/4),B=[A];for(var J=0;J<F;J++){var E=1<<(C-4*J-4);var I=parseInt(D/E)%16,K=parseInt(G/E)%16;B=B.concat((K>9)?K:"0"+K,(I>9)?I:"0"+I,"/")}B=B.concat(D,"_",G,".png");return B.join("")},setCurrentIndex:function(B,A){if(A){BF(A.div,{zIndex:this.zIndex})}BF(B.div,{zIndex:this.zIndex+1})},initialize:function(A){this.layer=A;this.tileType=this.getTileType();this.utf=this.isTranPng()&&Be()},remove:function(){delete this.layer;delete this.tileType},deposeTile:function(A){this.hideTile(A);A.tile.depose()},initDiv:function(A){A.div=this.tileType.getContainer(this)},showTile:function(A){var B=A.tile;B.show();B.setPosition(true)},hideTile:function(A){A.tile.hide()},copy:function(){return new Al(this.config)}});function Aa(){Av(this,{tileSize:{x:256,y:256},errorTileUrl:""})}Am(Aa.prototype,{getZoomIndex:function(A){var D=this.levels,E=D.length;for(var B=0;B<E;B++){var C=D[B].scale;if(A>=C){if(B>0&&A/D[B-1].scale>C/A){return B-1}return B}}return E-1},getProjection:function(){return this.prj},getZoomLevels:function(){return this.levels},getIdRange:function(C,D){var B=this.toMapId(C.sw,D),A=this.toMapId(C.ne,D);return[B.x,B.y,A.x,A.y]}});function BP(D){D=D?D:{};Aa.apply(this);Av(this,{prj:new A9(),config:D});Av(this,D);var B=this.levels=[];var E=D.maxLevel?D.maxLevel:20;var A=D.minLevel?D.minLevel:0;for(var C=A;C<=E;C++){B.push({scale:360/256/Math.pow(2,C),name:C})}}BP.prototype=new Aa();Am(BP.prototype,{toMapId:function(E,D){var A=this.levels[D].scale,C=this.tileSize;var B=this.prj.fromLatLngToPixel(E);B={x:(180+B.x)/A,y:(180+B.y)/A};return{x:parseInt(B.x/C.x),y:parseInt(B.y/C.y)}},getBoundsById:function(A){var B=this.levels[A.z].scale,C=this.tileSize,E=this.prj;var F=E.fromPixelToLatLng({x:A.x*B*C.x-180,y:A.y*B*C.y-180});var D=E.fromPixelToLatLng({x:(A.x+1)*B*C.x-180,y:(A.y+1)*B*C.y-180});return new BG(new AM(Math.min(F.la,D.la),Math.min(F.lo,D.lo)),new AM(Math.max(F.la,D.la),Math.max(F.lo,D.lo)))}});function Bk(B,A){Av(this,{tileDef:B,tileRender:A})}Am(Bk.prototype,{removeDiv:function(A){this.clearDiv(A);var B=this.getMapDiv(A);if(A==this.currentIndex){this.currentIndex=-1}delete this.mapDivs[A]},onMapMove:function(){if(this.currentIndex>=0){this.showTiles(this.currentIndex)}},clearDiv:function(C){var D=this.getMapDiv(C),E=D.mapTiles;for(var A in E){var B=E[A];if(!B.x){continue}this.hideTile(B,E)}D.mapTiles={};D.tileBounds=null;this.tileRender.removeDiv(D)},onTileError:function(A){A.isError=true;this.setTileStat(A.z,"error",1)},showTiles:function(Q,W,D,b){var B=this.getMapDiv(Q),J=B.tileBounds,M=this.control.map,I;if(M.getTargetScale){var A=M.getScale(),C=M.getTargetScale();I=M.getBounds(null,null,null,b?Math.max(A,C):Math.min(A,C))}else{I=M.getBounds()}if(W||D){J=null}if(J&&J.containsBounds(I)){return }var U=this.tileDef,T=U.getZoomLevels()[Q].scale,Y=M.getScale(),a=this.tileRender;if(Math.abs(Math.log(Y/T))>a.scalePower){this.removeDiv(Q);return }var E=U.getIdRange(I,Q);var P=Math.min(E[0],E[2]),R=Math.min(E[1],E[3]),V=Math.max(E[0],E[2]),X=Math.max(E[1],E[3]);var K=B.mapTiles,Z;for(var N in K){Z=K[N];if(!Z.x){continue}if(P>Z.x||V<Z.x||R>Z.y||X<Z.y||(b&&!Z.isLoaded)){this.hideTile(Z,K);continue}a.setPosition(Z,D)}for(var F=P;F<=V;F++){for(var G=R;G<=X;G++){var O="Tile_"+F+"_"+G+"_"+Q,Z=K[O];if(!Z){Z={x:F,y:G,z:Q};Z.bounds=U.getBoundsById(Z);if(a.loadTile(Z,b)){K[O]=Z;this.setTileStat(Z.z,"total",1)}}}}var L=U.getBoundsById({x:P,y:R,z:Q}),H=U.getBoundsById({x:V,y:X,z:Q});B.tileBounds=L.extend(H.sw).extend(H.ne)},onTileLoaded:function(A){if(!A.isLoaded){A.isLoaded=true;this.setTileStat(A.z,"show",1);this.tileRender.showTile(A)}},getMapDiv:function(B){if(typeof (B)==Ak[72]||B<0){return }var A=this.mapDivs;if(!A){A=this.mapDivs={}}var C=A[B];if(!C){C=A[B]={mapTiles:{},tileStat:{total:0,error:0,show:0},index:B};this.tileRender.initDiv(C)}return C},setCurrentIndex:function(B){var A=this.currentIndex;if(A==B){return }if(this.cTimeout){window.clearTimeout(this.cTimeout);delete this.cTimeout}this.currentIndex=B;this.tileRender.setCurrentIndex(this.getMapDiv(B),this.getMapDiv(A))},setTileStat:function(C,D,B){var A=this.getMapDiv(C).tileStat;A[D]+=B;if(this.control.setTileStat){this.control.setTileStat(D,B)}if(D=="show"&&this.currentIndex==C&&!this.cTimeout){this.cTimeout=setTimeout(Bw(this,this.checkTile),100)}},onMapScale:function(E){var H=this.control.map,F=H.getScale(),J=H.getCenter();if(!J){return }var C=this.zoomIndex=this.tileDef.getZoomIndex(F);var A=this.getMapDiv(C);this.setCurrentIndex(C);var G=this.mapDivs;if(G){for(var B in G){var I=G[B];if(!I||!I.mapTiles){continue}if(this.singleTileDiv&&I!=A){this.removeDiv(B);continue}var D=(I!=A)||(H.getTargetScale&&this.tileDef.getZoomIndex(H.getTargetScale())!=C);this.showTiles(B,true,E,D)}}},initialize:function(A){this.control=A;this.tileRender.initialize(this)},remove:function(){this.currentIndex=-1;var A=this.mapDivs;for(var B in A){if(!A[B].mapTiles){return }this.removeDiv(B)}this.tileRender.remove();delete this.mapDivs},hideTile:function(A,B){if(A.isError){this.setTileStat(A.z,"error",-1)}if(A.isLoaded){this.setTileStat(A.z,"show",-1);this.tileRender.hideTile(A)}else{this.tileRender.deposeTile(A)}this.setTileStat(A.z,"total",-1);delete B["Tile_"+A.x+"_"+A.y+"_"+A.z]},copy:function(){return new Bk(this.tileDef,this.tileRender.copy())},checkTile:function(){var D=this.currentIndex;if(D>0){var A=this.getMapDiv(D).tileStat;if(A.total==A.show){var B=this.mapDivs;for(var C in B){if(C!=D&&B[C].mapTiles){this.removeDiv(C)}}}}delete this.cTimeout},getTileDefinition:function(){return this.tileDef}});function AP(){}Am(AP.prototype,{depose:function(){this.remove()},getContainer:function(){return this.div},setLayout:function(A){this.layout=A=A?A:{x:0,y:0};if(A.x||A.y){if(this.map&&!this.rslis){this.rslis=Az(this.map,Ak[47],this,this.onMapResize)}}else{if(this.rslis){Bv(this.rslis);delete this.rslis}}this.onMapResize()},onMapResize:function(){var B=this.map,C=this.layout,D=this.position,A=B?B.getViewSize():{x:0,y:0};if(!D||!C){return }Bg(this.getContainer(),{x:Math.ceil(A.x*C.x+D.x),y:Math.ceil(A.y*C.y+D.y)})},setPosition:function(A){this.position=A?A:{x:0,y:0};this.onMapResize()},initialize:function(A){return true},remove:function(){var A=this.listeners;if(A){for(var B=A.length-1;B>=0;B--){Bv(A[B])}}Bv(this.rslis);delete this.listeners;delete this.rslis;delete this.map}});function BM(){}BM.prototype=new AP();Am(BM.prototype,{getProjection:function(){return this.prj},getBounds:function(D,E,F,B){if(!F){F=this.map.getCenter()}if(!F){return null}var A=this.map.getViewSize();var G=this.fromContainerPixelToLatLng(D?D:{x:A.x,y:0},F,B);var C=this.fromContainerPixelToLatLng(E?E:{x:0,y:A.y},F,B);return new BG(new AM(Math.min(G.lat(),C.lat()),Math.min(G.lng(),C.lng())),new AM(Math.max(G.lat(),C.lat()),Math.max(G.lng(),C.lng())))},fromLatLngToPixel:function(A){return this.prj?this.prj.fromLatLngToPixel(A):{x:A.lng(),y:A.lat()}},initialize:function(A){if(this.map){return false}Av(A,{setProjection:Bw(this,this.setProjection),getProjection:Bw(this,this.getProjection),fromLatLngToPixel:Bw(this,this.fromLatLngToPixel),fromPixelToLatLng:Bw(this,this.fromPixelToLatLng),fromContainerPixelToLatLng:Bw(this,this.fromContainerPixelToLatLng),fromLatLngToContainerPixel:Bw(this,this.fromLatLngToContainerPixel),getBounds:Bw(this,this.getBounds)});this.map=A;return true},fromContainerPixelToLatLng:function(E,F,B,D){B=B?B:this.map.getScale();F=F?F:this.map.getCenter();if(!D){var A=this.map.getViewSize();D={x:A.x/2,y:A.y/2}}var C=this.fromLatLngToPixel(F);return this.fromPixelToLatLng({x:C.x+(E.x-D.x)*B,y:C.y+(E.y-D.y)*B})},remove:function(){var A=this.map;delete A.setProjection;delete A.getProjection;delete A.fromLatLngToPixel;delete A.fromPixelToLatLng;delete A.fromContainerPixelToLatLng;delete A.fromLatLngToContainerPixel;delete A.getBounds;AP.prototype.remove.apply(this,arguments)},fromLatLngToContainerPixel:function(A,G,C,E){C=C?C:this.map.getScale();G=G?G:this.map.getCenter();if(!E){var B=this.map.getViewSize();E={x:B.x/2,y:B.y/2}}var D=this.fromLatLngToPixel(G);var F=this.fromLatLngToPixel(A);return{x:Math.round((F.x-D.x)/C+E.x),y:Math.round((F.y-D.y)/C+E.y)}},setProjection:function(A){if(A==this.prj){return }this.prj=A;AA(this.map,Ak[46],[A])},fromPixelToLatLng:function(A){return this.prj?this.prj.fromPixelToLatLng(A):new AM(A.y,A.x)}});function Bp(){}Bp.prototype=new AP();Am(Bp.prototype,{remove:function(){var A=this.map;delete A.setZoomScales;delete A.getZoomScales;delete A.isStepZoom;delete A.centerAndZoom;delete A.getBoundsZoom;delete A.getZoom;delete A.setZoom;delete A.zoomIn;delete A.zoomOut;delete A.getZoomScale;delete A.checkScale;delete A.savePosition;delete A.returnToSavedPosition;AP.prototype.remove.apply(this,arguments)},zoomIn:function(){var B=this.map,A=B.getScale();if(this.levels){this.setZoomIndex(this.getZoomIndex(A,1)+1)}else{if(B.panScale){B.panScale(A/2)}else{B.setScale(A/2)}}},getZoomScale:function(A,B){if(!this.levels){return A}return this.levels[this.getZoomIndex(A,B)].scale},savePosition:function(){var A=this.map;this.savedPosition={ll:(A.getTargetCenter?A.getTargetCenter():A.getCenter()),scale:(A.getTargetScale?A.getTargetScale():A.getScale())}},onMapInit:function(){if(!this.levels){return }var A=this.map;if(this._isStepZoom&&this.levels){this.setZoomIndex(this.getZoomIndex(A.getScale()))}this.savePosition()},setZoomIndex:function(D,A){if(!this.levels[D]){return }var C=this.map,E=this.zoomIndex,B=this.levels[D].scale;this.zoomIndex=D;if(!A&&C.panScale){C.panScale(B)}else{C.setScale(B)}if(D!=E){AA(this.map,"zoom",[this.levels[D].name])}},onAfterScaleChange:function(A){if(!this.levels){return }var B=this.getZoomIndex(A);if(B!=this.zoomIndex){this.zoomIndex=B;AA(this.map,"zoom",[this.levels[B].name])}},getZoom:function(){var A=this.map.getScale();if(!A){return }return this.levels[this.getZoomIndex(A)].name},zoomOut:function(){var B=this.map,A=B.getScale();if(this.levels){this.setZoomIndex(this.getZoomIndex(A,-1)-1)}else{if(B.panScale){B.panScale(A*2)}else{B.setScale(A*2)}}},getBoundsZoom:function(D,B){B=B?B:10;var C=this.map,F=C.getViewSize(),E=C.fromLatLngToPixel(D.sw),G=C.fromLatLngToPixel(D.ne);var A=Math.max(Math.abs(E.x-G.x)/Math.max(B,F.x-B),Math.abs(E.y-G.y)/Math.max(B,F.y-B));return this.levels[this.getZoomIndex(A,1)].name},returnPosition:function(){var C=this.savedPosition;if(C){var A=C.ll,B=this.map;if(B.panTo){B.panTo(A)}else{B.setCenter(A)}B.setScale(C.scale)}},isStepZoom:function(){return this._isStepZoom},checkScale:function(C){var B=this.map,A=B.getScale();if(!A){return }var D=this.getZoomIndex(A,C);this.setZoomIndex(D)},setZoomScales:function(A){if(this.levels==A){return false}this.levels=A;AA(this.map,Ak[45],[A]);this.checkScale()},setZoom:function(B){var A=this.levels;for(var C=A.length-1;C>=0;C--){if(B==A[C].name){this.setZoomIndex(C);break}}B=parseInt(B);if(!isNaN(B)){this.setZoomIndex(this.getZoomIndex(360/256/Math.pow(2,B)))}},centerAndZoom:function(B,A){this.setZoom(A);this.map.setCenter(B);this.savePosition()},onBeforeScaleChange:function(A){var B=this.map,C=this.levels;if(!C){return }var D=C[0].scale;if(D<A){this.setZoomIndex(0,true);return false}D=C[C.length-1].scale;if(D>A){this.setZoomIndex(C.length-1,true);return false}return true},getZoomScales:function(){return this.levels},getZoomIndex:function(A,D){D=D?D:0;var B=this.levels,F=B.length;for(var C=0;C<F;C++){var E=B[C].scale;if(A==E){return C}if(A>E){if(C>0&&((D==1)||(D==0&&A/B[C-1].scale>E/A))){return C-1}return C}}return F-1},initialize:function(A){if(this.map){return false}Av(A,{setZoomScales:Bw(this,this.setZoomScales),getZoomScales:Bw(this,this.getZoomScales),isStepZoom:Bw(this,this.isStepZoom),centerAndZoom:Bw(this,this.centerAndZoom),getBoundsZoom:Bw(this,this.getBoundsZoom),getZoom:Bw(this,this.getZoom),setZoom:Bw(this,this.setZoom),zoomIn:Bw(this,this.zoomIn),zoomOut:Bw(this,this.zoomOut),getZoomScale:Bw(this,this.getZoomScale),getZoomIndex:Bw(this,this.getZoomIndex),checkScale:Bw(this,this.checkScale),savePosition:Bw(this,this.savePosition),returnToSavedPosition:Bw(this,this.returnPosition)});this.listeners=[Az(A,Ak[44],this,this.onMapInit),Az(A,Ak[43],this,this.onBeforeScaleChange),Az(A,Ak[42],this,this.onAfterScaleChange)];this.map=A;this._isStepZoom=!A.config.steplessZoom;return true}});function A1(){this.slideNum=8;this.intervalTime=32;this.enableMove=true;this.enableScale=true}A1.prototype=new AP();Am(A1.prototype,{panTo:function(A){var E=this.map;if(!E.loaded){E.setCenter(A);return }var G=E.fromLatLngToContainerPixel(A),B=E.getViewSize();var C={x:G.x-B.x/2,y:G.y-B.y/2},F=1;if((Math.abs(C.x)<this.slideNum&&Math.abs(C.y)<this.slideNum)||Math.abs(C.x)>B.x*F||Math.abs(C.y)>B.y*F){E.setCenter(A);return }var D=this.slideObj,H=E.getCenter();if(!D){D=this.startSlide()}if(!D.toPoint){AA(E,Ak[41])}Av(D,{number:0,toPoint:A,fromPoint:H,moveOffset:{x:A.lng()-H.lng(),y:A.lat()-H.lat()},ml:Az(E,Ak[40],this,this.onMapMove)});this.slide()},onMapMove:function(){var A=this.slideObj;if(!A||A.startSetCenter){return }if(A.toPoint){A.toPoint=null;AA(this.map,Ak[39])}Bv(A.ml);if(!A.toScale&&!A.toPoint){this.slideEnd()}},getTargetScale:function(){var A=this.slideObj;if(A){var B=A.toScale;if(B){return B}}return this.map.getScale()},startSlide:function(){return this.slideObj={timeout:window.setInterval(Bw(this,this.slide),this.intervalTime)}},onMapScaleChange:function(){var A=this.slideObj;if(!A||A.startSetScale){return }if(A.toScale){A.toScale=null;AA(this.map,Ak[39])}Bv(A.sl);if(!A.toScale&&!A.toPoint){this.slideEnd()}},panBy:function(D){var B=this.map,A=B.getViewSize();var C=B.fromContainerPixelToLatLng({x:A.x/2+D.x,y:A.y/2+D.y});this.panTo(C)},slideEnd:function(){var A=this.slideObj,B=this.map;if(!A){return }this.slideObj=null;window.clearInterval(A.timeout);Bv(A.ml);Bv(A.sl);if(A.toPoint){AA(B,Ak[38]);B.setCenter(A.toPoint)}if(A.toScale){AA(B,Ak[39]);B.setScale(A.toScale)}},slide:function(){var D=this.slideObj,G;if(!D){return }var F=this.slideNum;if(D.number>=(D.scaleByPoint?F:(F-1))){this.slideEnd();return }D.number++;var B=(Math.sin(Math.PI*(D.number/F-0.5))/2+0.5);var H=this.map,C=H.getViewSize();if(D.toScale){G=D.scaleOffset;var E=D.fromScale;D.startSetScale=true;H.setScale(E*Math.pow(Math.E,G*B));D.startSetScale=false;if(!D.toPoint&&D.scaleByPoint){var A=D.scaleByPoint;var I=H.fromContainerPixelToLatLng({x:C.x-A.x,y:C.y-A.y},D.scaleByll);H.setCenter(I)}}if(D.toPoint){G=D.moveOffset;D.startSetCenter=true;H.setCenter(new AM(D.fromPoint.lat()+G.y*B,D.fromPoint.lng()+G.x*B));D.startSetCenter=false}},initialize:function(A){if(this.map){return false}this.map=A;if(this.enableMove){A.getTargetCenter=Bw(this,this.getTargetCenter);A.panTo=Bw(this,this.panTo);A.panBy=Bw(this,this.panBy)}if(this.enableScale){A.getTargetScale=Bw(this,this.getTargetScale);A.panScale=Bw(this,this.panScale)}return true},remove:function(){if(this.slideObj){this.slideEnd()}var A=this.map;if(this.enableMove){delete A.panTo;delete A.panBy;delete A.getTargetCenter}if(this.enableScale){delete A.panScale;delete A.getTargetScale}AP.prototype.remove.apply(this,arguments)},getTargetCenter:function(){var A=this.slideObj;if(A){var B=A.toPoint;if(B){return B}}return this.map.getCenter()},panScale:function(B,F){var D=this.map;if(!D.loaded){D.setScale(B);return }var E=D.getScale(),A=Math.abs(Math.log(B/E));if(A<0.1||A>3){D.setScale(B);return }var C=this.slideObj;if(!C){C=this.startSlide()}if(!C.toScale){AA(D,Ak[37])}Av(C,{number:0,toScale:B,fromScale:E,scaleByPoint:F,scaleOffset:Math.log(B/E),sl:Az(D,Ak[42],this,this.onMapScaleChange)});if(F){Av(C,{scaleByPoint:F,scaleByll:D.fromContainerPixelToLatLng(F)})}this.slide()}});function A0(){this.enableMove=true;this.enableScale=true}A0.prototype=new AP();Am(A0.prototype,{checkSlide:function(){var B=this.slideObj,A=B.moveSpeed,C=this.map;if((A&&(A.x!=0||A.y!=0))||B.scaleSpeed){if(!B.timeout){B.timeout=window.setInterval(Bw(this,this.slide),32)}if(!B.ml){B.ml=Az(C,Ak[40],this,this.onMapMove);B.md=Az(C,Ak[57],this,this.onMapMove)}}else{if(B.timeout){window.clearInterval(B.timeout);delete B.timeout}if(B.ml){Bv(B.ml);Bv(B.md);delete B.ml;delete B.md}}},onMapMove:function(){var A=this.slideObj;if(!A||A.startSet){return }this.slideMove()},getSlideObj:function(){var A=this.slideObj;if(!A){A=this.slideObj={}}return A},slideScale:function(D,A){var B=this.getSlideObj(),C=this.map;if(!B.scaleSpeed&&D){AA(C,Ak[37])}if(B.scaleSpeed&&!D){AA(C,Ak[39]);if(C.isStepZoom&&C.isStepZoom()){C.checkScale(B.scaleSpeed>0?1:-1)}}B.scaleSpeed=D;B.scaleSpeedup=!!A;B.scaleTimes=0;this.checkSlide()},slideMove:function(D,A){if(D&&D.x==0&&D.y==0){D=null}var B=this.getSlideObj(),C=this.map;if(!B.moveSpeed&&D){AA(C,Ak[41])}if(B.moveSpeed&&!D){AA(C,Ak[38])}B.moveSpeed=D;B.moveSpeedup=!!A;B.moveTimes=0;this.checkSlide()},initialize:function(A){if(this.map){return false}this.map=A;if(this.enableMove){A.slideMove=Bw(this,this.slideMove)}if(this.enableScale){A.slideScale=Bw(this,this.slideScale)}return true},slide:function(){var D=this.slideObj;if(!D){return }var E=this.map,A=D.moveSpeed,B=D.scaleSpeed,C=E.getViewSize();D.startSet=true;if(A){var F=D.moveSpeedup?Math.min(D.moveTimes/128,1):1;D.moveTimes++;E.setCenter(E.fromContainerPixelToLatLng({x:A.x*F*-32,y:A.y*F*-32},null,null,{x:0,y:0}))}if(B){if(D.scaleSpeedup){B=B*Math.min(D.scaleTimes/32,1)}D.scaleTimes++;E.setScale(E.getScale()*Math.pow(2,B))}D.startSet=false},remove:function(){this.onMapMove();var A=this.map;if(this.enableMove){delete A.slideMove}if(this.enableScale){delete A.slideScale}AP.prototype.remove.apply(this,arguments)}});function BV(){var C=this.cursors={},D={normal:"openhand_8_8.cur",mark:"crosshairs.cur",move:"closedhand_8_8.cur"},B=Ak[36];for(var E in D){var A=D[E];if(typeof (A)!=Ak[64]){continue}C[E]=(A.indexOf(".")>=0&&A.indexOf(":")<0)?(B+A):A}}BV.prototype=new AP();Am(BV.prototype,{setCursor:function(B,C){this.cursors[B]=C;var A=this.cursorStack;if(A[A.length-1]==B){this.setCursorStyle(B,C)}},onDragStart:function(){this.applyCursor("move")},applyCursor:function(C){var B=this.cursorStack;if(C){B.push(C)}else{B.pop();C=B[B.length-1]}var A=this.cursors[C];if(!A||!this.map){return }this.setCursorStyle(C,A)},setCursorStyle:function(B,A){switch(B){case"normal":B=Ak[66];break;case"mark":B="crosshair";break}Bd(this.map.getContainer(),A,B)},initialize:function(A){if(this.map){return false}this.listeners=[Az(A,Ak[35],this,this.onDragStart),Az(A,Ak[34],this,this.applyCursor)];Av(A,{applyCursor:Bw(this,this.applyCursor),setCursor:Bw(this,this.setCursor)});this.map=A;this.cursorStack=[];this.applyCursor("normal");return true},remove:function(){var A=this.map;delete A.applyCursor;delete A.setCursor;AP.prototype.remove.apply(this,arguments)}});function Bt(){}Bt.prototype=new AP();Am(Bt.prototype,{hide:function(){BT(this.div)},setText:function(B,C){if(B){if(this.div){this.hide()}var A=this.div=document.createElement("div");C=C?C:{};this.offset=C.offset?C.offset:{x:0,y:0};BF(A,{padding:"2px",fontSize:Ak[33],border:"solid 1px #5A5C2A",backgroundColor:"#FCFFE9"});A.__pointerEvents=Ak[71];if(C.style){BF(A,C.style)}BF(A,{position:Ak[67],zIndex:1000});this.map.container.appendChild(A);if(typeof (B)!=Ak[59]){A.innerHTML=B}else{A.appendChild(B)}if(!this.listeners){this.listeners=[Az(this.map,Ak[56],this,this.show)]}BF(this.div,{display:Ak[71]});if(this.lastPosition&&(this.showDelay||C.show)){this.show(this.lastPosition)}}else{if(this.listeners){Bv(this.listeners[0]);delete this.listeners}this.hide()}},show:function(B){var A=this.offset;this.lastPosition=B;BF(this.div,{display:""});Bg(this.div,{x:B.x+A.x,y:B.y+A.y});this.showDelay=true;if(this.showTimeout){window.clearTimeout(this.showTimeout)}this.showTimeout=window.setTimeout(Bw(this,function(){this.showDelay=false;delete this.showTimeout},10))},initialize:function(A){if(this.map){return false}this.map=A;A.setCursorText=Bw(this,this.setText);return true},remove:function(){this.setText();delete this.showTimeout;delete this.map.setCursorText}});function AR(){}AR.prototype=new AP();Am(AR.prototype,{checkResize:function(){this.map.setViewSize()},initialize:function(A){if(this.map){return false}A.checkResize=A.setViewSize;var C=A.getContainer(),B=C.style;if(!B.width||B.width.indexOf("%")>0||B.height||B.height.indexOf("%")>0){this.listeners=[Az(C,"resize",this,this.checkResize),Az(window,"resize",this,this.checkResize),Az(window,"load",this,this.checkResize)]}this.map=A;return true}});function Bl(){this.maxPixel=100000}Bl.prototype=new AP();Am(Bl.prototype,{getGeoPanel:function(){return this.div},onMapMove:function(D){var B=this.geoCenter,A=this.map;D=A.getCenter();if(!B){B=this.geoCenter=D;if(!B){return }}var C=this.maxPixel,E=A.fromLatLngToContainerPixel(B,null,null,{x:0,y:0});if(Math.abs(E.x)>C||Math.abs(E.y)>C){this.geoCenter=D;AA(A,Ak[32]);E={x:0,y:0}}Bg(this.div,E)},initialize:function(B,C){if(this.map||!B.fromLatLngToContainerPixel){return false}var A=this.div=document.createElement("div");BF(A,{position:Ak[67],zIndex:100,overflow:Ak[69],width:Ak[68]});Bi(A);C.appendChild(A);B.getGeoPanel=Bw(this,this.getGeoPanel);B.getGeoPosition=Bw(this,this.getGeoPosition);this.listeners=[Az(B,Ak[44],this,this.onMapMove),Az(B,Ak[42],this,this.onMapMove),Az(B,Ak[46],this,this.onMapMove),Az(B,Ak[40],this,this.onMapMove)];this.map=B;return true},getGeoPosition:function(A,C){var D=this.map,B=D.getViewSize();return D.fromLatLngToContainerPixel(A,this.geoCenter,C,{x:B.x/2,y:B.y/2})},remove:function(){BT(this.div);delete this.div;var A=this.map;delete A.getGeoPanel;delete A.getGeoPosition;AP.prototype.remove.apply(this,arguments)}});function A4(){this.tileStat={total:0,error:0,show:0};this.layers=[]}A4.prototype=new AP();Am(A4.prototype,{getLayers:function(){return this.layers},onGeoChange:function(){var A=this.layers;for(var B=0;B<A.length;B++){A[B].onMapScale(true)}},addLayer:function(B){var A=this.layers;for(var C=A.length-1;C>=0;C--){if(A[C]==B){return }}A.push(B);B.initialize(this);B.onMapScale()},onInit:function(){this.onScale();this.onMove()},getTileStat:function(){return this.tileStat},setTileStat:function(B,A){this.tileStat[B]+=A;AA(this.map,"tilechange",[B,A])},initialize:function(A){if(this.map||!A.getGeoPanel){return false}this.map=A;Av(A,{addMapLayer:Bw(this,this.addLayer),removeMapLayer:Bw(this,this.removeLayer),getMapLayers:Bw(this,this.getLayers),clearMapLayers:Bw(this,this.clearLayers)});this.listeners=[Az(A,Ak[44],this,this.onInit),Az(A,Ak[42],this,this.onScale),Az(A,Ak[32],this,this.onGeoChange),Az(A,Ak[46],this,this.onGeoChange),Az(A,Ak[47],this,this.onGeoChange),Az(A,Ak[40],this,this.onMove)]},remove:function(){this.clearLayers();var A=this.map;delete A.addMapLayer;delete A.removeMapLayer;delete A.getMapLayers;delete A.removeMapLayer;AP.prototype.remove.apply(this,arguments)},clearLayers:function(){var A=this.layers;while(A[0]){this.removeLayer(A[0])}},onScale:function(){var A=this.layers;for(var B=0;B<A.length;B++){A[B].onMapScale()}},removeLayer:function(B){if(!B){return }var A=this.layers;for(var C=A.length-1;C>=0;C--){if(A[C]==B){B.remove();A.splice(C,1);break}}},onMove:function(){var A=this.layers;for(var B=0;B<A.length;B++){A[B].onMapMove()}}});function BX(A){this.id="";Av(this,A)}function AU(){this.types=[];this.typeIds={};this.layerIds={}}AU.prototype=new AP();Am(AU.prototype,{getLayerById:function(A){if(typeof (A)!=Ak[64]){if(A.control&&A.control.map!=this.map){return A.copy()}return A}return this.layerIds[A]},addType:function(A){if(typeof (A)==Ak[64]){A=this.getTypeById(A)}if(!A||Ab(this.types,A)>=0){return }this.types.push(A);if(A.id&&!this.typeIds[A.id]){this.typeIds[A.id]=A}AA(this.map,Ak[31],[A])},removeType:function(A){if(typeof (A)==Ak[64]){A=this.getTypeById(A)}if(!A){return }A3(this.types,A);AA(this.map,Ak[31],[A])},initialize:function(I){if(this.map||!I.addMapLayer){return false}this.map=I;Av(I,{getMapTypeById:Bw(this,this.getTypeById),getLayerById:Bw(this,this.getLayerById),getMapTypes:Bw(this,this.getTypes),getCurrentMapType:Bw(this,this.getCurrentType),setMapType:Bw(this,this.setType),addMapType:Bw(this,this.addType),removeMapType:Bw(this,this.removeType)});var J=this.typeIds,A=this.layerIds;var G=[{id:"map",tileRender:{config:{imgURLs:["http://img.ditu.aliyun.com/get_png?v=v3&"],useStaticPath:false},cla:Al},tileDef:{config:{minLevel:4,maxLevel:17},cla:BP}}];for(var F=0;F<G.length;F++){var H=G[F],D=new Bk(new H.tileDef.cla(H.tileDef.config),new H.tileRender.cla(H.tileRender.config));if(H.id){A[H.id]=D}}var C=I.config.initTypes;if(!C){C=[{id:"map",main:"map",name:"\u5730\u56fe"}]}for(var F=0;F<C.length;F++){var B=new BX(C[F]);this.addType(B);if(B.id){J[B.id]=B}}var E=0;if(E>=0&&this.types.length>E){this.setType(this.types[E])}if(I.loaded){this.onMapScale()}return true},getCurrentType:function(){return this.currentType},remove:function(){var A=this.map,B=this.types;while(B[0]){this.removeType(B[0])}delete A.getMapTypeById;delete A.getLayerById;delete A.getMapTypes;delete A.getCurrentMapType;delete A.setMapType;delete A.addMapType;delete A.removeMapType;AP.prototype.remove.apply(this,arguments)},setType:function(C){if(typeof (C)==Ak[64]){C=this.getTypeById(C)}if(!C||C==this.currentType){return }var J=this.map,H=this.getLayerById(C.main),D=H.getTileDefinition();var F=[],B=[],E=[],A,I,G;if(A=this.currentType){F.push(A.main);if(A.masks){F=F.concat(A.masks)}}if(C){B.push(C.main);if(C.masks){B=B.concat(C.masks)}}while(I=F.pop()){for(G=B.length-1;G>=0;G--){if(B[G]==I){B.splice(G,1);break}if(G>=0){E.push(I)}}}for(G=E.length-1;G>=0;G--){J.removeMapLayer(this.getLayerById(E[G]))}if(J.setProjection){J.setProjection(D.getProjection())}if(J.setZoomScales){J.setZoomScales(D.getZoomLevels())}this.currentType=C;for(G=B.length-1;G>=0;G--){J.addMapLayer(this.getLayerById(B[G]))}AA(J,Ak[31],[C])},getTypeById:function(A){return this.typeIds[A]},getTypes:function(){return this.types}});function BC(){this.viewOverlays=[]}BC.prototype=new AP();Am(BC.prototype,{removeOverlay:function(A){if(!A){return }if(A._inview){this.removeView(A,Ab(this.viewOverlays,A))}A.remove();AA(A,"remove",[this.map]);this.removeFromList(A)},remove:function(){var A=this.map;this.clearOverlays();delete A.addOverlay;delete A.removeOverlay;delete A.clearOverlays;delete A.onOverlayChange;delete A.getOverlaysBounds;BT(this.overlaysDiv);delete this.overlaysDiv;AP.prototype.remove.apply(this,arguments)},onMapScale:function(){var C=this.checkView("scale");var A=this.viewOverlays;for(var B=A.length-1;B>=0;B--){if(A[B]&&(!C||A[B]._drawTag!=C)){A[B].reDraw(C?3:2)}}},isInView:function(C){var A=this.drawBounds,B=C.getBounds();if(!B){return false}return A&&this.overlapBounds(A,B)},getOverlays:function(){return this.overlays?this.overlays:[]},checkView:function(){var E=this.searchViewOverlays();if(E==null){return 0}var A=this.viewOverlays,C,B;if(!this.viewTag){this.viewTag=0}var D=++this.viewTag;for(B=A.length-1;B>=0;B--){C=A[B];if(Ab(E,C)<0){this.removeView(C,B)}}for(B=E.length-1;B>=0;B--){C=E[B];if(Ab(A,C)<0){this.addView(C,D)}}return D},addToList:function(A){if(!this.overlays){this.overlays=[]}if(Ab(this.overlays,A)>=0){return }this.overlays.push(A);if(this.isInView(A)){this.addView(A)}},init:function(){var A=this.map;var B=this.overlaysDiv=document.createElement("div");Av(B,{position:Ak[60],zIndex:500,overflow:Ak[69],width:Ak[68]});Bi(B);A.getGeoPanel().appendChild(B);this.listeners=[Az(B,Ak[57],this,this.onMouseEvent),Az(B,Ak[30],this,this.onMouseEvent),Az(B,"touchend",this,this.onMouseEvent),Az(B,"touchmove",this,this.onMouseEvent),Az(B,Ak[55],this,this.onMouseEvent),Az(B,Ak[29],this,this.onMouseEvent),Az(B,Ak[56],this,this.onMouseEvent),Az(B,"mouseout",this,this.onMouseEvent),BZ(B,Ak[28],By),Az(B,Ak[27],this,this.onMouseEvent),Az(A,Ak[42],this,this.onMapScale),Az(A,Ak[32],this,this.onMapScale),Az(A,Ak[46],this,this.onMapScale),Az(A,Ak[47],this,this.onMapScale),Az(A,Ak[44],this,this.onMapMove),Az(A,Ak[40],this,this.onMapMove)];this.onMapMove()},searchViewOverlays:function(){var H=this.map,J=H.getBounds(),B=this.drawBounds;var F=H.getScale(),G=this.drawScale;if(!J||(B&&B.containsBounds(J)&&G&&Math.abs(Math.log(G/F)/Math.log(2))<1.5)){return null}var A=this.map.getViewSize();this.drawBounds=H.getBounds({x:-A.x,y:A.y*2},{x:A.x*2,y:-A.y});this.drawScale=F;var I=[],C=this.overlays;if(!C){return I}for(var D=C.length-1;D>=0;D--){var E=C[D];if(this.isInView(E)){I.push(E)}}return I},onMapMove:function(){var C=this.checkView("move");if(C){var A=this.viewOverlays;for(var B=A.length-1;B>=0;B--){A[B].reDraw(1)}}},clearOverlays:function(){var B=this.getOverlays();for(var A=B.length-1;A>=0;A--){if(!B[A]){continue}this.removeOverlay(B[A])}},removeView:function(B,C){if(!B._inview){return }var D=B.getContainer();D.parentNode.removeChild(D);D._overlay=null;try{delete D._overlay}catch(A){}B._inview=false;this.viewOverlays.splice(C,1)},removeFromList:function(A){if(this.overlays){A3(this.overlays,A)}},getDrawBounds:function(){return this.drawBounds},onOverlayChange:function(A){AA(A,"geochange",[]);if(this.isInView(A)){if(!A._inview){this.addView(A)}else{A.reDraw(4)}}else{this.removeView(A,Ab(this.viewOverlays,A))}},getEventOverlay:function(A){var B=A.target;while(B){if(B._overlay){return B._overlay}B=B.parentNode}return null},overlapBounds:function(A,B){return(B.sw.lng()<A.ne.lng()&&B.ne.lng()>A.sw.lng())&&(B.sw.lat()<A.ne.lat()&&B.ne.lat()>A.sw.lat())},addView:function(A,B){if(B&&A._viewTag==B){return }A._viewTag=B;if(A._inview){return }A._inview=true;var C=A.getContainer();C._overlay=A;this.overlaysDiv.appendChild(C);A.reDraw(4);this.viewOverlays.push(A)},onMouseEvent:function(B){var E=this.getEventOverlay(B);if(!E){return false}var C=this.map,G=Au(B,C.getContainer()),A=C.fromContainerPixelToLatLng(G);var F=B.type;if(F==Ak[30]){F=Ak[57]}else{if(F=="touchmove"){F=Ak[56]}else{if(F=="touchend"){F=Ak[55]}}}if(E.onMouseEvent){E.onMouseEvent(F,A,B)}AA(E,F,[A,B]);switch(F){case Ak[27]:BS(B);AA(C,F,[G,Bu(B),E]);break;case Ak[57]:this.mdTime=new Date().valueOf();this.mdPoint=G;break;case Ak[55]:var D=this.mdPoint;if(D&&(new Date()).getTime()-this.mdTime<=500&&(Math.abs(G.x-D.x)<=2&&Math.abs(G.y-D.y)<=2)){if(E.onMouseEvent){E.onMouseEvent(Ak[28],A,B)}AA(E,Ak[28],[A,B]);AA(C,Ak[28],[G,Bu(B),E])}delete this.mdTime;delete this.mdPoint;break}},addOverlay:function(B){if(!B){return }if(!this.overlaysDiv){this.init()}var A=this.map;if(B.initialize(A)==false){return false}AA(B,"add",[A]);this.addToList(B)},initialize:function(A){if(this.map){return false}this.map=A;Av(A,{addOverlay:Bw(this,this.addOverlay),removeOverlay:Bw(this,this.removeOverlay),clearOverlays:Bw(this,this.clearOverlays),onOverlayChange:Bw(this,this.onOverlayChange),getOverlaysBounds:Bw(this,this.getDrawBounds)});return true}});function Br(){}Br.prototype=new AP();Am(Br.prototype,{close:function(){this.get().close()},open:function(A,B,D,E){var C=this.get();if(A){C.setLatLng(A);delete C.bindOverlay}C.setTitle(B);C.setContent(D);C.setOffset((E&&E.offset)?E.offset:{x:0,y:0});this.map.addOverlay(C);return C},get:function(){var A=this.map;if(!A._infoWin){A._infoWin=new Ay()}return A._infoWin},initialize:function(A){if(this.map||!A.addOverlay){return false}Av(A,{openInfoWindow:Bw(this,this.open),closeInfoWindow:Bw(this,this.close),getInfoWindow:Bw(this,this.get)});Av(BK.prototype,{openInfoWindow:AE,closeInfoWindow:AF});this.map=A;return true},remove:function(){this.close();var A=this.map;delete A.openInfoWindow;delete A.closeInfoWindow;delete A.getInfoWindow;AP.prototype.remove.apply(this,arguments)}});function AE(A,E,F){var C=this.map;if(!C){return }var G=C.getInfoWindow(),D=this.infoWindowAnchor;F=F?F:{};if(!D){D={x:this.getSize().x*0.5,y:0}}F.offset={x:D.x-this.anchor.x+this.offset.x,y:D.y-this.anchor.y+this.offset.y};var B=C.openInfoWindow(this.getLatLng(),A,E,F);B.bindOverlay=this;return B}function AF(){if(!this.map){return }var A=this.map.getInfoWindow();if(A.bindOverlay==this){A.close()}}Am(Br,{open:AE,close:AF});function Ag(){this.action=Ak[26];this.enabled=true}Ag.prototype=new AP();Am(Ag.prototype,{setAction:function(A){this.action=A;this.check()},onDblClick:function(G,E,F){if(F){return }var C=this.map,A=C.fromContainerPixelToLatLng(G),B=C.getScale();if(this.action==Ak[26]||this.action==Ak[25]){if(C.panTo){C.panTo(A)}else{C.setCenter(A)}}if(this.action==Ak[26]||this.action=="zoom"){if(C.zoomIn){C.zoomIn()}else{var D=B/2;if(C.panScale){C.panScale(D)}else{C.setScale(D)}}}},setEnable:function(A){this.enabled=!!A;this.check()},check:function(){if(!this.enabled||this.action==Ak[71]){if(this.listeners){Bv(this.listeners[0]);delete this.listeners}}else{if(!this.listeners){this.listeners=[Az(this.map,Ak[27],this,this.onDblClick)]}}},initialize:function(A){if(this.map){return false}this.map=A;A.setDblClickAction=Bw(this,this.setAction);A.setDblClickEnable=Bw(this,this.setEnable);this.check();return true},remove:function(){var A=this.map;delete A.setDblClickAction;delete A.setDblClickEnable;AP.prototype.remove.apply(this,arguments)}});function AS(){this.sad=false}AS.prototype=new AP();Am(AS.prototype,{onMouseDown:function(E){var C=this.dragObj;if(C){this.onMouseUp(E)}var B=this.map,A=B.viewSize,D=B.getGeoPanel().style;C=this.dragObj={startPoint:E,startLL:B.getCenter(),mml:Az(B,Ak[55],this,this.onMouseUp),mdl:Az(B,Ak[56],this,this.onMouseMove),timeout:window.setInterval(Bw(this,this.onTime),256),lastTime:new Date().valueOf(),geoStart:{x:parseInt(D.left),y:parseInt(D.top)},lastPoint:E};AA(B,Ak[35]);AA(B,Ak[41])},isDragging:function(){return !!this.dragObj},onMouseUp:function(){var B=this.map;var C=this.dragObj;if(!C){return }var E=!C.lastDelayTime||new Date().valueOf()-C.lastDelayTime>32;var D=C.speed;if(!D||(Math.abs(D.x)<0.1&&Math.abs(D.y)<0.1)){E=false}this.onTime();this.dragObj=null;Bv(C.mml);Bv(C.mdl);AA(B,Ak[34]);AA(B,Ak[38]);if(E&&B.slideMove){D.x=Math.min(Math.max(D.x,-2),2);D.y=Math.min(Math.max(D.y,-2),2);var A=B.getViewSize();B.slideMove(D)}},draggingEnabled:function(){return !!this.listeners},initialize:function(A){if(this.map||!A.getGeoPanel){return false}this.map=A;Av(A,{enableDragging:Bw(this,this.enableDragging),disableDragging:Bw(this,this.disableDragging),draggingEnabled:Bw(this,this.draggingEnabled),isDragging:Bw(this,this.isDragging)});this.enableDragging();return true},remove:function(){if(this.dragObj){this.onMouseUp()}var A=this.map;delete A.enableDragging;delete A.disableDragging;delete A.draggingEnabled;delete A.isDragging;AP.prototype.remove.apply(this,arguments)},enableDragging:function(){if(!this.listeners){this.listeners=[Az(this.map,Ak[57],this,this.onMouseDown)]}},disableDragging:function(){if(this.listeners){Bv(this.listeners[0]);delete this.listeners}},onMouseMove:function(H){var F=this.dragObj;if(!F){return }var A=F.geoStart,G=F.startPoint;var C={x:F.startPoint.x-H.x,y:F.startPoint.y-H.y};var B=this.map.fromContainerPixelToLatLng(C,F.startLL,null,{x:0,y:0});AA(this.map,"drag",[B]);Bg(this.map.getGeoPanel(),{x:A.x-G.x+H.x,y:A.y-G.y+H.y});if(this.sad){var D=new Date().valueOf(),E=F.lastTime;if(D-E>64){F.lastDelayTime=D}if(D>E){F.speed={x:(H.x-F.lastPoint.x)/(D-E)/8,y:(H.y-F.lastPoint.y)/(D-E)/8}}F.lastTime=D}Av(F,{lastPoint:H,moveed:true})},onTime:function(){var E=this.dragObj;if(!E||!E.moveed){return }var B=this.map,F=E.lastPoint,C=B.fromContainerPixelToLatLng(F,null,null,{x:0,y:0});var D={x:E.startPoint.x-F.x,y:E.startPoint.y-F.y};var A=B.fromContainerPixelToLatLng(D,E.startLL,null,{x:0,y:0});B.setCenter(A)}});function BJ(){}BJ.prototype=new AP();Am(BJ.prototype,{onMouseMove:function(A){this.mPoint=Au(A,this.map.getContainer());if(!this.mmt){this.mmt=window.setInterval(Bw(this,this.onTime),16)}},onMouseDown:function(A){this.onMouseEvent(Ak[57],A);var C=this.dragObj;if(C){this.onMouseUp(A)}var B=this.map,D=B.getContainer();if(!B.loaded){return }var E=Au(A,D);C=this.dragObj={startPoint:{x:A.clientX,y:A.clientY},startTime:new Date().valueOf(),mml:Az(document,Ak[56],this,this.onMouseMove),mul:Az(document,Ak[55],this,this.onMouseUp)};if(D.setCapture){D.setCapture();if(A.target&&A.target._needUp){C.downEvent=A}}},onTime:function(){var B=this.mPoint,A=this.lPoint;if(!B||(A&&A.x==B.x&&A.y==B.y)){return }this.lPoint=B;AA(this.map,Ak[56],[this.lPoint=B])},onMouseEvent:function(C,A){BS(A);var B=this.map;if(!B.loaded){return }var D=Au(A,B.getContainer());AA(B,C,[D,Bu(A)])},onDblclick:function(A){this.onMouseEvent(Ak[27],A)},onMouseUp:function(A){var B=this.dragObj;if(!B){return }this.onMouseEvent(Ak[55],A);this.onTime();this.dragObj=null;Bv(B.mml);Bv(B.mul);if(document.releaseCapture){document.releaseCapture()}if((new Date()).getTime()-B.startTime<=500&&(Math.abs(B.startPoint.x-A.clientX)<=2&&Math.abs(B.startPoint.y-A.clientY)<=2)){this.onMouseEvent(Ak[28],A);if(B.downEvent){AA(B.downEvent.target,Ak[55],[A])}}},initialize:function(A){if(this.map){return false}var B=A.getContainer();this.listeners=[Az(B,Ak[27],this,this.onDblclick),Az(B,Ak[56],this,this.onMouseMove),Az(B,Ak[57],this,this.onMouseDown),BZ(B,"contextmenu",BS)];this.map=A;return true},remove:function(){if(this.dragObj){this.onMouseUp()}AP.prototype.remove.apply(this,arguments)}});function AT(){this.moveSpeed=4;this.scaleSpeed=0.32}AT.prototype=new AP();Am(AT.prototype,{isMapKey:function(A){if(A.ctrlKey||A.altKey||A.metaKey){return false}if((A.target.nodeName=="INPUT"&&A.target.type=="text")||A.target.nodeName=="TEXTAREA"){return false}return true},getSlideObj:function(){var A=this.slideObj;if(!A){A=this.slideObj={offset:{x:0,y:0},scale:0}}return A},onKeyDown:function(C){if(!this.isMapKey(C)){return }var A=this.getSlideObj(),D=this.map,B=A.offset,E=C.keyCode;switch(E){case 37:B.x=1;break;case 38:B.y=1;break;case 39:B.x=-1;break;case 40:B.y=-1;break;case 187:case 107:case 61:A.scale=-1;break;case 189:case 109:A.scale=1;break;default:return }if(E==this.lastCode){return }this.lastCode=E;this.downTime=new Date().valueOf();if(D.slideMove){D.slideMove({x:B.x*this.moveSpeed,y:B.y*this.moveSpeed},true)}if(D.slideScale){D.slideScale(A.scale*this.scaleSpeed,true)}},onKeyUp:function(E){if(!this.isMapKey(E)){return }var B=this.getSlideObj(),F=this.map,C=B.offset,A=F.getViewSize();switch(E.keyCode){case 33:case 87:case 104:this.move({x:0,y:-A.y/2});break;case 34:case 83:case 98:this.move({x:0,y:A.y/2});break;case 35:case 68:case 102:this.move({x:A.x/2,y:0});break;case 36:case 65:case 100:this.move({x:-A.x/2,y:0});break;case 37:case 39:if(C){C.x=0}break;case 38:case 40:if(C){C.y=0}break;case 187:case 107:case 61:case 189:case 109:if(!F.slideScale||(new Date().valueOf()-this.downTime<256&&(!F.getTargetScale||F.getScale()==F.getTargetScale()))){var D;if(B.scale<0){if(F.zoomIn){F.zoomIn()}else{D=F.getScale()/2}}else{if(F.zoomOut){F.zoomOut()}else{D=F.getScale()*2}}if(D){if(F.panScale){F.panScale(D)}else{F.setScale(D)}}}B.scale=0;break;default:return }this.lastCode=null;if(F.slideMove){F.slideMove({x:C.x*this.moveSpeed,y:C.y*this.moveSpeed},true)}if(F.slideScale){F.slideScale(B.scale*this.scaleSpeed,true)}},move:function(D){var B=this.map,A=B.getViewSize();var C=B.fromContainerPixelToLatLng({x:A.x/2+D.x,y:A.y/2+D.y});if(B.panTo){B.panTo(C)}else{B.setCenter(C)}},initialize:function(A){if(this.map){return false}this.listeners=[Az(document,"keydown",this,this.onKeyDown),Az(document,"keyup",this,this.onKeyUp)];this.map=A;return true}});function Bo(){this.byPoint=true}Bo.prototype=new AP();Am(Bo.prototype,{endScale:function(){var C=this.map,D=this.wheelObj;delete this.wheelObj;if(!D){return }if(D.timeout){window.clearInterval(D.timeout)}AA(this.map,Ak[39]);if(this.byPoint){AA(this.map,Ak[38])}if(C.isStepZoom&&C.isStepZoom()){var B=C.getZoomScale(C.getScale(),D.dir);if(C.panScale){C.panScale(B,D.toPoint)}else{C.setScale(B);if(D.toll){var A=C.getViewSize(),E=D.toPoint;var F=C.fromContainerPixelToLatLng({x:A.x-E.x,y:A.y-E.y},D.toll,B);C.setCenter(F)}}}},onMouseWheel:function(A){BS(A);var D=this.wheelObj;if(!D){D=this.wheelObj={distance:0}}if(this.byPoint){var B=this.map,E=Au(A,B.getContainer());Av(D,{toPoint:E,toll:B.fromContainerPixelToLatLng(E),dir:0})}if(!D.timeout){AA(this.map,Ak[37]);if(this.byPoint){AA(this.map,Ak[41])}D.timeout=window.setInterval(Bw(this,this.setScale),32)}var C=(typeof (A.wheelDelta)=="number")?A.wheelDelta:(-A.detail*40);D.distance+=C;D.dir=C>0?-1:1;D.scrolled=true},initialize:function(A){if(this.map){return false}this.listeners=[Az(A.getContainer(),"mousewheel",this,this.onMouseWheel)];if(!document.all){this.listeners.push(Az(A.getContainer(),"DOMMouseScroll",this,this.onMouseWheel))}this.map=A;return true},setScale:function(){var C=this.map,D=C.getScale(),E=this.wheelObj;if(!E){return }if(!E.scrolled){E.pauseTimes++;if(E.pauseTimes==4){this.endScale()}return }var B=Math.pow(2,E.distance/-1024);C.setScale(D*B);if(E.toll){var A=C.getViewSize(),F=E.toPoint;var G=C.fromContainerPixelToLatLng({x:A.x-F.x,y:A.y-F.y},E.toll);C.setCenter(G)}E.distance=0;E.scrolled=false;E.pauseTimes=0},remove:function(){if(this.wheelObj){this.endScale()}AP.prototype.remove.apply(this,arguments)}});function BY(A,D,F,B,E){if(typeof (A)!=Ak[59]){var C=A;A=document.createElement("div");A.innerHTML=C}this.div=A;B=B?B:800;if(E){BF(A,E)}BF(A,{zIndex:B,position:Ak[67]});this.setLayout(D);this.setPosition(F)}BY.prototype=new AP();Am(BY.prototype,{remove:function(){this.map.getContainer().removeChild(this.div);delete this.div;AP.prototype.remove.apply(this,arguments)},initialize:function(A){if(this.map){return false}this.map=A;A.getContainer().appendChild(this.div);this.setLayout(this.layout);return true}});function AC(B,C,E,D){var A=this.div=document.createElement("div");if(D){BF(A,D)}BF(A,{zIndex:900,position:Ak[67]});this.logo=B;this.setLayout(C);this.setPosition(E)}AC.prototype=new AP();Am(AC.prototype,{remove:function(){this.map.getContainer().removeChild(this.div);delete this.div;AP.prototype.remove.apply(this,arguments)},initialize:function(A){if(this.map){return false}this.map=A;A.getContainer().appendChild(this.div);this.setLayout(this.layout);this.onResize();this.listeners=[Az(A,Ak[47],this,this.onResize)];return true},onResize:function(){var C,B=this.map.getViewSize().x,A=this.logo;for(C=A.length-1;C>=0;C--){if(B>=A[C].minWidth){break}}this.div.innerHTML=C>=0?A[C].html:""}});function AJ(){}AJ.prototype=new AP();Am(AJ.prototype,{onClick:function(A){var B=A.target,D=A.target.index;while(B&&B!=this.div&&!D){B=B.parentNode;D=B.index}if(!D){return }var C=this.map.getMapTypes()[D-1];if(!C){return }BS(A);this.map.setMapType(C)},showLabels:function(){var E=this.div,A=Ak[36]+"mtc/";BT(E,true);var G=this.map.getMapTypes(),F=this.map.getCurrentMapType();BF(E,{left:"0px"});for(var H=0;H<G.length;H++){var B=document.createElement("div");B.index=H+1;var D=(F==G[H])?"current":"normal",K=D=="current"?Ak[24]:Ak[23];BF(B,{position:Ak[60],styleFloat:Ak[22],cssFloat:Ak[22],height:Ak[21],margin:"2px",cursor:Ak[58],color:K});var I=Ba(A+D+"_l.png");BF(I,{position:Ak[60],styleFloat:Ak[22],cssFloat:Ak[22],width:"2px",height:Ak[21]});B.appendChild(I);var J=document.createElement("div");var C=document.createElement("div");BF(C,{margin:"2px",marginLeft:"6px",marginTop:"3px",marginRight:"6px",fontSize:"11px",textAlign:Ak[25]});C.appendChild(document.createTextNode(G[H].name));BF(J,{position:Ak[60],styleFloat:Ak[22],cssFloat:Ak[22],height:Ak[21]});J.appendChild(C);if(Be()){var I=Ba(A+D+".png");BF(I,{position:Ak[67],width:Ak[68],height:Ak[68],top:"0px",zIndex:-1});J.appendChild(I)}else{BA(J,A+D+".png")}B.appendChild(J);var I=Ba(A+D+"_r.png");BF(I,{position:Ak[60],styleFloat:Ak[22],cssFloat:Ak[22],width:"2px",height:Ak[21]});B.appendChild(I);E.appendChild(B);BF(J,{width:I.offsetLeft-2+"px",height:Ak[21]})}this.position={x:-E.offsetWidth-10,y:10};this.onMapResize()},initialize:function(A){if(this.map||!A.getMapTypes){return false}this.map=A;var B=this.div=document.createElement("div");this.setLayout({x:1,y:0});B.noWrap=true;BF(B,{position:Ak[67],zIndex:500,height:Ak[21]});A.getContainer().appendChild(B);this.listeners=[Az(A,Ak[31],this,this.showLabels),Az(B,Ak[28],this,this.onClick),BZ(B,Ak[57],BS)];this.showLabels();return true},remove:function(){BT(this.div);delete this.div;AP.prototype.remove.apply(this,arguments)}});function Ap(){this.levels=[{name:"\u516c\u91cc",unit:1000},{name:"\u7c73",unit:1}];this.setColor(Ak[23],Ak[24])}Ap.prototype=new AP();Am(Ap.prototype,{reDraw:function(){delete this.timeout;var H=this.map,I=H.getCenter();if(!I){return }var J=H.getBounds(),D=H.getViewSize();var G=AX([new AM(I.la,J.sw.lo),new AM(I.la,J.ne.lo)])/D.x;if(this.lastDis&&Math.abs(Math.log(this.lastDis/G))<1/16){return }this.lastDis=G;var C=Math.pow(10,Math.ceil(Math.log(G*50)/Math.log(10))),E=C/G;if(E>=250){E/=5;C/=5}if(E>=200){E/=4;C/=4}if(E>=100){E/=2;C/=2}var B=C,A=this.levels;for(var F=0;F<A.length;F++){if(C>=A[F].unit){B=C/A[F].unit+" "+A[F].name;break}}this.span.innerHTML=B;E=Math.round(E);BF(this.span,{width:E+"px"});BF(this.scaleBar,{width:E+"px"});BF(this.scaleRight,{left:E+1+"px"});BF(this.div,{width:E+"px"})},onMapMove:function(){if(this.timeout){return }this.timeout=window.setTimeout(Bw(this,this.reDraw),1024)},setColor:function(B,A){this.color=B;this.borderColor=A;if(this.scaleBar){BF(this.scaleBar,{backgroundColor:B,borderTop:Ak[20]+A,borderBottom:Ak[20]+A});BF(this.scaleLeft,{backgroundColor:B,border:Ak[20]+A});BF(this.scaleRight,{backgroundColor:B,border:Ak[20]+A})}},initialize:function(B){if(this.map){return false}this.map=B;var A=this.div=document.createElement("div");BF(A,{position:Ak[67],zIndex:500,height:Ak[21]});var D=this.span=document.createElement("div");BF(D,{textShadow:"0px 0px 2px #FFFFFF",left:"5px",fontSize:Ak[33],filter:"glow(color=#FFFFFF,strength=2)",textAlign:Ak[22],height:"14px"});BF(D,{position:Ak[67],zIndex:200});A.appendChild(D);var E=this.scaleLeft=document.createElement("div");BF(E,{position:Ak[67],left:"0px",top:Ak[33],width:"3px",height:"9px",fontSize:"0px",overflow:Ak[70]});A.appendChild(E);var C=this.scaleRight=document.createElement("div");BF(C,{position:Ak[67],top:Ak[33],width:"3px",height:"9px",fontSize:"0px",overflow:Ak[70]});A.appendChild(C);var F=this.scaleBar=document.createElement("div");BF(F,{position:Ak[67],left:"2px",top:"15px",height:(document.all&&(!document.compatMode||document.compatMode=="BackCompat")?4:2)+"px",fontSize:"0px",overflow:Ak[70],zIndex:100});A.appendChild(F);this.setLayout({x:0,y:1});this.setPosition({x:10,y:-45});B.getContainer().appendChild(A);this.setColor(this.color,this.borderColor);if(E.offsetWidth>3){BF(E,{width:"1px",height:"7px"});BF(C,{width:"1px",height:"7px"});BF(F,{top:"14px"})}this.listeners=[Az(B,Ak[44],this,this.onMapMove),Az(B,Ak[40],this,this.onMapMove),Az(B,Ak[42],this,this.onMapMove),Az(B,Ak[46],this,this.onMapMove)];this.reDraw();return true},remove:function(){BT(this.div);delete this.lastDis;delete this.div;delete this.span;delete this.scaleLeft;delete this.scaleRight;delete this.scaleBar;AP.prototype.remove.apply(this,arguments)}});function AZ(B,H,F){if(F){Av(this,F)}Av(this,{map:B,container:H,zoomAdd:typeof (this.zoomAdd)=="number"?parseInt(this.zoomAdd):4});var D=this.miniMap=new BU(H,{initControls:[BM,Bp,A1,BV,Bl,A4,AU,BC,AS,BJ],initMapTypes:[],clip:this.clip});if(this.center&&D.disableDragging){D.disableDragging()}var G={position:Ak[67],fontSize:"0px",zIndex:"1000"};var E=this.rectControl=document.createElement("div");BF(E,{cursor:"move",MozOpacity:0.4,filter:Ak[19],border:Ak[18],opacity:0.4,backgroundColor:Ak[24]});BF(E,G);var C=document.createElement("div");BF(C,{backgroundColor:"#FF6600"});BF(C,{width:"50%",height:"1px",left:"25%",top:"50%",overflow:Ak[70]});BF(C,G);E.appendChild(C);C=document.createElement("div");BF(C,{backgroundColor:"#FF6600"});BF(C,{height:"50%",width:"1px",left:"50%",top:"25%",overflow:Ak[70]});BF(C,G);E.appendChild(C);D.getContainer().appendChild(E);if(this.mapType){D.setMapType(this.mapType)}var A=this.rectOverlay=new BW(null,"","",1,1);BF(A.div,{MozOpacity:0.4,filter:Ak[19],border:Ak[18],opacity:0.4,backgroundColor:Ak[24]});this.enable()}Am(AZ.prototype,{onRectMouseDown:function(A){BS(A);if(this.dragObject){this.onRectMouseUp(A)}var B=this.rectControl.style;this.dragObject={startPosition:{x:parseInt(B.left),y:parseInt(B.top)},startSize:{x:parseInt(B.width),y:parseInt(B.height)},preMove:{x:0,y:0},startPoint:{x:A.clientX,y:A.clientY},timeout:window.setInterval(Bw(this,this.onTime),16),moveListener:Az(document,Ak[56],this,this.onRectMouseMove),upListener:Az(document,Ak[55],this,this.onRectMouseUp)}},onMapMoveStart:function(){this.fixedNum++},onTypeChange:function(){var A=this.map.getCurrentMapType();if(A){this.miniMap.setMapType(A)}},onMapMove:function(){if(this.fixedNum<=0&&!this.miniMap.isDragging()){this.returnView();return }this.rectOverlay.setBounds(this.map.getBounds())},onMapMoveEnd:function(){this.fixedNum--;if(this.fixedNum<=0){this.returnView()}},returnView:function(){var I=this.map,F=this.miniMap;if(!I.loaded){return }this.fixedNum=0;var D=this.center?this.center:I.getCenter(),G=this.scale?this.scale:(this.zoom?(360/256/Math.pow(2,this.zoom)):I.getScale()*Math.pow(2,this.zoomAdd));if(F.panTo){F.panTo(D)}else{F.setCenter(D)}if(F.panScale){F.panScale(G)}else{F.setScale(G)}var J=F.getTargetCenter?F.getTargetCenter():null;G=F.getTargetScale?F.getTargetScale():null;var K=I.getBounds(),A=F.fromLatLngToContainerPixel(K.sw,J,G),B=F.fromLatLngToContainerPixel(K.ne,J,G);var C={x:Math.abs(B.x-A.x),y:Math.abs(B.y-A.y)},E=F.getViewSize();C.x=Math.min(Math.ceil(E.x/2),Math.max(10,C.x));C.y=Math.min(Math.ceil(E.y/2),Math.max(10,C.y));var H=F.fromLatLngToContainerPixel(I.getCenter(),J,G);Bg(this.rectControl,{x:parseInt(H.x-C.x/2),y:parseInt(H.y-C.y/2)});Bq(this.rectControl,C);this.rectOverlay.setBounds(K)},onRectMouseUp:function(A){BS(A);var D=this.dragObject;delete this.dragObject;Bv(D.moveListener);Bv(D.upListener);window.clearInterval(D.timeout);this.onTime();var F=D.startPosition,E=D.startPoint,H={x:F.x-E.x+A.clientX,y:F.y-E.y+A.clientY},G=D.startSize,B=this.map;var C=this.miniMap.fromContainerPixelToLatLng({x:H.x+G.x/2,y:H.y+G.y/2});if(B.panTo){B.panTo(C)}else{B.setCenter(C)}},enable:function(){if(this.listeners){return }var A=this.map,B=this.miniMap;this.listeners=[Az(A,Ak[44],this,this.returnView),Az(A,Ak[41],this,this.onMapMoveStart),Az(A,Ak[38],this,this.onMapMoveEnd),Az(A,Ak[40],this,this.onMapMove),Az(A,Ak[37],this,this.onMapMoveStart),Az(A,Ak[39],this,this.onMapMoveEnd),Az(A,Ak[42],this,this.onMapMove),Az(A,Ak[47],this,this.onMapMove),Az(this.rectControl,Ak[57],this,this.onRectMouseDown),Az(B,"drag",this,this.onMapMove),Az(B,Ak[34],this,this.onDragEnd),Az(B,Ak[27],this,this.onDblClick)];this.fixedNum=0;if(!this.mapType){this.listeners.push(Az(A,Ak[31],this,this.onTypeChange));this.onTypeChange()}this.returnView();B.addOverlay(this.rectOverlay)},disable:function(){var A,B=this.listeners;if(!B){return }while(A=B.pop()){Bv(A)}this.listeners=null},depose:function(){this.disable();this.miniMap.depose();BT(this.container,true);delete this.miniMap;delete this.map;delete this.container;delete this.rectControl;delete this.rectOverlay},onRectMouseMove:function(A){var B=this.dragObject;if(!B){return }B.lastPoint={x:A.clientX,y:A.clientY};B.moveed=true},onDragEnd:function(D){var C=this.rectControl.style,A=this.map;var B=this.miniMap.fromContainerPixelToLatLng({x:parseInt(C.left)+parseInt(C.width)/2,y:parseInt(C.top)+parseInt(C.height)/2});if(A.panTo){A.panTo(B)}else{A.setCenter(B)}},getMiniMap:function(){return this.miniMap},onTime:function(){var B=this.dragObject,C=this.miniMap;if(!B||!B.moveed){return }Bg(this.rectControl,this.getDragPoint(B.lastPoint));var A=C.getViewSize(),D=B.moveSize;if(D.x!=0||D.y!=0){C.setCenter(C.fromContainerPixelToLatLng({x:A.x/2+D.x,y:A.y/2+D.y}))}B.preMove.x+=D.x;B.preMove.y+=D.y},getDragPoint:function(C){var F=this.dragObject,E=F.startPosition,I=F.startPoint,D=this.miniMap.getViewSize();var A={x:E.x-I.x+C.x,y:E.y-I.y+C.y},G={x:0,y:0};var B=F.startSize,H=2;if(!this.center){if(A.x<0){A.x=0;G.x=-H}if(A.y<0){A.y=0;G.y=-H}if(A.x>D.x-B.x){A.x=D.x-B.x;G.x=H}if(A.y>D.y-B.y){A.y=D.y-B.y;G.y=H}}F.moveSize=G;return A},onDblClick:function(C){var A=this.miniMap.fromContainerPixelToLatLng(C),B=this.map;if(B.panTo){B.panTo(A)}else{B.setCenter(A)}}});function BH(L){L=L?L:{};Av(this,{config:L,layout:L.layout?L.layout:{x:1,y:1},pad:K=K?K:5,size:L.size?L.size:{x:160,y:110},show:!!L.open,pad:L.pad?L.pad:5});var M=this.div=document.createElement("div"),D=this.divs={},E=Ak[36]+"oc/";BF(M,{position:Ak[67],overflow:Ak[70],zIndex:10000,cursor:Ak[66]});var C=this.resizeDiv=document.createElement("div");BF(C,{position:Ak[67],overflow:Ak[70]});M.appendChild(C);var B=this.mapDiv=document.createElement("div");BF(B,{zIndex:0,cursor:Ak[58]});var A=this.size,K=this.pad,G=this.divSize={x:A.x+K*2-1,y:A.y+K*2-1};Bq(B,A);Bg(B,{x:K,y:K});C.appendChild(B);Bq(M,G);Bq(C,G);var I=K*1.4;var J=D.ul=Ba(E+Ak[17]);BF(J,{position:Ak[67],left:"0px",top:"0px",width:I+"px",height:I+"px"});C.appendChild(J);J=D.ur=Ba(E+Ak[16]);BF(J,{position:Ak[67],left:A.x+K*2-I-1+"px",top:"0px",width:I+"px",height:I+"px"});C.appendChild(J);J=D.bl=Ba(E+Ak[15]);BF(J,{position:Ak[67],left:"0px",top:A.y+K*2-I-1+"px",width:I+"px",height:I+"px"});C.appendChild(J);J=D.br=Ba(E+Ak[14]);BF(J,{position:Ak[67],left:A.x+K*2-I-1+"px",top:A.y+K*2-I-1+"px",width:I+"px",height:I+"px"});C.appendChild(J);var F=D.top=Ba(E+"up.png");BF(F,{position:Ak[67],left:I+"px",top:"0px",width:A.x-(I-K)*2-1+"px",height:I+"px",zIndex:50});C.appendChild(F);F=D.left=Ba(E+"left.png");BF(F,{position:Ak[67],left:"0px",top:I+"px",width:I+"px",height:A.y-(I-K)*2-1+"px"});C.appendChild(F);F=D.bottom=Ba(E+"down.png");BF(F,{position:Ak[67],left:I+"px",top:A.y+K*2-I-1+"px",width:A.x-(I-K)*2-1+"px",height:I+"px"});C.appendChild(F);F=D.right=Ba(E+"right.png");BF(F,{position:Ak[67],fontSize:"0px",left:A.x+K*2-I-1+"px",top:I+"px",width:I+"px",height:A.y-(I-K)*2-1+"px"});C.appendChild(F);this.btnImg={open:E+"open.png",close:E+"close.png"};var H=this.button=Ba(this.btnImg.open);BF(H,{position:Ak[67],cursor:Ak[58],zIndex:10000,width:"15px",height:"15px"});this.listeners=[Az(this.button,Ak[28],this,this.changeView),BZ(this.button,Ak[27],BS),BZ(this.button,Ak[57],BS)];M.appendChild(H);this.setLayout(this.layout);this.setButtonImage(this.btnImg)}BH.prototype=new AP();Am(BH.prototype,{changeView:function(A){BS(A);if(this.show){var B={x:0,y:0};if(Math.abs(this.direction)==3){B.y=this.size.y}if(Math.abs(this.direction)==1){B.x=this.size.x}if(this.mini){this.mini.disable();this.resizeTo(B)}else{Bq(this.resizeDiv,B)}BR(this.button,this.btnImg.open);this.show=false}else{var B=this.divSize;if(this.mini){this.mini.enable();this.resizeTo(B)}else{Bq(this.resizeDiv,B)}BR(this.button,this.btnImg.close);this.show=true}AA(this,"viewchange",[this.show])},setButtonImage:function(A){if(!A){return }this.btnImg=A;this.button.removeAttribute("src");BR(this.button,this.show?A.open:A.close)},resizeTo:function(B){if(this.slideObj){this.resizeEnd()}var A=this.resizeDiv.style;this.slideObj={startSize:{x:parseInt(A.width),y:parseInt(A.height)},endSize:B,number:0,timeout:window.setInterval(Bw(this,this.resize),16)}},initialize:function(A){if(this.mini){return false}this.mini=new AZ(A,this.mapDiv,this.config);if(this.show){this.mini.enable();Bq(this.resizeDiv,this.divSize);BR(this.button,this.btnImg.close)}else{this.mini.disable();Bq(this.resizeDiv,{x:0,y:0});BR(this.button,this.btnImg.open)}A.getContainer().appendChild(this.div)},remove:function(){var B=this.mini,A=this.div;if(B){B.depose();delete this.mini}if(A&&A.parentNode){A.parentNode.removeChild(A)}AP.prototype.remove.apply(this,arguments)},depose:function(){this.remove();BT(this.div);delete this.div;delete this.resizeDiv;delete this.mapDiv;delete this.button},setLayout:function(A){AG(this.div,A,false,0);AG(this.resizeDiv,A,true);AG(this.button,A,false,this.pad+"px")},getMiniMap:function(){return this.mini?this.mini.miniMap:null},resize:function(){var B=this.slideObj;B.number++;var A=25;var C={x:B.endSize.x-(B.endSize.x-B.startSize.x)*(Math.sin(Math.PI*(0.5-B.number/A))+1)/2,y:B.endSize.y-(B.endSize.y-B.startSize.y)*(Math.sin(Math.PI*(0.5-B.number/A))+1)/2};Bq(this.resizeDiv,C);if(!document.all){Bq(this.div,{x:C.x+this.button.offsetWidth,y:C.y+this.button.offsetHeight})}if(B.number==A){this.resizeEnd()}},resizeEnd:function(){var A=this.slideObj;window.clearInterval(A.timeout);delete this.slideObj},isOpen:function(){return !!this.show}});function AG(A,C,E,B){var D={};B=(typeof (B)=="number")?(B+"px"):"0px";if(C.x<0.5){D.right="auto";D.left=B}else{if(C.x>0.5){D.left="auto";D.right=B}else{D.right="auto";D.left=E?B:"50%"}}if(C.y<0.5){D.bottom="auto";D.top=B}else{if(C.y>0.5){D.top="auto";D.bottom=B}else{D.bottom="auto";D.top=E?B:"50%"}}BF(A,D)}Am(BH,{setPosition:AG});function BI(A){Av(this,A)}BI.prototype=new AP();Am(BI.prototype,{createImg:function(A,B,E,G,C,D){var F=Ba(B);F._command=C;if(D){F.title=D}BF(F,{position:Ak[67],cursor:Ak[58]});Bq(F,E);Bg(F,G);A.appendChild(F);return F},onMouseDown:function(B){var C=B.target,D=this.map;if(!C||!C._command){return }BS(B);this.downTime=new Date().valueOf();switch(C._command){case Ak[13]:if(D.slideMove){D.slideMove({x:0,y:4},true)}break;case Ak[12]:if(D.slideMove){D.slideMove({x:0,y:-4},true)}break;case Ak[11]:if(D.slideMove){D.slideMove({x:4,y:0},true)}break;case Ak[10]:if(D.slideMove){D.slideMove({x:-4,y:0},true)}break;case Ak[9]:if(D.slideScale){D.slideScale(-0.32,true)}break;case Ak[8]:if(D.slideScale){D.slideScale(0.32,true)}break;case Ak[7]:this.dragObj=new A8(B.target,Bw(this,this.onDrag),{container:this.div,rtp:{x:0,y:1},rtpLimit:{minY:this.zoomStart,maxY:this.zoomStart+(this.map.getZoomScales().length-1)*this.zoomHeight},interval:128});this.dragObj.onMouseDown(B);break;case"zoom":D.setZoom(C._zoom);break}this.lastCommand=C._command;var A=this.div;if(A.setCapture){A.setCapture()}this.muListener=Az(document,Ak[55],this,this.onMouseUp)},onZoomMouseMove:function(A){var C=this.zoomBar,E=Au(A,C);var D=Math.floor(E.y/this.zoomHeight),B=this.map.getZoomScales();C.title=B[D]?B[B.length-1-D].name:"";if(E.x<0||E.y<0||E.x>60||E.y>C.offsetHeight){Bv(this.zoomLis);delete this.zoomLis;this.tipsDiv.style.display=Ak[71]}},onMouseUp:function(G){var J=this.map;if(this.dragObj){this.dragObj.onMouseUp(G);delete this.dragObj;return }if(document.releaseCapture){document.releaseCapture()}Bv(this.muListener);if(!this.lastCommand){return }BS(G);switch(this.lastCommand){case Ak[13]:case Ak[12]:case Ak[11]:case Ak[10]:if(J.slideMove){J.slideMove()}if(!J.slideMove||new Date().valueOf()-this.downTime<256){var F=J.getViewSize(),H=this.lastCommand;var B=(H==Ak[13]?{x:0,y:-F.y/2}:(H==Ak[12]?{x:0,y:F.y/2}:(H==Ak[11]?{x:-F.x/2,y:0}:{x:F.x/2,y:0})));var E=J.fromContainerPixelToLatLng({x:F.x/2+B.x,y:F.y/2+B.y});if(J.panTo){J.panTo(E)}else{J.setCenter(E)}}break;case Ak[9]:case Ak[8]:if(J.slideScale){J.slideScale()}if(!J.slideScale||(new Date().valueOf()-this.downTime<256&&(!J.getTargetScale||J.getScale()==J.getTargetScale()))){var I;if(this.lastCommand==Ak[9]){if(J.zoomIn){J.zoomIn()}else{I=J.getScale()/2}}else{if(J.zoomOut){J.zoomOut()}else{I=J.getScale()*2}}if(I){if(J.panScale){J.panScale(I)}else{J.setScale(I)}}}break;case"zoombar":var D=Au(G,this.zoomBar).y,C=Math.floor(D/this.zoomHeight),A=J.getZoomScales();var K=A[A.length-C-1];if(K){if(J.panScale){J.panScale(K.scale)}else{J.setScale(K.scale)}}break;case Ak[7]:break;case"refresh":if(J.returnToSavedPosition){J.returnToSavedPosition()}break}},create:function(){var J=this.map,K=this.div,E,C=Ak[36]+"lc/",B={x:17,y:17},G=this.listeners;BT(K,true);while(G.length>3){Bv(G.pop())}var A=0,D=0;if(!this.hidePanBtn){this.createImg(K,C+"lc_up.jpg",B,{x:20,y:D},Ak[13],"\u4e0a\u79fb");D+=20;this.createImg(K,C+"lc_left.jpg",B,{x:0,y:D},Ak[11],"\u5de6\u79fb");this.createImg(K,C+"lc_refresh.jpg",B,{x:20,y:D},"refresh","\u8fd4\u56de");this.createImg(K,C+"lc_right.jpg",B,{x:40,y:D},Ak[10],"\u53f3\u79fb");D+=20;this.createImg(K,C+"lc_down.jpg",B,{x:20,y:D},Ak[12],"\u4e0b\u79fb");D+=20;A=Math.max(A,57)}if(!this.hideZoomBtn){A=Math.max(A,17);this.createImg(K,C+"lc_zoomin.jpg",B,{x:(A+3)/2-10,y:D},Ak[9],"\u653e\u5927");D+=20}if(!this.hideZoomBar&&J.getZoomScales&&(E=J.getZoomScales())&&E.length>0){D-=3;A=Math.max(A,17);this.zoomStart=D;var I=this.zoomHeight=9,H=this.zoomBar=document.createElement("div"),F=E.length*I;H._command="zoombar";BF(H,{position:Ak[67],cursor:Ak[58]});BA(H,C+"lc_level.jpg");Bq(H,{x:5,y:F});Bg(H,{x:(A+3)/2-10+6,y:D});K.appendChild(H);this.zoomCursor=this.createImg(K,C+"lc_cursor.jpg",{x:13,y:7},{x:(A+3)/2-10+2,y:D},Ak[7]);BF(this.zoomCursor,{cursor:Ak[58]});D+=F;this.onScale();this.listeners=G.concat(Az(J,Ak[45],this,this.create),Az(J,Ak[42],this,this.onScale),Az(H,Ak[29],this,this.onZoomMouseOver));this.tipsImage=C+"lc_tip.png";this.tipsImageSize={x:42,y:17}}if(!this.hideZoomBtn){this.createImg(K,C+"lc_zoomout.jpg",B,{x:(A+3)/2-10,y:D},Ak[8],"\u7f29\u5c0f");D+=20;A=Math.max(A,17)}Bq(this.div,{x:A,y:D})},initialize:function(B){if(this.map){return false}this.map=B;var A=this.div=document.createElement("div");BF(A,{position:Ak[67],zIndex:10000});this.listeners=[Az(B,Ak[44],this,this.create),BZ(A,Ak[27],BS),Az(A,Ak[57],this,this.onMouseDown)];this.create();this.setLayout({x:0,y:0});this.setPosition({x:10,y:10});B.getContainer().appendChild(A);return true},remove:function(){BT(this.div);delete this.div;AP.prototype.remove.apply(this,arguments)},onDrag:function(J,E,B){var K=this.map;if(B=="start"){AA(K,Ak[37])}var I,D=(E.y-this.zoomStart)/this.zoomHeight-0.5,A=K.getZoomScales();D=Math.min(A.length-1,Math.max(0,D));var C=Math.floor(D),F=Math.ceil(D);if(C==F){I=A[A.length-C-1].scale}else{var G=A[A.length-C-1].scale,H=A[A.length-F-1].scale;I=H*Math.pow(Math.E,(Math.log(G/H)*(F-D)))}K.setScale(I);if(B=="end"){AA(K,Ak[39]);if(K.isStepZoom&&K.isStepZoom()){K.checkScale()}}},onScale:function(){if(!this.map.getZoomScales){return }var E=this.map.getZoomScales();if(!E||E.length<=0){return }var B=this.map,A=B.getScale(),G=B.getZoomIndex(A),C=E[G].scale;var H=this.zoomHeight,D=this.zoomStart+(E.length-G-1)*H,F;if(A>C){F=E[G-1];if(F){D+=Math.round(Math.log(A/C)/Math.log(F.scale/C)*H)}}else{if(A<C){F=E[G+1];if(F){D-=Math.round(Math.log(A/C)/Math.log(F.scale/C)*H)}}}BF(this.zoomCursor,{top:D+"px"});this.zoomCursor.title=E[G].name},onZoomMouseOver:function(G){var H=this.tipsDiv,F=this.zoomBar;if(!H){var H=this.tipsDiv=document.createElement("div"),A=this.tipsImageSize,B=this.map.getZoomScales();BF(H,{position:Ak[67],width:A.x+"px",left:"10px",top:"0px"});var C={13:"\u5e02",4:"\u5168\u56fd",16:"\u8857\u9053",8:"\u7701"},E=(this.zoomHeight-A.y)/2,L=B.length;for(var D in C){if(!C.hasOwnProperty(D)){continue}var I=-1;for(var J=L-1;J>=0;J--){if(B[J].name==D){I=J;break}}if(I<0){continue}var M=document.createElement("div");M._command="zoom";M._zoom=D;M.title=C[D]+"("+D+")";BF(M,{position:Ak[67],fontSize:Ak[33],textAlign:Ak[25],padding:"3px",width:A.x+"px",height:A.y+"px",top:E+(L-1-I)*this.zoomHeight+"px"});var K=this.createImg(M,this.tipsImage,A,{x:0,y:0},"zoom");K._zoom=D;BF(K,{zIndex:-1});M.appendChild(document.createTextNode(C[D]));H.appendChild(M)}F.appendChild(H)}if(!this.zoomLis){this.zoomLis=Az(document,Ak[56],this,this.onZoomMouseMove)}H.style.display=""}});function AQ(){}Am(AQ.prototype,{depose:function(){this.remove()},getContainer:function(){return this.div},getBounds:function(){},initialize:function(A){return true},remove:function(){var A=this.listeners;if(A){for(var B=A.length-1;B>=0;B--){Bv(A[B])}}delete this.listeners;delete this.map}});function BK(A,B,C){if(arguments.length==0){return }C=C?C:{};Av(this,{latlng:A,offset:{x:0,y:0},anchor:{x:0,y:0}});Av(this,C);this.zIndex=C.zIndex?C.zIndex:500;this.setContainer(B);if(C.style){BF(this.div,C.style)}if(C.title){this.setTitle(C.title)}if(C.draggable){this.setDraggingEnabled(true)}}BK.prototype=new AQ();Am(BK.prototype,{reDraw:function(B){if(B<2||!this.map){return }var D=this.map.getGeoPosition(this.latlng),A=this.offset,C=this.anchor;Bg(this.div,{x:D.x+A.x-C.x,y:D.y+A.y-C.y})},remove:function(){this.endDrawing();AQ.prototype.remove.apply(this,arguments)},startDrawing:function(){var A=this.map;if(!A||this.drawObj){return false}if(A.applyCursor){A.applyCursor("mark")}if(A.setCursorText){A.setCursorText("\u5355\u51fb\u6807\u70b9",{offset:{x:10,y:10},style:{whiteSpace:Ak[6]}})}this.drawObj={cursor:this.div.style.cursor,cl:Az(A,Ak[28],this,this.endDrawing),ml:Az(A,Ak[56],this,this.onMapMove)};BF(this.div,{cursor:""});AA(this,Ak[5]);return true},setOpacity:function(A){Bf(this.div,this.opacity=A)},blur:function(){if(BK._focus!=this){return }delete BK._focus;if(this.div){BF(this.div,{zIndex:this.zIndex})}AA(this,"blur")},onMapMove:function(A){this.setLatLng(this.map.fromContainerPixelToLatLng(A))},focus:function(){var A=BK._focus;if(A!=this){if(A){A.blur()}BK._focus=this;if(this.div){BF(this.div,{zIndex:this.zIndex+1})}AA(this,"focus")}},getLatLng:function(){return this.latlng},onDrag:function(B,D,C){if(C=="start"){this.dsl=this.latlng;AA(this,Ak[35],[this.latlng]);this.dragging=true}var A=this.map.fromContainerPixelToLatLng({x:D.x-B.x,y:D.y-B.y},this.dsl,null,{x:0,y:0});this.setLatLng(A);if(C!="start"&&C!="end"){AA(this,"drag",[this.latlng])}if(C=="end"){this.dragging=false;AA(this,Ak[34],[this.latlng])}},getTitle:function(){return this.div.title},getDraggingEnabled:function(){return this.dragEnabled},setTitle:function(A){this.div.title=A},getOpacity:function(){return this.opacity},setDraggingEnabled:function(A){this.dragEnabled=!!A},onMouseEvent:function(C,A,B){if(this.drawObj){return }if(!this.dragging){BS(B)}if(C==Ak[57]&&this.dragEnabled&&!this.dragging){new A8(this.div,Bw(this,this.onDrag),{container:this.map.getContainer(),rtp:{x:1,y:1},interval:this.dragInterval?this.dragInterval:256}).onMouseDown(B)}if(C==Ak[56]){this.focus()}},setLatLng:function(A){this.latlng=A;if(this.map){this.map.onOverlayChange(this)}},setContainer:function(A){if(typeof (A)!=Ak[59]){var C=A;A=document.createElement("div");A.innerHTML=C}BF(A,{position:Ak[67],zIndex:this.zIndex},true);var E=this.div;if(E&&E!=A){if(E.replaceNode){E.replaceNode(A)}else{var D=E.parentNode;if(D){D.removeChild(E)}D.appendChild(A)}}this.div=A;if(E){A._overlay=E._overlay;try{delete E._overlay}catch(B){}}if(this.map){this.reDraw(4)}},getBounds:function(){if(!this.latlng){return null}return new BG(this.latlng,this.latlng)},endDrawing:function(){var B=this.drawObj,A=this.map;if(!B){return }delete this.drawObj;BF(this.div,{cursor:B.cursor});Bv(B.cl);Bv(B.ml);if(A.applyCursor){A.applyCursor()}if(A.setCursorText){A.setCursorText("")}B=null;AA(this,Ak[4])},getSize:function(){return this.size?this.size:{x:this.div.offsetWidth,y:this.div.offsetHeight}},initialize:function(A){this.map=A;return true}});function As(A,C,B){Av(this,{image:A,iconSize:C,iconAnchor:B});this.infoWindowAnchor={x:C.x/2,y:0}}Am(As.prototype,{getCopy:function(){var A=new As(this.image,this.iconSize,this.iconAnchor);A.infoWindowAnchor=this.infoWindowAnchor;return A}});function AH(){if(!As._default){As._default=new As(Ak[36]+"icon/label_unselected.png",{x:49,y:59},{x:24,y:56});As._default.infoWindowAnchor={x:41,y:9}}return As._default}Am(As,{getDefault:AH});function AO(A,B){B=B?B:{};var C=B.icon;C=C?C:AH();var D=Ba(C.image,null,true);if(!B.zIndex){B.zIndex=500}BK.apply(this,[A,D,B]);this.setIcon(C)}AO.prototype=new BK();Am(AO.prototype,{setIcon:function(A){this.icon=A;var C=this.div,B=A.iconSize;if(this.show){BR(C,A.image)}this.anchor=A.iconAnchor;this.infoWindowAnchor=A.infoWindowAnchor;if(this.map){BF(C,{width:B.x+"px",height:B.y+"px"});this.reDraw(4)}},getIcon:function(){return this.icon},getSize:function(){return this.icon.iconSize},reDraw:function(B){if(!this.show){var A=this.div,C=this.icon,D=C.iconSize;BR(A,C.image);BF(A,{cursor:Ak[58],width:D.x+"px",height:D.y+"px"});this.show=true}BK.prototype.reDraw.apply(this,arguments)}});function Ay(A){this.offset={x:0,y:0};this.autoResize=true;var B=this.div=document.createElement("div");var C=this.titleDiv=document.createElement("div");BF(C,{position:Ak[60],overflowX:Ak[70],width:Ak[68],height:Ak[68],fontSize:Ak[33]});var D=this.contentDiv=document.createElement("div");BF(D,{position:Ak[67],fontSize:Ak[33]});this.listeners=[BZ(D,"selectstart",By),Az(this,"add",this,this.changeInfoWin)];this.createInfoWin();BK.apply(this,[A,B,{zIndex:560}])}Ay.prototype=new BK();Am(Ay.prototype,{close:function(){if(!this.map){return }if(this.map){this.map.removeOverlay(this)}AA(this,"close")},setContentSize:function(A){this.size=A;this.reDraw(4)},closeInfoWindow:function(){},openInfoWindow:function(){},onMouseEvent:function(C,A,B){if(!(this.map&&this.map.isDragging&&this.map.isDragging())){By(B)}if(C==Ak[28]){if(B.target&&B.target._iwe=="close"){this.close()}}},endDrawing:function(){},getDraggingEnabled:function(){},getContentSize:function(){var C=this.size,A=this.contentDiv;if(this.autoResize&&this.map){var B=A.offsetWidth,E=A.offsetHeight;if(B<C.x||E==0){var D=A.parentNode;this.map.getContainer().appendChild(A);B=A.offsetWidth;E=A.offsetHeight;A.parentNode.removeChild(A);D.appendChild(A)}C={x:Math.max(B,C.x),y:Math.max(E,C.y)}}return C},reDraw:function(B){if(B<2||!this.map){return }this.changeInfoWin();var D=this.map.getGeoPosition(this.latlng),C=this.anchor,A=this.offset;Bg(this.div,{x:D.x-C.x+A.x,y:D.y-C.y+A.y})},moveIntoView:function(B){B=B?B:5;var L=this.map;if(!L){return }var F=L.getViewSize(),E=this.winSize,M=L.getTargetCenter?L.getTargetCenter():L.getCenter();var G=L.fromLatLngToContainerPixel(this.latlng,M),H=this.anchor,I=this.offset;var J=G.x-H.x+I.x;var C=G.y-H.y+I.y;var A=F.x-G.x-(E.x-H.x)-I.x;var N=F.y-G.y-(E.y-H.y)-I.y;var K={x:0,y:0};if(J*A<0){K.x+=Math.min(J,A)-B;if(A<0){K.x=-K.x}}if(C*N<0){K.y+=Math.min(C,N)-B;if(N<0){K.y=-K.y}}if(K.x!=0||K.y!=0){var D=L.fromContainerPixelToLatLng({x:F.x/2+K.x,y:F.y/2+K.y},M);if(L.panTo){L.panTo(D)}else{L.setCenter(D)}}},setTitle:function(B){var A=this.titleDiv;while(A.firstChild){A.removeChild(A.firstChild)}if(typeof (B)==Ak[59]){A.appendChild(B)}else{A.innerHTML=B?B:""}},setContent:function(B){var A=this.contentDiv;while(A.firstChild){A.removeChild(A.firstChild)}if(typeof (B)==Ak[59]){A.appendChild(B)}else{A.innerHTML=B?B:""}this.reDraw(4)},changeInfoWin:function(){if(!this.map){return }var A=this.tabSize,E=this.cursorSize,B=this.divs;var C=this.getContentSize(),D={x:C.x+21,y:C.y+30+E.y-1};if(this.winSize&&this.winSize.x==D.x&&this.winSize.y==D.y){return }this.winSize=D;BF(this.div,{width:D.x+"px",height:D.y+"px",cursor:Ak[66]});BF(B.top,{width:D.x-A.x*2+"px"});BF(B.left,{height:D.y-A.y*2-(E.y-1)+30+"px"});BF(B.bottom,{width:D.x-A.x*2-26+"px",top:D.y-51+A.y*1+"px"});BF(B.right,{height:D.y-A.y*2-(E.y-1)+30+"px"});BF(B.close,{left:D.x-18+"px"});BF(B.container,{width:D.x-A.x*2+"px",height:D.y-A.y*2-(E.y-1)+30+"px"});BF(this.titleDiv,{width:D.x-A.x*2-12+"px"});BF(B.br,{top:D.y-51+A.y*1+"px"});BF(B.bl,{top:D.y-51+A.y*1+"px",left:D.x-A.x+"px"});this.anchor={x:5,y:D.y+2}},createInfoWin:function(){var F,D,A=this.div,E=this.divs={},C=this.tabSize={x:6,y:25},G=this.cursorSize={x:32,y:32},B=Ak[36]+"iw/";this.setContentSize({x:120,y:20});F=E.ul=Ba(B+Ak[17]);BF(F,{position:Ak[67],left:"0px",top:"0px",width:C.x+"px",height:C.y+"px"});A.appendChild(F);F=E.ur=Ba(B+Ak[16]);BF(F,{position:Ak[67],right:"0px",top:"0px",width:C.x+"px",height:C.y+"px"});A.appendChild(F);F=E.bl=Ba(B+Ak[14]);BF(F,{position:Ak[67],width:C.x+"px",height:10+"px"});A.appendChild(F);D=E.top=document.createElement("div");BA(D,B+"up.png");BF(D,{position:Ak[67],fontSize:"0px",left:C.x+"px",top:"0px",height:C.y+"px",zIndex:50});A.appendChild(D);D=E.left=document.createElement("div");BA(D,B+"left.png");BF(D,{position:Ak[67],fontSize:"0px",left:"0px",top:C.y+"px",width:C.x+"px"});A.appendChild(D);D=E.bottom=document.createElement("div");BA(D,B+"down.png");BF(D,{position:Ak[67],fontSize:"0px",overflow:Ak[70],left:"32px",bottom:(G.y+14)+"px",height:"10px"});A.appendChild(D);D=E.right=document.createElement("div");BA(D,B+"right.png");BF(D,{position:Ak[67],fontSize:"0px",right:"0px",top:C.y+"px",width:C.x+"px"});A.appendChild(D);F=E.br=Ba(B+Ak[15]);BF(F,{position:Ak[67],left:"0px",width:"32px",height:"32px"});A.appendChild(F);var H=E.container=document.createElement("div");BF(H,{position:Ak[67],backgroundColor:"#FBFBFB",left:C.x+"px",top:C.y+"px",overflow:Ak[70]});A.appendChild(H);BF(this.titleDiv,{fontSize:"13px",fontWeight:"bolder",color:Ak[23],textAlign:Ak[25],position:Ak[67],left:"4px",top:"4px",height:"15px",overflow:Ak[70],zIndex:100});A.appendChild(this.titleDiv);BF(this.contentDiv,{fontSize:Ak[33],color:"#666666",position:Ak[67],textAlign:Ak[22],left:"5px",top:"5px"});H.appendChild(this.contentDiv);F=E.close=Ba(B+"close.png");BF(F,{position:Ak[67],width:"7px",height:"7px",top:"7px",cursor:Ak[58],backgroundColor:Ak[24],zIndex:100});A.appendChild(F);F._iwe="close"},setDraggingEnabled:function(){},setOffset:function(A){this.offset=A;this.reDraw(4)},startDrawing:function(){}});function Bm(A,B){if(arguments.length==0){return }if(typeof (B)!=Ak[59]){B={color:B}}this.zIndex=B.zIndex?B.zIndex:420;this.graphics=this.getGraphics();BF(this.graphics.getPanel(),{zIndex:this.zIndex});if(B.title){this.graphics.getPanel().title=B.title}if(B.cursor){BF(this.graphics.getPanel(),{cursor:B.cursor})}this.setPoints(A);if(arguments[2]){B.bgcolor=arguments[2]}if(arguments[3]){B.weight=arguments[3]}if(arguments[4]){B.opacity=arguments[4]}this.setLineColor((B.color||B.color=="")?B.color:"#0000FF");this.setFillColor((B.bgcolor||B.bgcolor=="")?B.bgcolor:"#99FFCC");this.setLineWeight((B.weight||B.weight===0)?B.weight:3);this.setOpacity((B.opacity||B.opacity===0)?B.opacity:0.5);this.setLineStyle(B.lineStyle?B.lineStyle:"solid");this.isLine=B.isLine;this.disableReduce=B.disableReduce;this.offset=B.offset}Bm.prototype=new AQ();Am(Bm.prototype,{getLineColor:function(){return this.color},reDraw:function(H){var P=this.map,F=this.getBounds(),G=P.getOverlaysBounds();var B=Math.min(F.ne.la,G.ne.la);var J=Math.max(F.sw.la,G.sw.la);var E=Math.min(F.ne.lo,G.ne.lo);var R=Math.max(F.sw.lo,G.sw.lo);var M=J<=B&&R<=E,T=this.graphics;if(M){var N=P.getScale();if(H&4||H&1){this.drawBounds=G;var D=new BG(new AM(J,R),new AM(B,E));var A=P.fromLatLngToPixel(D.sw),Q=P.fromLatLngToPixel(D.ne);var U=this.getSuctionPoints(N),C=this.showScale;var K={x:Math.floor(Math.min(Q.x,A.x)/C),y:Math.floor(Math.min(Q.y,A.y)/C)},L={x:Math.ceil(Math.max(Q.x,A.x)/C),y:Math.ceil(Math.max(Q.y,A.y)/C)};this.painted=this.drawPoints(U,K,L,T,D.containsBounds(F));if(this.painted&&H&4&&document.all){T.setLineColor(this.color);T.setFillColor(this.bgcolor);T.setLineWeight(this.weight);T.setOpacity(this.opacity);T.setLineStyle(this.lineStyle)}}if(this.painted){var I=this.drawMinP;var O=P.getGeoPosition(P.fromPixelToLatLng({x:I.x*this.showScale,y:I.y*this.showScale}));if(this.offset){O={x:O.x+this.offset.x,y:O.y+this.offset.y}}T.setPosition(O);T.setScale(N/this.showScale)}}else{T.clear()}if(this._isEditting){this.checkMarkers(H&4)}},onEditDrag:function(E){var K=this.editDragObj;if(!K){return }var L=this.map,D=this.points,I=K.index,G=D.length,F=(K.type=="point");var M=AA(this,F?Ak[3]:Ak[2],[I,E]);var J=M?this.color:"gray",H=this.isLine;if(!H||I>0||!F){var A=F?[D[I-1>=0?(I-1):(G-1)],E]:[D[I],E];if(!K.line1){var B=K.line1=new Bj(A,J,this.weight,this.opacity);B.setLineStyle(Ak[49]);L.addOverlay(B)}else{K.line1.setPoints(A);K.line1.setLineColor(J)}}if(!H||G>I+1||!F){var C=[E,D[I+1<G?(I+1):0]];if(!K.line2){var B=K.line2=new Bj(C,J,this.weight,this.opacity);B.setLineStyle(Ak[49]);L.addOverlay(B)}else{K.line2.setPoints(C);K.line2.setLineColor(J)}}K.isValid=M},onEditPointMouseOver:function(A){return function(B){var G=this.editSymbols,F,E=this.points;if(E.length<(this.isLine?3:4)){return }for(F=G.length-1;F>=0;F--){if(G[F]==A){break}}if(F<0){return }if(!AA(this,Ak[1],[F])){return }var C=this.editHoverObj;if(C){if(C.index==F){return }else{this.endEditHover()}}var D=new AO(E[F],{icon:new As(Ak[36]+"plo/p_close.jpg",{x:11,y:11},{x:-6,y:6})});this.map.addOverlay(D);this.editHoverObj={mol:Az(document,Ak[56],this,this.onEditMouseOut),cl:Az(D,Ak[28],this,this.onEditDelete),delBtn:D,index:F}}},onEditLineDragStart:function(A){return function(B){var D=this.editSymbols,C;for(C=D.length-1;C>=0;C--){if(D[C]==A){break}}if(C<0){return }if(this.editDragObj){this.endEditDrag()}this.editDragObj={dl:Az(A.lMarker,"drag",this,this.onEditDrag),del:Az(A.lMarker,Ak[34],this,this.endEditDrag),type:"line",index:C}}},getLineWeight:function(){return this.weight},addPoint:function(C){var B=this.points,D=B.length,A=this.map.fromContainerPixelToLatLng(C);if(D==0||!B[D-1].equals(A)){B.push(A);this.setPoints(B)}},endDrawing:function(){var B=this.drawObj,A=this.map;if(!B){return }delete this.drawObj;Bv(B.cl);Bv(B.dl);Bv(B.ml);if(A.applyCursor){A.applyCursor()}if(A.setDblClickEnable){A.setDblClickEnable(true)}if(A.setCursorText){A.setCursorText("")}if(B.preLine){A.removeOverlay(B.preLine);delete B.preLine}B=null;if(this.points.length<(this.isLine?2:3)){this.setPoints([])}AA(this,Ak[4])},getSuctionPoints:function(U){var V,M=this.sPoints,L=Math.round(Math.log(U/this.minScale)/Math.log(2))-1;if(L<0){L=0}this.showScale=(1<<L)*this.minScale;if(V=M[L]){return V}var P,G=M.levels;for(P=G.length-1;P>=0;P--){if(G[P]<L){break}}M[L]=V=[];G.splice(P+1,0,L);var Z,b,T=M[G[P]],N=T.length,O=0,J=L-G[P],F,H;var B,D,c,C,A,Y,a,X=this.disableReduce,E=1;var W=Math.sqrt,K=Math.atan2,R=Math.min,Q=Math.max,I=Math.atan;for(P=0;P<N;P++){Z=T[P].x>>J;b=T[P].y>>J;if(P>0&&F==Z&&H==b){continue}if(!X&&P>0){if(A){Y=K(C-b,Z-c);if(Y>B&&Y<D){a=I(E/W((C-b)*(C-b)+(Z-c)*(Z-c)));B=Q(B,Y-a);D=R(D,Y+a);V[O-1]={x:(F=Z),y:(H=b)};continue}A=false}if(!A){A=true;C=H;c=F;Y=K(C-b,Z-c);a=I(E/W((C-b)*(C-b)+(Z-c)*(Z-c)));B=Y-a;D=Y+a}}V.push({x:(F=Z),y:(H=b)});O++}return V},focus:function(){var A=Bm._focus;if(A!=this){if(A){A.blur()}Bm._focus=this;if(this.getContainer()){BF(this.getContainer(),{zIndex:this.zIndex+1})}AA(this,"focus")}},removeLMarker:function(A){if(!A){return }if(A.lMarker){Bv(A.lmdLis);delete A.lmdLis;this.map.removeOverlay(A.lMarker);A.lMarker.depose();delete A.lMarker}},setOpacity:function(A){this.graphics.setOpacity(this.opacity=A)},removePMarker:function(A){if(!A){return }if(A.pMarker){Bv(A.pmdLis);delete A.pmdLis;Bv(A.pmoLis);delete A.pmoLis;this.map.removeOverlay(A.pMarker);A.pMarker.depose();delete A.pMarker}},checkIntersection:function(A,C,G,F,E){var J=this.map,B=J.fromLatLngToPixel(A[0]),D=J.fromLatLngToPixel(A[1]);for(var H=C.length-1;H>=0;H--){if(G&&H==C.length-1){continue}var I=H+1<C.length?(H+1):0;if(H==F||(E&&I==F)){continue}if(AN(B,D,J.fromLatLngToPixel(C[H]),J.fromLatLngToPixel(C[I]))){return true}}return false},initSuctionPoints:function(V){this.sPoints={levels:[0]};var O=this.points,H=this.bounds=new BG(new AM(Number.MAX_VALUE,Number.MAX_VALUE),new AM(Number.MIN_VALUE,Number.MIN_VALUE));if(O){var b,c,X=this.sPoints[0]=[],M=O.length,N=0,F,R,I,J,W=this.minScale=360/256/Math.pow(2,17);var C,E,A,D,B,Z,a,Y=this.disableReduce,G=1;var U=Math.sqrt,L=Math.atan2,T=Math.min,P=Math.max,K=Math.atan;for(var Q=0;Q<M;Q++){F=O[Q];H.extend(F);R=V.fromLatLngToPixel(F);b=parseInt(R.x/W);c=parseInt(R.y/W);if(Q>0&&I==b&&J==c){continue}if(!Y&&Q>0){if(B){Z=L(D-c,b-A);if(Z>C&&Z<E){a=K(G/U((D-c)*(D-c)+(b-A)*(b-A)));C=P(C,Z-a);E=T(E,Z+a);X[N-1]={x:(I=b),y:(J=c)};continue}B=false}if(!B){B=true;D=J;A=I;Z=L(D-c,b-A);a=K(G/U((D-c)*(D-c)+(b-A)*(b-A)));C=Z-a;E=Z+a}}X.push({x:(I=b),y:(J=c)});N++}}},setLineStyle:function(A){if(!A){return }this.graphics.setLineStyle(this.lineStyle=A)},getContainer:function(){return this.graphics.getPanel()},onMapMove:function(G){var E=this.drawObj,D=this.points,H=D.length,B=this.map;if(!E||H<1){return }var F=[D[H-1],B.fromContainerPixelToLatLng(G)];if(H>1&&!this.isLine){F.push(D[0])}if(B.setCursorText&&E.showDis){var A,C=[].concat(D,F[1]);if(this.isLine){A="<br/>\u79bb\u4e0a\u4e00\u70b9\u8ddd\u79bb: <b>%1</b> km<br/>\u603b\u8ddd\u79bb: <b>%0</b> km".replace("%0",Math.round(AX(C)/10)/100).replace("%1",Math.round(AX(F)/10)/100)}else{A="<br/>\u9762\u79ef\u4e3a: <b>%0</b> km<sup>2</sup>".replace("%0",Math.round(AI(C)/10000)/100)}B.setCursorText(Ak[0]+A,{offset:{x:10,y:10},style:{whiteSpace:Ak[6]}})}if(!E.preLine){E.preLine=new Bj(F,this.color,this.weight,this.opacity);E.preLine.setLineStyle(Ak[49]);B.addOverlay(E.preLine)}else{E.preLine.setPoints(F)}},removeSymbol:function(B){var C=this.editSymbols,A=C[B];this.removePMarker(A);this.removeLMarker(A);C.splice(B,1)},getGraphics:function(){var B=[An,A6,Bn,BN];for(var A=0;A<B.length;A++){if(B[A].isSupport()){return new B[A]({zIndex:this.zIndex})}}return new Aw(true)},endEditDrag:function(E){var B=this.editDragObj;delete this.editDragObj;if(!B){return }Bv(B.dl);Bv(B.del);var A=this.map,D,C=this.points;if(D=B.line1){A.removeOverlay(D);D.depose();delete B.line1}if(D=B.line2){A.removeOverlay(D);D.depose();delete B.line2}if(B.isValid){if(E){if(B.type=="line"){C.splice(B.index+1,0,E)}else{C[B.index]=E}}this.setPoints(C);AA(this,B.type=="point"?"aftereditmove":"aftereditadd",[B.index,E])}else{this.checkMarkers(true)}},endEditHover:function(){var A=this.editHoverObj;if(!A){return }delete this.editHoverObj;Bv(A.mol);Bv(A.cl);this.map.removeOverlay(A.delBtn);A.delBtn.depose();delete A.delBtn},startDrawing:function(B){var A=this.map;if(!A||this.drawObj){return false}if(A.applyCursor){A.applyCursor("mark")}if(A.setDblClickEnable){A.setDblClickEnable(false)}if(A.setCursorText){A.setCursorText(Ak[0],{offset:{x:10,y:10},style:{whiteSpace:Ak[6]}})}this.drawObj={cl:Az(A,Ak[28],this,this.addPoint),dl:Az(A,Ak[27],this,this.endDrawing),ml:Az(A,Ak[56],this,this.onMapMove),showDis:!!B};this.drawObj.showDis=true;AA(this,Ak[5]);return true},setFillColor:function(A){this.graphics.setFillColor(this.bgcolor=A)},onEditDelete:function(){var A=this.editHoverObj;if(!A){return }var B=this.points;B.splice(A.index,1);this.removeSymbol(A.index);this.setPoints(B);AA(this,"aftereditdelete",[A.index])},onMouseEvent:function(D,A,B){if(this.drawObj){return }if(D==Ak[57]&&document.releaseCapture){B.target._needUp=true}var C=this.map;if(D==Ak[56]&&(!document.all||!C.getTargetScale||C.getTargetScale()==C.getScale())){this.focus()}},setLineColor:function(A){this.graphics.setLineColor(this.color=A)},setOffset:function(A){this.offset=A;this.reDraw(0)},drawPoints:function(B,A,C,D,E){this.drawMinP=A;D.init(A,C,1);if(B.length>=2){if(!E){B=AK(B,A,C)}D.drawPolygon(B)}return true},onEditPointDragStart:function(A){return function(B){var D=this.editSymbols,C;for(C=D.length-1;C>=0;C--){if(D[C]==A){break}}if(C<0){return }if(this.editDragObj){this.endEditDrag()}this.editDragObj={dl:Az(A.pMarker,"drag",this,this.onEditDrag),del:Az(A.pMarker,Ak[34],this,this.endEditDrag),type:"point",index:C}}},setPoints:function(A){this.points=A;this.sPoints=null;this.bounds=null;if(this.map){this.initSuctionPoints(this.map.getProjection());this.map.onOverlayChange(this)}if(A&&A.length==0&&this.drawObj&&this.drawObj.preLine){this.map.removeOverlay(this.drawObj.preLine);delete this.drawObj.preLine}},blur:function(){if(Bm._focus!=this){return }delete Bm._focus;if(this.getContainer()){BF(this.getContainer(),{zIndex:this.zIndex})}AA(this,"blur")},setLineWeight:function(A){if(isNaN(parseInt(A))){return }this.graphics.setLineWeight(this.weight=A)},getOffset:function(){return this.offset?this.offset:{x:0,y:0}},getOpacity:function(){return this.opacity},getPoints:function(){return this.points},getLineStyle:function(A){return this.lineStyle},onEditMouseOut:function(A){var B=this.editHoverObj},getBounds:function(){return this.bounds},checkMarkers:function(H){this.endEditHover();var O=this.map,M=O.getScale(),F=O.getOverlaysBounds(),R=this.points,P=R.length,L=this.editSymbols;var A=Ak[36]+"plo/",B=this.editIcon,T=this.addIcon;if(!B){B=this.editIcon=new As(A+"p_edit.jpg",{x:11,y:11},{x:6,y:6})}if(!T){T=this.addIcon=new As(A+"p_add.jpg",{x:9,y:9},{x:5,y:5})}if(!L){L=this.editSymbols=new Array(P)}else{if(L.length>P){for(var Q=L.length-1;Q>=P;Q--){this.removeSymbol(Q)}}else{if(L.length<P){for(var Q=L.length;Q<P;Q++){L.push({})}}}}var K=-1,C=16;for(var Q=P-1;Q>=0;Q--){if(!L[Q]){L[Q]={}}var N=false,G=false;var U=-1;if(F.containsLatLng(R[Q])){if(K<0&&!(this.isLine&&Q==P-1)){var I=O.fromLatLngToPixel(R[Q]),J=O.fromLatLngToPixel(R[Q+1<P?(Q+1):0]);K=(Math.abs(I.x-J.x)+Math.abs(I.y-J.y))/M}if(U<0&&!(this.isLine&&Q==0)){var I=O.fromLatLngToPixel(R[Q]),J=O.fromLatLngToPixel(R[Q-1>=0?(Q-1):(P-1)]);U=(Math.abs(I.x-J.x)+Math.abs(I.y-J.y))/M}if(K<0||K>C||U<0||U>C){N=true}if(K>C*2){G=true}}K=U;if(N){if(!L[Q].pMarker){var E=L[Q].pMarker=new AO(R[Q],{icon:B,draggable:true,dragInterval:32});L[Q].pmdLis=Az(E,Ak[35],this,this.onEditPointDragStart(L[Q]));L[Q].pmoLis=Az(E,Ak[29],this,this.onEditPointMouseOver(L[Q]));O.addOverlay(E)}else{if(H){L[Q].pMarker.setLatLng(R[Q])}}}else{this.removePMarker(L[Q])}if(G){var I=O.fromLatLngToPixel(R[Q]),J=O.fromLatLngToPixel(R[Q+1<P?(Q+1):0]);var D=O.fromPixelToLatLng({x:(I.x+J.x)/2,y:(I.y+J.y)/2});if(!L[Q].lMarker){var E=L[Q].lMarker=new AO(D,{icon:T,draggable:true,dragInterval:32});L[Q].lmdLis=Az(E,Ak[35],this,this.onEditLineDragStart(L[Q]));O.addOverlay(E)}else{if(H){L[Q].lMarker.setLatLng(D)}}}else{this.removeLMarker(L[Q])}}},endEditting:function(){this._isEditting=false;this.endEditHover();this.endEditDrag();var B=this.editSymbols;if(B){for(var A=B.length-1;A>=0;A--){this.removeSymbol(A)}}delete this.editSymbols},initialize:function(A){this.map=A;if(!this.bounds){this.initSuctionPoints(A.getProjection())}return true},startEditting:function(A){A=A?A:{};this._isEditting=true;if(this.points.length<=1){return }if(A.disableIntersection){Az(this,Ak[1],this,function(C){var B=this.points,D=[B[C-1>=0?C-1:B.length-1],B[C+1<B.length?C+1:0]];if(this.checkIntersection(D,B,this.isLine,C,true)){return false}});Az(this,Ak[3],this,function(C,F){var B=this.points,G=B.length,E,D=this.isLine;if(!D||C>0){E=[B[C-1>=0?(C-1):(G-1)],F];if(this.checkIntersection(E,B,D,C,true)){return false}}if(!D||G>C+1){E=[F,B[C+1<G?(C+1):0]];if(this.checkIntersection(E,B,D,C,true)){return false}}return true});Az(this,Ak[2],this,function(C,F){var B=this.points,G=B.length,E,D=this.isLine;E=[B[C],F];if(this.checkIntersection(E,B,D,C,false)){return false}E=[F,B[C+1<G?(C+1):0]];if(this.checkIntersection(E,B,D,C,false)){return false}return true})}this.checkMarkers(true)},getFillColor:function(){return this.bgcolor}});function AI(A){var B=0,D=A.length;for(var C=1;C<D;C++){B+=AV(A[C-1],A[C])}B+=AV(A[D-1],A[0]);return Math.abs(B)}function AK(B,A,C){B=AL(B,A.x,false,false);B=AL(B,C.x,true,false);B=AL(B,A.y,false,true);B=AL(B,C.y,true,true);return B}function AL(C,M,J,A){var D=[],I=C.length;for(var L=0;L<I;L++){var B=C[L],E=C[((L+1)<I)?(L+1):0];if(B.x==E.x&&B.y==E.y){continue}var F=A?B.y:B.x,G=A?E.y:E.x;var H=(J==(F<M)),K=(J==(G<M));if(H!=K){D.push(AW(B,E,M,A))}if(K){D.push(E)}}return D}function AN(E,F,A,B){var C=E.x*(A.y-F.y)+F.x*(E.y-A.y)+A.x*(F.y-E.y);var D=E.x*(B.y-F.y)+F.x*(E.y-B.y)+B.x*(F.y-E.y);if(((C*D)>=0)&&!(C==0&&D==0)){return false}C=A.x*(E.y-B.y)+B.x*(A.y-E.y)+E.x*(B.y-A.y);D=A.x*(F.y-B.y)+B.x*(A.y-F.y)+F.x*(B.y-A.y);if(((C*D)>=0)&&!(C==0&&D==0)){return false}return true}function AV(A,B){return(B.lo-A.lo)*100000*(B.la+A.la)*100000/2}function AW(A,B,D,C){if(C){return{x:(A.x+(B.x-A.x)/(B.y-A.y)*(D-A.y)),y:D}}else{return{x:D,y:(A.y+(B.y-A.y)/(B.x-A.x)*(D-A.x))}}}Am(Bm,{getPointsArea:AI,runClipping:AK,clipSide:AL,IsIntersection:AN,getLineSQR:AV,intersect:AW});function Bj(A,B){if(typeof (B)!=Ak[59]){B={color:B}}if(arguments[2]){B.weight=arguments[2]}if(arguments[3]){B.opacity=arguments[3]}B.bgcolor="";B.isLine=true;Bm.apply(this,[A,B])}Bj.prototype=new Bm();Am(Bj.prototype,{drawPoints:function(Z,J,L,R,K){var G=Z.length,Y=-1,C,Q,H,X=this.map,F,E=[],I,M,O,N,P;var T=L.x,U=L.y,V=J.x,W=J.y,A=Math.max,D=Math.min;if(!K){M=V;O=W;N=T;P=U}for(var B=0;B<G;B++){C=Z[B];if(K||(C.x>=M&&C.y>=O&&C.x<=N&&C.y<=P)){T=D(T,C.x);U=D(U,C.y);V=A(V,C.x);W=A(W,C.y);if(B==0){I=[C]}else{if(Y==B-1){I.push(C)}else{I=this.getIntersection(J,L,Z[B-1],C);Q=I[0];T=D(T,Q.x);U=D(U,Q.y);V=A(V,Q.x);W=A(W,Q.y);Q=I[1];if(Q){T=D(T,Q.x);U=D(U,Q.y);V=A(V,Q.x);W=A(W,Q.y)}E.push(C)}}H=C;Y=B}else{if(B!=0&&Y==B-1){F=this.getIntersection(J,L,Z[B-1],C);if(Q=F[0]){T=D(T,Q.x);U=D(U,Q.y);V=A(V,Q.x);W=A(W,Q.y);I.push(Q)}}if(I){E.push(I);I=null}if(B!=0&&Y!=B-1){F=this.getIntersection(J,L,Z[B-1],C);if(F.length==2){Q=F[0];T=D(T,Q.x);U=D(U,Q.y);V=A(V,Q.x);W=A(W,Q.y);Q=F[1];T=D(T,Q.x);U=D(U,Q.y);V=A(V,Q.x);W=A(W,Q.y);E.push(F)}}}}if(V<T||W<U){R.clear();return false}R.init({x:T,y:U},{x:V,y:W},1);this.drawMinP={x:T,y:U};if(I){E.push(I)}for(var B=E.length-1;B>=0;B--){R.drawPolyline(E[B])}return true},getIntersection:function(A,B,I,O){var J,D,K=[],F=A.x,G=A.y,L=B.x,N=B.y;if(I.y==O.y){if(I.x==O.x){return K}if(I.y>=G&&I.y<=N){J=I.x<=F?-1:(I.x>=L?1:0);D=O.x<=F?-1:(O.x>=L?1:0);if(J==D){return K}if(J+D<=0){K.push({x:F,y:I.y})}if(J+D>=0){K.push({x:L,y:I.y})}}return K}else{if(I.x==O.x){if(I.x>=F&&I.x<=L){J=I.y<=G?-1:(I.y>=N?1:0);D=O.y<=G?-1:(O.y>=N?1:0);if(J==D){return K}if(J+D<=0){K.push({x:I.x,y:G})}if(J+D>=0){K.push({x:I.x,y:N})}}return K}}var H=(O.y-I.y)*(F-I.x)/(O.x-I.x)+I.y;if(H>=G&&H<N&&(H-I.y)*(H-O.y)<=0){K.push({x:F,y:H})}var E=(O.y-I.y)*(L-I.x)/(O.x-I.x)+I.y;if(E>=G&&E<N&&(E-I.y)*(E-O.y)<=0){K.push({x:L,y:E})}var M=(O.x-I.x)*(N-I.y)/(O.y-I.y)+I.x;if(M>=F&&M<L&&(M-I.x)*(M-O.x)<=0){K.push({x:M,y:N})}var C=(O.x-I.x)*(G-I.y)/(O.y-I.y)+I.x;if(C>=F&&C<L&&(C-I.x)*(C-O.x)<=0){K.push({x:C,y:G})}if(K.length==2){if(K[0].x==K[1].x){K.pop()}}return K}});function BW(C,E,F,B,D){this.bounds=C;var A=this.div=document.createElement("div");BF(A,{position:Ak[67],zIndex:420,fontSize:"0px",overflow:Ak[70]});this.setLineColor((E||E=="")?E:"#0000FF");this.setFillColor((F||F=="")?F:"#99FFCC");this.setLineWeight((B||B===0)?B:3);this.setOpacity((D||D===0)?D:0.5);this.setLineStyle("solid")}BW.prototype=new AQ();Am(BW.prototype,{reDraw:function(){var M=this.map,N=this.bounds,L=M.getOverlaysBounds();var E=Math.min(N.ne.lat(),L.ne.lat());var G=Math.max(N.sw.lat(),L.sw.lat());var C=Math.min(N.ne.lng(),L.ne.lng());var F=Math.max(N.sw.lng(),L.sw.lng());var J=G<=E&&F<=C,A=this.graphics;if(J){var H=new BG(new AM(G,F),new AM(E,C));var B=M.fromLatLngToPixel(H.sw),O=M.fromLatLngToPixel(H.ne);var K={x:Math.min(O.x,B.x),y:Math.min(O.y,B.y)};var I=M.getScale(),D=M.getGeoPosition(M.fromPixelToLatLng(K));Bg(this.div,D);Bq(this.div,{x:Math.abs(O.x-B.x)/I,y:Math.abs(O.y-B.y)/I});BF(this.div,{display:""})}else{BF(this.div,{display:Ak[71]})}},setBounds:function(A){this.bounds=A;if(this.map){this.map.onOverlayChange(this)}},setFillColor:function(A){BF(this.div,{backgroundColor:(this.bgcolor=A)})},setLineWeight:function(A){BF(this.div,{borderWidth:(this.weight=A)})},startDrawing:function(){var A=this.map;if(!A||this.drawObj){return false}if(A.applyCursor){A.applyCursor("mark")}if(A.setCursorText){A.setCursorText("\u62d6\u62fd\u7ed8\u5236\u77e9\u5f62",{offset:{x:10,y:10},style:{whiteSpace:Ak[6]}})}if((this.mapDragFlag=(A.draggingEnabled&&A.draggingEnabled()))){A.disableDragging()}this.drawObj={cl:Az(A,Ak[57],this,this.onDrawStart)};AA(this,Ak[5]);this.lastBounds=this.bounds;this.setBounds(null);return true},setOpacity:function(A){Bf(this.div,this.opacity=A)},onDrawStart:function(E){var D=this.drawObj,C=this.map;var A=D.sp=D.ep=this.map.fromContainerPixelToLatLng(E);var B=D.preRect=new BW(new BG(A,A),this.color,"",this.weight,this.opacity);B.setLineStyle(Ak[49]);C.addOverlay(B);D.ml=Az(C,Ak[56],this,this.onMapMove);D.ul=Az(C,Ak[55],this,this.endDrawing)},onMapMove:function(E){var C=this.drawObj,A=this.map,B=C.sp;var D=C.ep=this.map.fromContainerPixelToLatLng(E);C.preRect.setBounds(new BG(new AM(Math.min(B.lat(),D.lat()),Math.min(B.lng(),D.lng())),new AM(Math.max(B.lat(),D.lat()),Math.max(B.lng(),D.lng()))))},getFillColor:function(){return this.bgcolor},setLineStyle:function(A){if(!A){return }BF(this.div,{borderStyle:(this.lineStyle=A)})},getOpacity:function(){return this.opacity},getLineStyle:function(A){return this.lineStyle},setLineColor:function(A){BF(this.div,{borderColor:(this.color=A)})},getLineColor:function(){return this.color},getLineWeight:function(){return this.weight},getBounds:function(){return this.bounds},endDrawing:function(){var D=this.drawObj,A=this.map;if(!D){return }delete this.drawObj;Bv(D.cl);Bv(D.ul);Bv(D.ml);if(this.mapDragFlag){A.enableDragging()}if(A.applyCursor){A.applyCursor()}if(A.setCursorText){A.setCursorText()}if(D.preRect){A.removeOverlay(D.preRect);delete D.preRect}var C,B=D.sp,E=D.ep;if(B&&E){C=new BG(new AM(Math.min(B.lat(),E.lat()),Math.min(B.lng(),E.lng())),new AM(Math.max(B.lat(),E.lat()),Math.max(B.lng(),E.lng())))}else{C=this.lastBounds}this.setBounds(C);D=null;AA(this,Ak[4])},initialize:function(A){this.map=A;return true}});function A9(){}Am(A9.prototype,{fromLatLngToPixel:function(A){var D=A.lng();var C=Math.min(Math.max(Math.sin(A.lat()*Math.PI/180),-0.9999),0.9999);var B=(-180*Math.log((1+C)/(1-C))/Math.PI/2);return{x:D,y:B}},fromPixelToLatLng:function(D){var C=D.x;var B=-D.y/128*Math.PI*256/360;var A=(2*Math.atan(Math.exp(B))-Math.PI/2)*180/Math.PI;return new AM(A,C)}});function AM(A,B){this.la=parseFloat(A);this.lo=parseFloat(B)}Am(AM.prototype,{lat:function(){return this.la},equals:function(A){return A&&A.lat()==this.la&&A.lng()==this.lo},lng:function(){return this.lo}});function AX(B){var H=0,E=6371.004,J=Math.PI/180;for(var D=B.length-2;D>=0;D--){var I=B[D],A=B[D+1];var C=(A.lo-I.lo)*J,F=Math.PI/2-I.la*J,G=Math.PI/2-A.la*J;H+=E*Math.acos(Math.cos(G)*Math.cos(F)+Math.sin(G)*Math.sin(F)*Math.cos(C))*1000}return Math.round(H)}Am(AM,{getDistance:AX});function BG(B,A){this.sw=B;this.ne=A}Am(BG.prototype,{extend:function(D){var C=D.lng(),A=D.lat(),E=this.sw,B=this.ne;if(E.lng()>C){E.lo=C}if(B.lng()<C){B.lo=C}if(E.lat()>A){E.la=A}if(B.lat()<A){B.la=A}return this},getCenter:function(){return new AM((this.sw.lat()+this.ne.lat())/2,(this.sw.lng()+this.ne.lng())/2)},containsBounds:function(A){return(A.sw.lng()>=this.sw.lng()&&A.ne.lng()<=this.ne.lng()&&A.sw.lat()>=this.sw.lat()&&A.ne.lat()<=this.ne.lat())},containsLatLng:function(A){return(A.lng()>=this.sw.lng()&&A.lng()<this.ne.lng()&&A.lat()>=this.sw.lat()&&A.lat()<this.ne.lat())},getSouthWest:function(){return this.sw},getNorthEast:function(){return this.ne}});function AY(B){var A=new BG(new AM(Number.MAX_VALUE,Number.MAX_VALUE),new AM(Number.MIN_VALUE,Number.MIN_VALUE));for(var C=B.length-1;C>=0;C--){A.extend(B[C])}return A}Am(BG,{getLatLngBounds:AY});function BU(F,E){this.config=E=E?E:{};this.initContainer(F);this.setViewSize();this.controls=[];if(document.createDocumentFragment){this.containerFragment=document.createDocumentFragment()}var B=E.initControls?E.initControls:[BM,Bp,A1,A0,BV,Bt,AR,Bl,A4,AU,BC,Br,Ag,AS,BJ,{argu:[[{html:'&copy; 2011 <a href="http://ditu.aliyun.com/" target="_blank" style="color:#000000">Aliyun</a>',minWidth:-1},{html:'&copy; 2011 <a href="http://ditu.aliyun.com/" target="_blank" style="color:#000000">Aliyun</a> \u2013 Map Data &copy; <a href="http://www.autonavi.com/" target="_blank"><font color="#000000">AutoNavi</font></a> GS(2010)6011',minWidth:400}],{x:0,y:1},{x:10,y:-18},{fontSize:"11px",color:Ak[23],fontFamily:"Arial",height:Ak[21]}],cla:AC}];for(var D=0;D<B.length;D++){var C=B[D],A,G=C.argu;this.addControl(C.cla?new C.cla(G[0],G[1],G[2],G[3],G[4],G[5]):new C())}if(this.containerFragment){this.container.appendChild(this.containerFragment);delete this.containerFragment;Bh(10001,1)}}Am(BU.prototype,{getScale:function(){return this.scale},setCenter:function(A){if(!A||A.equals(this.center)){return }if(!this.loaded){this.center=A;this.initialize();return }if(!this.loaded){return }if(!AA(this,"beforemove",[A])){return false}this.center=A;AA(this,Ak[40],[A]);return true},removeControl:function(A){if(!A){return }A.remove();A3(this.controls,A);AA(this,"removecontrol",[A])},setScale:function(A){if(!A||(this.scale&&this.scale==A)){return }if(!this.loaded){this.scale=A;this.initialize();return }if(!this.loaded){return }if(!AA(this,Ak[43],[A])){return false}this.scale=A;AA(this,Ak[42],[A]);return true},getContainer:function(){return this.container},getCenter:function(){return this.center},initialize:function(){if(this.loaded||!this.center||!this.scale){return }this.loaded=true;AA(this,Ak[44])},depose:function(){var B=this.controls;for(var A=B.length-1;A>=0;A--){this.removeControl(B[A])}BT(this.container,true)},initContainer:function(D){try{document.execCommand("BackgroundImageCache",false,true)}catch(B){}var A;D=this.container=BB(D);BF(D,this.containerStyle,true);Bi(D);var C=D.style;if(C.position!=Ak[67]){C.position=Ak[60]}BF(D,{textAlign:Ak[22],overflow:Ak[70]});while(A=D.firstChild){D.removeChild(A)}},addControl:function(A){if(!A){return false}var B=this.containerFragment;if(A.initialize(this,B?B:this.container)==false){return false}this.controls.push(A);AA(this,"addcontrol",[A]);return true},getViewSize:function(){return this.viewSize},setViewSize:function(C){if(C&&(!C.x||!C.y)){C=null}var A=this.viewSize,B=!!C;C=C?C:BQ(this.container);if(A&&C.x==A.x&&C.y==A.y){return }if(B){Bq(this.container,C)}this.viewSize=C;AA(this,Ak[47],[C])}});function BO(A,B){for(var C in B){if(A[C]){if(typeof (B[C])==Ak[59]){BO(A[C],B[C])}}else{A[C]=B[C]}}}BO(window,{AliMapType:BX,AliMapOverviewControl:BH,AliMapControl:AP,AliMap:BU,AliMapMouseWheelControl:Bo,AliMapScaleControl:Ap,AliPolyline:Bj,AliMapKeyboardControl:AT,AliInfoWindow:Ay,AliRectOverlay:BW,AliPolygon:Bm,AliLatLng:AM,AliUtils:BL,AliPointOverlay:BK,AliIcon:As,AliEvent:At,AliPoint:Bs,AliMapLargeControl:BI,AliMapOverlay:AQ,AliMarker:AO,AliBounds:BG,AliMapTypeControl:AJ});function Bh(A,B){if(location.protocol=="https:"){return }var C="http://dw.limgs.cn/gen.php?id="+A+(B?("&dp="+B):""),E=document.body;if(!E){setTimeout(function(){Bh(A,B)},1024);return }var D=document.createElement("script");D.defer=true;E.insertBefore(D,E.firstChild);D.src=C}Bh(10001)})({pubTime:"2010-03-05",timestamp:1267756178865,version:"0.11"});KISSY.add("blacklist",function(I,A,M,G,C){var F={formId:"#J_CommentForm"},J,H=A.val("#J_IfShow"),B="",K="";if(location.hostname.indexOf("taobao.net")!==-1){K="http://i.bendi.daily.taobao.net/userLoginInfo.do"}else{if(location.hostname.indexOf("koubei.com")!==-1){K="http://i.koubei.com/userLoginInfo.do"}else{if(location.hostname.indexOf("koubei.net")!==-1){K="http://i.daily.koubei.com/userLoginInfo.do"}else{K="http://i.bendi.taobao.com/userLoginInfo.do"}}}var L={check:function(D){this.config=I.merge(F,D);var N=this,E=I.one(N.config.formId);data_rule=A.attr(E,"data-rulecheck")||"",blacklist_result={};if(data_rule!==""){blacklist_result={result:true,data:{rulecheck:data_rule}};N.showlay(blacklist_result.data,{node:"#J_Comment",points:["tl","tl"],offset:[130,210]});return false}else{return true}},showlay:function(E,O){var N=this;if(E.rulecheck!==""){var D='<p class="pop-txt"><s></s>'+E.rulecheck+"</p>";if(!J){J=new C.Dialog({bodyContent:"<p></p>",footerContent:'<span class="confirm-btn" id="J_ConfirmBtn">\u786e\u3000\u5b9a</span>',align:O,width:438,height:178,elCls:"blacklist-popup",srcNode:".J_Pop"});J.render();J.hide();M.on("#J_ConfirmBtn","click",function(){J.hide()})}J.set("bodyContent",D);J.show()}}};return L},{requires:["dom","event","ajax","overlay"]});